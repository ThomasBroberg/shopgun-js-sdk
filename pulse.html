<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Pulse</title>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <script src="https://d21oefkcnoen8i.cloudfront.net/sgn-sdk-1.1.8.min.js"></script>
        <style>
            html,
            body {
                margin: 0;
                padding: 0;
            }

            body {
                font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            }

            #map {
                position: absolute;
                top: 0;
                left: 0;
                right: 0;
                bottom: 0;
                z-index: 1;
            }
        </style>
    </head>
    <body>
        <div id="map"></div>

        <script>
            function initialize () {
                var els = {
                    map: document.getElementById('map')
                };
                var pulse = new SGN.EventsKit.Pulse();
                var map = new google.maps.Map(els.map, {
                    zoom: 6,
                    disableDefaultUI: true,
                    center: { lat: 57.0488195, lng: 9.921747 }
                });

                // map.addListener('dragstart', function () {
                // });

                var markers = [];

                pulse.bind('event', function (e) {
                    var coords = Geohash.decode(e.geohash);
                    var center = { lat: coords.lat, lng: coords.lon };
                    var marker = new google.maps.Marker({
                        position: center,
                        map: map
                    });
                    markers.push(marker)
                    while (markers.length > 1000) {
                        markers.shift().setMap(null)
                    }
                });
            }
        </script>
        <script src="js/latlon-geohash.js"></script>
        <script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyD9dvsFBrmZYghZQIrHzmNx9AgGTM0cuYE&callback=initialize"></script>
    </body>
</html>

