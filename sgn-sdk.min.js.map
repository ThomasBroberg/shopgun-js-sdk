{"version":3,"file":"sgn-sdk.min.js","sources":["../lib/coffeescript/config.coffee","../node_modules/microevent/microevent.js","../lib/coffeescript/translations.coffee","../node_modules/mustache/mustache.js","../lib/coffeescript/util.coffee","../lib/coffeescript/core.coffee","../node_modules/process/browser.js","../lib/coffeescript/storage/client-local.coffee","../lib/coffeescript/sgn.coffee","../lib/coffeescript/storage/client-cookie.coffee","../lib/coffeescript/request/browser.coffee","../lib/coffeescript/kits/assets/file-upload.coffee","../lib/coffeescript/kits/events/tracker.coffee","../lib/coffeescript/kits/events/pulse.coffee","../lib/coffeescript/kits/graph/request.coffee","../lib/coffeescript/kits/events/index.coffee","../lib/coffeescript/kits/core/request.coffee","../lib/coffeescript/kits/core/session.coffee","../node_modules/convert-hex/convert-hex.js","../node_modules/convert-string/convert-string.js","../node_modules/sha256/lib/sha256.js","../lib/coffeescript/kits/core/index.coffee","../lib/coffeescript/kits/paged-publication/page-spread.coffee","../lib/coffeescript/kits/paged-publication/page-spreads.coffee","../lib/coffeescript/kits/paged-publication/core.coffee","../lib/coffeescript/kits/paged-publication/hotspots.coffee","../lib/coffeescript/kits/paged-publication/templates/hotspot.coffee","../lib/coffeescript/kits/paged-publication/controls.coffee","../lib/coffeescript/key-codes.coffee","../lib/coffeescript/kits/paged-publication/event-tracking.coffee","../lib/coffeescript/kits/paged-publication/viewer.coffee","../lib/coffeescript/kits/paged-publication/hotspot-picker.coffee","../lib/coffeescript/kits/paged-publication/initialize.coffee","../node_modules/gator/gator.js","../lib/coffeescript/kits/paged-publication/templates/hotspot-picker.coffee","../lib/coffeescript/browser.coffee","../lib/coffeescript/kits/paged-publication/index.coffee"],"sourcesContent":["MicroEvent = require 'microevent'\nConfig = class Config\n    keys: [\n        'appVersion',\n        'appKey',\n        'appSecret',\n        'authToken',\n        'eventTracker',\n        'locale',\n        'coreSessionToken',\n        'coreSessionClientId',\n        'coreUrl',\n        'graphUrl',\n        'eventsTrackUrl',\n        'eventsPulseUrl',\n        'assetsFileUploadUrl'\n    ]\n\n    constructor: ->\n        @attrs = {}\n\n        return\n\n    set: (config = {}) ->\n        changedAttributes = {}\n\n        for key, value of config\n            if key in @keys\n                @attrs[key] = value\n                changedAttributes[key] = value\n\n        @trigger 'change', changedAttributes\n\n        return\n\n    get: (option) ->\n        @attrs[option]\n\nMicroEvent.mixin Config\n\nmodule.exports = Config\n","/**\n * MicroEvent - to make any js object an event emitter (server or browser)\n * \n * - pure javascript - server compatible, browser compatible\n * - dont rely on the browser doms\n * - super simple - you get it immediatly, no mistery, no magic involved\n *\n * - create a MicroEventDebug with goodies to debug\n *   - make it safer to use\n*/\n\nvar MicroEvent\t= function(){}\nMicroEvent.prototype\t= {\n\tbind\t: function(event, fct){\n\t\tthis._events = this._events || {};\n\t\tthis._events[event] = this._events[event]\t|| [];\n\t\tthis._events[event].push(fct);\n\t},\n\tunbind\t: function(event, fct){\n\t\tthis._events = this._events || {};\n\t\tif( event in this._events === false  )\treturn;\n\t\tthis._events[event].splice(this._events[event].indexOf(fct), 1);\n\t},\n\ttrigger\t: function(event /* , args... */){\n\t\tthis._events = this._events || {};\n\t\tif( event in this._events === false  )\treturn;\n\t\tfor(var i = 0; i < this._events[event].length; i++){\n\t\t\tthis._events[event][i].apply(this, Array.prototype.slice.call(arguments, 1))\n\t\t}\n\t}\n};\n\n/**\n * mixin will delegate all MicroEvent.js function in the destination object\n *\n * - require('MicroEvent').mixin(Foobar) will make Foobar able to use MicroEvent\n *\n * @param {Object} the object which will support MicroEvent\n*/\nMicroEvent.mixin\t= function(destObject){\n\tvar props\t= ['bind', 'unbind', 'trigger'];\n\tfor(var i = 0; i < props.length; i ++){\n\t\tdestObject.prototype[props[i]]\t= MicroEvent.prototype[props[i]];\n\t}\n}\n\n// export in common js\nif( typeof module !== \"undefined\" && ('exports' in module)){\n\tmodule.exports\t= MicroEvent\n}\n","Mustache = require 'mustache'\npairs =\n    'paged_publication.hotspot_picker.header': 'Which offer did you mean?'\n\nmodule.exports =\n    t: (key, view) ->\n        template = pairs[key] ? ''\n\n        Mustache.render template, view\n\n    update: (translations) ->\n        for key, value of translations\n            pairs[key] = value\n\n        return\n","/*!\n * mustache.js - Logic-less {{mustache}} templates with JavaScript\n * http://github.com/janl/mustache.js\n */\n\n/*global define: false Mustache: true*/\n\n(function defineMustache (global, factory) {\n  if (typeof exports === 'object' && exports && typeof exports.nodeName !== 'string') {\n    factory(exports); // CommonJS\n  } else if (typeof define === 'function' && define.amd) {\n    define(['exports'], factory); // AMD\n  } else {\n    global.Mustache = {};\n    factory(global.Mustache); // script, wsh, asp\n  }\n}(this, function mustacheFactory (mustache) {\n\n  var objectToString = Object.prototype.toString;\n  var isArray = Array.isArray || function isArrayPolyfill (object) {\n    return objectToString.call(object) === '[object Array]';\n  };\n\n  function isFunction (object) {\n    return typeof object === 'function';\n  }\n\n  /**\n   * More correct typeof string handling array\n   * which normally returns typeof 'object'\n   */\n  function typeStr (obj) {\n    return isArray(obj) ? 'array' : typeof obj;\n  }\n\n  function escapeRegExp (string) {\n    return string.replace(/[\\-\\[\\]{}()*+?.,\\\\\\^$|#\\s]/g, '\\\\$&');\n  }\n\n  /**\n   * Null safe way of checking whether or not an object,\n   * including its prototype, has a given property\n   */\n  function hasProperty (obj, propName) {\n    return obj != null && typeof obj === 'object' && (propName in obj);\n  }\n\n  // Workaround for https://issues.apache.org/jira/browse/COUCHDB-577\n  // See https://github.com/janl/mustache.js/issues/189\n  var regExpTest = RegExp.prototype.test;\n  function testRegExp (re, string) {\n    return regExpTest.call(re, string);\n  }\n\n  var nonSpaceRe = /\\S/;\n  function isWhitespace (string) {\n    return !testRegExp(nonSpaceRe, string);\n  }\n\n  var entityMap = {\n    '&': '&amp;',\n    '<': '&lt;',\n    '>': '&gt;',\n    '\"': '&quot;',\n    \"'\": '&#39;',\n    '/': '&#x2F;',\n    '`': '&#x60;',\n    '=': '&#x3D;'\n  };\n\n  function escapeHtml (string) {\n    return String(string).replace(/[&<>\"'`=\\/]/g, function fromEntityMap (s) {\n      return entityMap[s];\n    });\n  }\n\n  var whiteRe = /\\s*/;\n  var spaceRe = /\\s+/;\n  var equalsRe = /\\s*=/;\n  var curlyRe = /\\s*\\}/;\n  var tagRe = /#|\\^|\\/|>|\\{|&|=|!/;\n\n  /**\n   * Breaks up the given `template` string into a tree of tokens. If the `tags`\n   * argument is given here it must be an array with two string values: the\n   * opening and closing tags used in the template (e.g. [ \"<%\", \"%>\" ]). Of\n   * course, the default is to use mustaches (i.e. mustache.tags).\n   *\n   * A token is an array with at least 4 elements. The first element is the\n   * mustache symbol that was used inside the tag, e.g. \"#\" or \"&\". If the tag\n   * did not contain a symbol (i.e. {{myValue}}) this element is \"name\". For\n   * all text that appears outside a symbol this element is \"text\".\n   *\n   * The second element of a token is its \"value\". For mustache tags this is\n   * whatever else was inside the tag besides the opening symbol. For text tokens\n   * this is the text itself.\n   *\n   * The third and fourth elements of the token are the start and end indices,\n   * respectively, of the token in the original template.\n   *\n   * Tokens that are the root node of a subtree contain two more elements: 1) an\n   * array of tokens in the subtree and 2) the index in the original template at\n   * which the closing tag for that section begins.\n   */\n  function parseTemplate (template, tags) {\n    if (!template)\n      return [];\n\n    var sections = [];     // Stack to hold section tokens\n    var tokens = [];       // Buffer to hold the tokens\n    var spaces = [];       // Indices of whitespace tokens on the current line\n    var hasTag = false;    // Is there a {{tag}} on the current line?\n    var nonSpace = false;  // Is there a non-space char on the current line?\n\n    // Strips all whitespace tokens array for the current line\n    // if there was a {{#tag}} on it and otherwise only space.\n    function stripSpace () {\n      if (hasTag && !nonSpace) {\n        while (spaces.length)\n          delete tokens[spaces.pop()];\n      } else {\n        spaces = [];\n      }\n\n      hasTag = false;\n      nonSpace = false;\n    }\n\n    var openingTagRe, closingTagRe, closingCurlyRe;\n    function compileTags (tagsToCompile) {\n      if (typeof tagsToCompile === 'string')\n        tagsToCompile = tagsToCompile.split(spaceRe, 2);\n\n      if (!isArray(tagsToCompile) || tagsToCompile.length !== 2)\n        throw new Error('Invalid tags: ' + tagsToCompile);\n\n      openingTagRe = new RegExp(escapeRegExp(tagsToCompile[0]) + '\\\\s*');\n      closingTagRe = new RegExp('\\\\s*' + escapeRegExp(tagsToCompile[1]));\n      closingCurlyRe = new RegExp('\\\\s*' + escapeRegExp('}' + tagsToCompile[1]));\n    }\n\n    compileTags(tags || mustache.tags);\n\n    var scanner = new Scanner(template);\n\n    var start, type, value, chr, token, openSection;\n    while (!scanner.eos()) {\n      start = scanner.pos;\n\n      // Match any text between tags.\n      value = scanner.scanUntil(openingTagRe);\n\n      if (value) {\n        for (var i = 0, valueLength = value.length; i < valueLength; ++i) {\n          chr = value.charAt(i);\n\n          if (isWhitespace(chr)) {\n            spaces.push(tokens.length);\n          } else {\n            nonSpace = true;\n          }\n\n          tokens.push([ 'text', chr, start, start + 1 ]);\n          start += 1;\n\n          // Check for whitespace on the current line.\n          if (chr === '\\n')\n            stripSpace();\n        }\n      }\n\n      // Match the opening tag.\n      if (!scanner.scan(openingTagRe))\n        break;\n\n      hasTag = true;\n\n      // Get the tag type.\n      type = scanner.scan(tagRe) || 'name';\n      scanner.scan(whiteRe);\n\n      // Get the tag value.\n      if (type === '=') {\n        value = scanner.scanUntil(equalsRe);\n        scanner.scan(equalsRe);\n        scanner.scanUntil(closingTagRe);\n      } else if (type === '{') {\n        value = scanner.scanUntil(closingCurlyRe);\n        scanner.scan(curlyRe);\n        scanner.scanUntil(closingTagRe);\n        type = '&';\n      } else {\n        value = scanner.scanUntil(closingTagRe);\n      }\n\n      // Match the closing tag.\n      if (!scanner.scan(closingTagRe))\n        throw new Error('Unclosed tag at ' + scanner.pos);\n\n      token = [ type, value, start, scanner.pos ];\n      tokens.push(token);\n\n      if (type === '#' || type === '^') {\n        sections.push(token);\n      } else if (type === '/') {\n        // Check section nesting.\n        openSection = sections.pop();\n\n        if (!openSection)\n          throw new Error('Unopened section \"' + value + '\" at ' + start);\n\n        if (openSection[1] !== value)\n          throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + start);\n      } else if (type === 'name' || type === '{' || type === '&') {\n        nonSpace = true;\n      } else if (type === '=') {\n        // Set the tags for the next time around.\n        compileTags(value);\n      }\n    }\n\n    // Make sure there are no open sections when we're done.\n    openSection = sections.pop();\n\n    if (openSection)\n      throw new Error('Unclosed section \"' + openSection[1] + '\" at ' + scanner.pos);\n\n    return nestTokens(squashTokens(tokens));\n  }\n\n  /**\n   * Combines the values of consecutive text tokens in the given `tokens` array\n   * to a single token.\n   */\n  function squashTokens (tokens) {\n    var squashedTokens = [];\n\n    var token, lastToken;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      token = tokens[i];\n\n      if (token) {\n        if (token[0] === 'text' && lastToken && lastToken[0] === 'text') {\n          lastToken[1] += token[1];\n          lastToken[3] = token[3];\n        } else {\n          squashedTokens.push(token);\n          lastToken = token;\n        }\n      }\n    }\n\n    return squashedTokens;\n  }\n\n  /**\n   * Forms the given array of `tokens` into a nested tree structure where\n   * tokens that represent a section have two additional items: 1) an array of\n   * all tokens that appear in that section and 2) the index in the original\n   * template that represents the end of that section.\n   */\n  function nestTokens (tokens) {\n    var nestedTokens = [];\n    var collector = nestedTokens;\n    var sections = [];\n\n    var token, section;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      token = tokens[i];\n\n      switch (token[0]) {\n        case '#':\n        case '^':\n          collector.push(token);\n          sections.push(token);\n          collector = token[4] = [];\n          break;\n        case '/':\n          section = sections.pop();\n          section[5] = token[2];\n          collector = sections.length > 0 ? sections[sections.length - 1][4] : nestedTokens;\n          break;\n        default:\n          collector.push(token);\n      }\n    }\n\n    return nestedTokens;\n  }\n\n  /**\n   * A simple string scanner that is used by the template parser to find\n   * tokens in template strings.\n   */\n  function Scanner (string) {\n    this.string = string;\n    this.tail = string;\n    this.pos = 0;\n  }\n\n  /**\n   * Returns `true` if the tail is empty (end of string).\n   */\n  Scanner.prototype.eos = function eos () {\n    return this.tail === '';\n  };\n\n  /**\n   * Tries to match the given regular expression at the current position.\n   * Returns the matched text if it can match, the empty string otherwise.\n   */\n  Scanner.prototype.scan = function scan (re) {\n    var match = this.tail.match(re);\n\n    if (!match || match.index !== 0)\n      return '';\n\n    var string = match[0];\n\n    this.tail = this.tail.substring(string.length);\n    this.pos += string.length;\n\n    return string;\n  };\n\n  /**\n   * Skips all text until the given regular expression can be matched. Returns\n   * the skipped string, which is the entire tail if no match can be made.\n   */\n  Scanner.prototype.scanUntil = function scanUntil (re) {\n    var index = this.tail.search(re), match;\n\n    switch (index) {\n      case -1:\n        match = this.tail;\n        this.tail = '';\n        break;\n      case 0:\n        match = '';\n        break;\n      default:\n        match = this.tail.substring(0, index);\n        this.tail = this.tail.substring(index);\n    }\n\n    this.pos += match.length;\n\n    return match;\n  };\n\n  /**\n   * Represents a rendering context by wrapping a view object and\n   * maintaining a reference to the parent context.\n   */\n  function Context (view, parentContext) {\n    this.view = view;\n    this.cache = { '.': this.view };\n    this.parent = parentContext;\n  }\n\n  /**\n   * Creates a new context using the given view with this context\n   * as the parent.\n   */\n  Context.prototype.push = function push (view) {\n    return new Context(view, this);\n  };\n\n  /**\n   * Returns the value of the given name in this context, traversing\n   * up the context hierarchy if the value is absent in this context's view.\n   */\n  Context.prototype.lookup = function lookup (name) {\n    var cache = this.cache;\n\n    var value;\n    if (cache.hasOwnProperty(name)) {\n      value = cache[name];\n    } else {\n      var context = this, names, index, lookupHit = false;\n\n      while (context) {\n        if (name.indexOf('.') > 0) {\n          value = context.view;\n          names = name.split('.');\n          index = 0;\n\n          /**\n           * Using the dot notion path in `name`, we descend through the\n           * nested objects.\n           *\n           * To be certain that the lookup has been successful, we have to\n           * check if the last object in the path actually has the property\n           * we are looking for. We store the result in `lookupHit`.\n           *\n           * This is specially necessary for when the value has been set to\n           * `undefined` and we want to avoid looking up parent contexts.\n           **/\n          while (value != null && index < names.length) {\n            if (index === names.length - 1)\n              lookupHit = hasProperty(value, names[index]);\n\n            value = value[names[index++]];\n          }\n        } else {\n          value = context.view[name];\n          lookupHit = hasProperty(context.view, name);\n        }\n\n        if (lookupHit)\n          break;\n\n        context = context.parent;\n      }\n\n      cache[name] = value;\n    }\n\n    if (isFunction(value))\n      value = value.call(this.view);\n\n    return value;\n  };\n\n  /**\n   * A Writer knows how to take a stream of tokens and render them to a\n   * string, given a context. It also maintains a cache of templates to\n   * avoid the need to parse the same template twice.\n   */\n  function Writer () {\n    this.cache = {};\n  }\n\n  /**\n   * Clears all cached templates in this writer.\n   */\n  Writer.prototype.clearCache = function clearCache () {\n    this.cache = {};\n  };\n\n  /**\n   * Parses and caches the given `template` and returns the array of tokens\n   * that is generated from the parse.\n   */\n  Writer.prototype.parse = function parse (template, tags) {\n    var cache = this.cache;\n    var tokens = cache[template];\n\n    if (tokens == null)\n      tokens = cache[template] = parseTemplate(template, tags);\n\n    return tokens;\n  };\n\n  /**\n   * High-level method that is used to render the given `template` with\n   * the given `view`.\n   *\n   * The optional `partials` argument may be an object that contains the\n   * names and templates of partials that are used in the template. It may\n   * also be a function that is used to load partial templates on the fly\n   * that takes a single argument: the name of the partial.\n   */\n  Writer.prototype.render = function render (template, view, partials) {\n    var tokens = this.parse(template);\n    var context = (view instanceof Context) ? view : new Context(view);\n    return this.renderTokens(tokens, context, partials, template);\n  };\n\n  /**\n   * Low-level method that renders the given array of `tokens` using\n   * the given `context` and `partials`.\n   *\n   * Note: The `originalTemplate` is only ever used to extract the portion\n   * of the original template that was contained in a higher-order section.\n   * If the template doesn't use higher-order sections, this argument may\n   * be omitted.\n   */\n  Writer.prototype.renderTokens = function renderTokens (tokens, context, partials, originalTemplate) {\n    var buffer = '';\n\n    var token, symbol, value;\n    for (var i = 0, numTokens = tokens.length; i < numTokens; ++i) {\n      value = undefined;\n      token = tokens[i];\n      symbol = token[0];\n\n      if (symbol === '#') value = this.renderSection(token, context, partials, originalTemplate);\n      else if (symbol === '^') value = this.renderInverted(token, context, partials, originalTemplate);\n      else if (symbol === '>') value = this.renderPartial(token, context, partials, originalTemplate);\n      else if (symbol === '&') value = this.unescapedValue(token, context);\n      else if (symbol === 'name') value = this.escapedValue(token, context);\n      else if (symbol === 'text') value = this.rawValue(token);\n\n      if (value !== undefined)\n        buffer += value;\n    }\n\n    return buffer;\n  };\n\n  Writer.prototype.renderSection = function renderSection (token, context, partials, originalTemplate) {\n    var self = this;\n    var buffer = '';\n    var value = context.lookup(token[1]);\n\n    // This function is used to render an arbitrary template\n    // in the current context by higher-order sections.\n    function subRender (template) {\n      return self.render(template, context, partials);\n    }\n\n    if (!value) return;\n\n    if (isArray(value)) {\n      for (var j = 0, valueLength = value.length; j < valueLength; ++j) {\n        buffer += this.renderTokens(token[4], context.push(value[j]), partials, originalTemplate);\n      }\n    } else if (typeof value === 'object' || typeof value === 'string' || typeof value === 'number') {\n      buffer += this.renderTokens(token[4], context.push(value), partials, originalTemplate);\n    } else if (isFunction(value)) {\n      if (typeof originalTemplate !== 'string')\n        throw new Error('Cannot use higher-order sections without the original template');\n\n      // Extract the portion of the original template that the section contains.\n      value = value.call(context.view, originalTemplate.slice(token[3], token[5]), subRender);\n\n      if (value != null)\n        buffer += value;\n    } else {\n      buffer += this.renderTokens(token[4], context, partials, originalTemplate);\n    }\n    return buffer;\n  };\n\n  Writer.prototype.renderInverted = function renderInverted (token, context, partials, originalTemplate) {\n    var value = context.lookup(token[1]);\n\n    // Use JavaScript's definition of falsy. Include empty arrays.\n    // See https://github.com/janl/mustache.js/issues/186\n    if (!value || (isArray(value) && value.length === 0))\n      return this.renderTokens(token[4], context, partials, originalTemplate);\n  };\n\n  Writer.prototype.renderPartial = function renderPartial (token, context, partials) {\n    if (!partials) return;\n\n    var value = isFunction(partials) ? partials(token[1]) : partials[token[1]];\n    if (value != null)\n      return this.renderTokens(this.parse(value), context, partials, value);\n  };\n\n  Writer.prototype.unescapedValue = function unescapedValue (token, context) {\n    var value = context.lookup(token[1]);\n    if (value != null)\n      return value;\n  };\n\n  Writer.prototype.escapedValue = function escapedValue (token, context) {\n    var value = context.lookup(token[1]);\n    if (value != null)\n      return mustache.escape(value);\n  };\n\n  Writer.prototype.rawValue = function rawValue (token) {\n    return token[1];\n  };\n\n  mustache.name = 'mustache.js';\n  mustache.version = '2.3.0';\n  mustache.tags = [ '{{', '}}' ];\n\n  // All high-level mustache.* functions use this writer.\n  var defaultWriter = new Writer();\n\n  /**\n   * Clears all cached templates in the default writer.\n   */\n  mustache.clearCache = function clearCache () {\n    return defaultWriter.clearCache();\n  };\n\n  /**\n   * Parses and caches the given template in the default writer and returns the\n   * array of tokens it contains. Doing this ahead of time avoids the need to\n   * parse templates on the fly as they are rendered.\n   */\n  mustache.parse = function parse (template, tags) {\n    return defaultWriter.parse(template, tags);\n  };\n\n  /**\n   * Renders the `template` with the given `view` and `partials` using the\n   * default writer.\n   */\n  mustache.render = function render (template, view, partials) {\n    if (typeof template !== 'string') {\n      throw new TypeError('Invalid template! Template should be a \"string\" ' +\n                          'but \"' + typeStr(template) + '\" was given as the first ' +\n                          'argument for mustache#render(template, view, partials)');\n    }\n\n    return defaultWriter.render(template, view, partials);\n  };\n\n  // This is here for backwards compatibility with 0.4.x.,\n  /*eslint-disable */ // eslint wants camel cased function name\n  mustache.to_html = function to_html (template, view, partials, send) {\n    /*eslint-enable*/\n\n    var result = mustache.render(template, view, partials);\n\n    if (isFunction(send)) {\n      send(result);\n    } else {\n      return result;\n    }\n  };\n\n  // Export the escaping function so that the user may override it.\n  // See https://github.com/janl/mustache.js/issues/244\n  mustache.escape = escapeHtml;\n\n  // Export these mainly for testing, but also for advanced usage.\n  mustache.Scanner = Scanner;\n  mustache.Context = Context;\n  mustache.Writer = Writer;\n\n  return mustache;\n}));\n","process = require 'process'\n\nutil =\n    isBrowser: ->\n        typeof process isnt 'undefined' and process.browser\n\n    isNode: ->\n        not util.isBrowser()\n\n    error: (err, options) ->\n        err.message = err.message or null\n\n        if typeof options is 'string'\n            err.message = options\n        else if typeof options is 'object' and options?\n            for key, value of options\n                err[key] = value\n\n            err.message = options.message if options.message?\n            err.code = options.code or options.name if options.code? or options.message?\n            err.stack = options.stack if options.stack?\n\n        err.name = options and options.name or err.name or err.code or 'Error'\n        err.time = new Date()\n\n        err\n\n    uuid: ->\n        'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace /[xy]/g, (c) ->\n            r = Math.random() * 16 | 0\n            v = if c is 'x' then r else (r & 0x3|0x8)\n\n            v.toString 16\n\n    getQueryParam: (field, url) ->\n        href = if url then url else window.location.href\n        reg = new RegExp '[?&]' + field + '=([^&#]*)', 'i'\n        string = reg.exec href\n\n        if string then string[1] else undefined\n\n    formatQueryParams: (queryParams = {}) ->\n        Object\n            .keys queryParams\n            .map (key) -> key + '=' + encodeURIComponent(queryParams[key])\n            .join '&'\n\n    getRandomNumberBetween: (from, to) ->\n        Math.floor(Math.random() * to) + from\n\n    getOS: ->\n        name = null\n        ua = window.navigator.userAgent\n\n        if ua.indexOf('Windows') > -1\n            name = 'Windows'\n        else if ua.indexOf('Mac') > -1\n            name = 'macOS'\n        else if ua.indexOf('X11') > -1\n            name = 'unix'\n        else if ua.indexOf('Linux') > -1\n            name = 'Linux'\n        else if ua.indexOf('iOS') > -1\n            name = 'iOS'\n        else if ua.indexOf('Android') > -1\n            name = 'Android'\n\n        name\n\n    btoa: (str) ->\n        if util.isBrowser()\n            btoa str\n        else\n            buffer = null\n\n            if str instanceof Buffer\n                buffer = str\n            else\n                buffer = new Buffer str.toString(), 'binary'\n\n            buffer.toString 'base64'\n\n    getScreenDimensions: ->\n        density = window.devicePixelRatio ? 1\n        logical =\n            width: window.screen.width\n            height: window.screen.height\n        physical =\n            width: Math.round logical.width * density\n            height: Math.round logical.height * density\n\n        density: density\n        logical: logical\n        physical: physical\n\n    getUtcOffsetSeconds: ->\n        now = new Date()\n        jan1 = new Date now.getFullYear(), 0, 1, 0, 0, 0, 0\n        tmp = jan1.toGMTString()\n        jan2 = new Date tmp.substring(0, tmp.lastIndexOf(' ') - 1)\n        stdTimeOffset = (jan1 - jan2) / 1000\n\n        stdTimeOffset\n\n    getUtcDstOffsetSeconds: ->\n        new Date().getTimezoneOffset() * 60 * -1\n\n    getColorBrightness: (color) ->\n        color = color.replace '#', ''\n        hex = parseInt (hex + '').replace(/[^a-f0-9]/gi, ''), 16\n        rgb = []\n        sum = 0\n        x = 0\n\n        while x < 3\n            s = parseInt(color.substring(2 * x, 2), 16)\n            rgb[x] = s\n\n            sum += s if s > 0\n\n            ++x\n\n        if sum <= 381 then 'dark' else 'light'\n\n    find: (arr, fn) ->\n        for item in arr\n            return item if fn(item) is true\n\n    chunk: (arr, size) ->\n        results = []\n\n        while arr.length\n            results.push arr.splice(0, size)\n\n        results\n\n    throttle: (fn, threshold = 250, scope) ->\n        last = undefined\n        deferTimer = undefined\n\n        ->\n            context = scope or @\n            now = new Date().getTime()\n            args = arguments\n\n            if last and now < last + threshold\n                clearTimeout deferTimer\n\n                deferTimer = setTimeout ->\n                    last = now\n                    \n                    fn.apply context, args\n                \n                    return\n                , threshold\n            else\n                last = now\n                fn.apply context, args\n\n            return\n\n    loadImage: (src, callback) ->\n        img = new Image()\n\n        img.onload = -> callback null, img.width, img.height\n        img.onerror = -> callback new Error()\n        img.src = src\n\n        img\n\n    distance: (lat1, lng1, lat2, lng2) ->\n        radlat1 = Math.PI * lat1 / 180\n        radlat2 = Math.PI * lat2 / 180\n        theta = lng1 - lng2\n        radtheta = Math.PI * theta / 180\n        dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta)\n        dist = Math.acos(dist)\n        dist = dist * 180 / Math.PI\n        dist = dist * 60 * 1.1515\n        dist = dist * 1.609344 * 1000\n\n        dist\n\n    async:\n        parallel: (asyncCalls, sharedCallback) ->\n            counter = asyncCalls.length\n            allResults = []\n            k = 0\n\n            makeCallback = (index) ->\n                ->\n                    results = []\n                    i = 0\n\n                    counter--\n\n                    while i < arguments.length\n                        results.push arguments[i]\n                        i++\n\n                    allResults[index] = results\n\n                    sharedCallback allResults if counter is 0\n\n                    return\n\n            while k < asyncCalls.length\n                asyncCalls[k] makeCallback(k)\n                k++\n\n            return\n\nmodule.exports = util\n","Config = require './config'\ntranslations = require './translations'\nutil = require './util'\nconfig = new Config()\n\n# Set default values.\nconfig.set\n    locale: 'en_US'\n    coreUrl: 'https://api.etilbudsavis.dk'\n    graphUrl: 'https://graph.service.shopgun.com'\n    eventsTrackUrl: 'https://events.service.shopgun.com/track'\n    eventsPulseUrl: 'wss://events.service.shopgun.com/pulse'\n    assetsFileUploadUrl: 'https://assets.service.shopgun.com/upload'\n\nmodule.exports =\n    config: config\n\n    translations: translations\n\n    util: util\n","// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n","SGN = require '../sgn'\nprefixKey = 'sgn-'\n\nmodule.exports =\n    key: 'sgn-'\n\n    storage: do ->\n        try\n            storage = window.localStorage\n\n            storage[\"#{prefixKey}test-storage\"] = 'foobar'\n            delete storage[\"#{prefixKey}test-storage\"]\n\n            storage\n        catch\n            {}\n\n    get: (key) ->\n        try\n            JSON.parse @storage[\"#{prefixKey}#{key}\"]\n\n    set: (key, value) ->\n        try\n            @storage[\"#{prefixKey}#{key}\"] = JSON.stringify value\n\n        @\n","module.exports = require './core'\n","SGN = require '../sgn'\nprefixKey = 'sgn-'\n\nmodule.exports =\n    get: (key) ->\n        return if SGN.util.isNode()\n\n        try\n            name = \"#{prefixKey}#{key}=\"\n            ca = document.cookie.split ';'\n\n            for c in ca\n                ct = c.trim()\n\n                value = ct.substring(name.length, ct.length) if ct.indexOf(name) is 0\n\n            value = JSON.parse value\n        catch err\n            value = {}\n\n        value\n\n    set: (key, value) ->\n        return if SGN.util.isNode()\n\n        try\n            days = 365\n            date = new Date()\n            str = JSON.stringify value\n\n            date.setTime date.getTime() + days * 24 * 60 * 60 * 1000\n\n            document.cookie = \"#{prefixKey}#{key}=#{str};expires=#{date.toUTCString()};path=/\"\n        catch err\n\n        return\n\n\n","SGN = require '../sgn'\n\nmodule.exports = (options = {}, callback, progressCallback) ->\n    http = new XMLHttpRequest()\n    method = options.method ? 'get'\n    url = options.url\n    headers = options.headers ? {}\n\n    if options.qs?\n        queryParams = SGN.util.formatQueryParams options.qs\n\n        if url.indexOf('?') is -1\n            url += '?' + queryParams\n        else\n            url += '&' + queryParams\n\n    http.open method.toUpperCase(), url\n    http.timeout = options.timeout if options.timeout?\n    http.withCredentials = true if options.useCookies is true\n\n    if options.json is true\n        headers['Content-Type'] = 'application/json'\n        headers['Accept'] = 'application/json'\n\n    for header, value of options.headers\n        http.setRequestHeader header, value\n\n    http.addEventListener 'load', ->\n        headers = http.getAllResponseHeaders().split '\\r\\n'\n        headers = headers.reduce (acc, current, i) ->\n            parts = current.split ': '\n\n            acc[parts[0].toLowerCase()] = parts[1]\n\n            acc\n        , {}\n        body = http.responseText\n\n        body = JSON.parse body if options.json is true\n\n        callback null,\n            statusCode: http.status\n            headers: headers\n            body: body\n\n        return\n    http.addEventListener 'error', ->\n        callback new Error()\n\n        return\n    http.addEventListener 'timeout', ->\n        callback new Error()\n\n        return\n    http.addEventListener 'progress', (e) ->\n        if e.lengthComputable and typeof progressCallback is 'function'\n            progressCallback e.loaded, e.total\n\n        return\n\n    if options.formData?\n        formData = new FormData()\n\n        for key, value of options.formData\n            formData.append key, value\n\n        http.send formData\n    else if options.body?\n        if options.json is true\n            http.send JSON.stringify(options.body)\n        else\n            http.send options.body\n    else\n        http.send()\n\n    return\n","SGN = require '../../sgn'\n\nmodule.exports = (options = {}, callback, progressCallback) ->\n    throw new Error('File is not defined') if not options.file?\n\n    url = SGN.config.get 'assetsFileUploadUrl'\n    formData = file: options.file\n    formData = file: value: options.file, options: contentType: options.contentType if options.contentType?\n    timeout = 1000 * 60 * 60\n\n    SGN.request\n        method: 'post'\n        url: url\n        headers:\n            'Content-Type': options.contentType\n            'Accept': 'application/json'\n        formData: formData\n        timeout: timeout\n    , (err, data) ->\n        if err?\n            callback SGN.util.error(new Error('Request error'),\n                code: 'RequestError'\n            )\n        else\n            if data.statusCode is 200\n                callback null, JSON.parse(data.body)\n            else\n                callback SGN.util.error(new Error('Request error'),\n                    code: 'RequestError'\n                    statusCode: data.statusCode\n                )\n\n        return\n    , (loaded, total) ->\n        if typeof progressCallback is 'function'\n            progressCallback\n                progress: loaded / total\n                loaded: loaded\n                total: total\n\n        return\n\n    return\n","SGN = require '../../sgn'\nclientLocalStorage = require '../../storage/client-local'\ngetPool = ->\n    data = clientLocalStorage.get 'event-tracker-pool'\n    data = [] if Array.isArray(data) is false\n\n    data\npool = getPool()\n\nclientLocalStorage.set 'event-tracker-pool', []\n\ntry\n    window.addEventListener 'unload', ->\n        pool = pool.concat getPool()\n\n        clientLocalStorage.set 'event-tracker-pool', pool\n\n        return\n    , false\n\nmodule.exports = class Tracker\n    defaultOptions:\n        trackId: null\n        dispatchInterval: 3000\n        dispatchLimit: 100\n        poolLimit: 1000\n        dryRun: false\n\n    constructor: (options = {}) ->\n        for key, value of @defaultOptions\n            @[key] = options[key] or value\n\n        @dispatching = false\n        @session =\n            id: SGN.util.uuid()\n        @client =\n            trackId: @trackId\n            id: SGN.client.id\n        @view =\n            path: []\n            previousPath: []\n            uri: null\n        @location = {}\n        @application = {}\n        @identity = {}\n\n        # Dispatch events periodically.\n        @interval = setInterval @dispatch.bind(@), @dispatchInterval\n\n        return\n\n    trackEvent: (type, properties = {}, version = '1.0.0') ->\n        throw SGN.util.error(new Error('Event type is required')) if typeof type isnt 'string'\n        return if not @trackId?\n\n        pool.push\n            id: SGN.util.uuid()\n            type: type\n            version: version\n            recordedAt: new Date().toISOString()\n            sentAt: null\n            client:\n                id: @client.id\n                trackId: @client.trackId\n            context: @getContext()\n            properties: properties\n\n        pool.shift() while @getPoolSize() > @poolLimit\n\n        @\n\n    identify: (id) ->\n        @identity.id = id\n\n        @\n\n    setLocation: (location = {}) ->\n        @location.determinedAt = new Date(location.timestamp).toISOString()\n        @location.latitude = location.latitude\n        @location.longitude = location.longitude\n        @location.altitude = location.altitude\n        @location.accuracy =\n            horizontal: location.accuracy?.horizontal\n            vertical: location.accuracy?.vertical\n        @location.speed = location.speed\n        @location.floor = location.floor\n\n        @\n\n    setApplication: (application = {}) ->\n        @application.name = application.name\n        @application.version = application.version\n        @application.build = application.build\n\n        @\n\n    setView: (path) ->\n        @view.previousPath = @view.path\n        @view.path = path if Array.isArray(path) is true\n        @view.uri = window.location.href\n\n        @\n\n    getView: ->\n        view = {}\n\n        view.path = @view.path if @view.path.length > 0\n        view.previousPath = @view.previousPath if @view.previousPath.length > 0\n        view.uri = @view.uri if @view.uri?\n\n        view\n\n    getContext: ->\n        screenDimensions = SGN.util.getScreenDimensions()\n        os = SGN.util.getOS()\n        context =\n            userAgent: window.navigator.userAgent\n            locale: navigator.language\n            timeZone:\n                utcOffsetSeconds: SGN.util.getUtcOffsetSeconds()\n                utcDstOffsetSeconds: SGN.util.getUtcDstOffsetSeconds()\n            device:\n                screen:\n                    width: screenDimensions.physical.width\n                    height: screenDimensions.physical.height\n                    density: screenDimensions.density\n            session:\n                id: @session.id\n            view: @getView()\n        application =\n            name: @application.name\n            version: @application.version\n            build: @application.build\n        campaign =\n            source: SGN.util.getQueryParam 'utm_source'\n            medium: SGN.util.getQueryParam 'utm_medium'\n            name: SGN.util.getQueryParam 'utm_campaign'\n            term: SGN.util.getQueryParam 'utm_term'\n            content: SGN.util.getQueryParam 'utm_content'\n        loc =\n            determinedAt: @location.determinedAt\n            latitude: @location.latitude\n            longitude: @location.longitude\n            altitude: @location.altitude\n            speed: @location.speed\n            floor: @location.floor\n            accuracy:\n                horizontal: @location.accuracy?.horizontal\n                vertical: @location.accuracy?.vertical\n\n        # Operating system.\n        context.os = name: os if os?\n\n        # Session referrer.\n        context.session.referrer = document.referrer if document.referrer.length > 0\n\n        # Application.\n        ['name', 'version', 'build'].forEach (key) ->\n            delete application[key] if typeof application[key] isnt 'string' or application[key].length is 0\n            return\n        context.application = application if Object.keys(application).length > 0\n\n        # Campaign.\n        ['source', 'medium', 'name', 'term', 'content'].forEach (key) ->\n            delete campaign[key] if typeof campaign[key] isnt 'string' or campaign[key].length is 0\n            return\n        context.campaign = campaign if Object.keys(campaign).length > 0\n\n        # Location.\n        ['latitude', 'longitude', 'altitude', 'speed', 'floor'].forEach (key) ->\n            delete loc[key] if typeof loc[key] isnt 'number'\n            return\n        delete loc.accuracy.horizontal if typeof loc.accuracy.horizontal isnt 'number'\n        delete loc.accuracy.vertical if typeof loc.accuracy.vertical isnt 'number'\n        delete loc.accuracy if Object.keys(loc.accuracy).length is 0\n        delete loc.determinedAt if typeof loc.determinedAt isnt 'string' or loc.determinedAt.length is 0\n        context.location = loc if Object.keys(loc).length > 0\n\n        # Person identifier.\n        context.personId = @identity.id if @identity.id?\n\n        context\n\n    getPoolSize: ->\n        pool.length\n\n    dispatch: ->\n        return if @dispatching is true or @getPoolSize() is 0\n        return pool.splice(0, @dispatchLimit) if @dryRun is true\n\n        events = pool.slice 0, @dispatchLimit\n        nacks = 0\n\n        @dispatching = true\n\n        @ship events, (err, response) =>\n            @dispatching = false\n\n            if not err?\n                response.events.forEach (resEvent) ->\n                    if resEvent.status is 'validation_error' or resEvent.status is 'ack'\n                        pool = pool.filter (poolEvent) -> poolEvent.id isnt resEvent.id\n                    else if 'nack'\n                        nacks++\n\n                    return\n\n                # Keep dispatching until the pool size reaches a sane level.\n                @dispatch() if @getPoolSize() >= @dispatchLimit and nacks is 0\n\n            return\n\n        @\n\n    ship: (events = [], callback) ->\n        http = new XMLHttpRequest()\n        url = SGN.config.get 'eventsTrackUrl'\n        payload = events: events.map (event) ->\n            event.sentAt = new Date().toISOString()\n\n            event\n\n        http.open 'POST', url\n        http.setRequestHeader 'Content-Type', 'application/json'\n        http.setRequestHeader 'Accept', 'application/json'\n        http.timeout = 1000 * 20\n        http.onload = ->\n            if http.status is 200\n                try\n                    callback null, JSON.parse(http.responseText)\n                catch err\n                    callback SGN.util.error(new Error('Could not parse JSON'))\n            else\n                callback SGN.util.error(new Error('Server did not accept request'))\n\n            return\n        http.onerror = ->\n            callback SGN.util.error(new Error('Could not perform network request'))\n\n            return\n        http.send JSON.stringify(payload)\n\n        @\n","MicroEvent = require 'microevent'\n\nclass Pulse\n    constructor: ->\n        @destroyed = false\n        @connection = @connect()\n\n        return\n\n    destroy: ->\n        @destroyed = true\n\n        @connection.close()\n\n        @\n\n    connect: ->\n        connection = new WebSocket SGN.config.get('eventsPulseUrl')\n\n        connection.onopen = @onOpen.bind @\n        connection.onmessage = @onMessage.bind @\n        connection.onerror = @onError.bind @\n        connection.onclose = @onClose.bind @\n\n        connection\n\n    onOpen: ->\n        @trigger 'open'\n\n        return\n\n    onMessage: (e) ->\n        try\n            @trigger 'event', JSON.parse(e.data)\n\n        return\n\n    onError: ->\n        return\n\n    onClose: ->\n        if @destroyed is false\n            setTimeout =>\n                @connection = @connect()\n\n                return\n            , 2000\n\n        return\n\nMicroEvent.mixin Pulse\n\nmodule.exports = Pulse\n","SGN = require '../../sgn'\n\nparseCookies = (cookies = []) ->\n    parsedCookies = {}\n\n    cookies.map (cookie) ->\n        parts = cookie.split '; '\n        keyValuePair = parts[0].split '='\n        key = keyValuePair[0]\n        value = keyValuePair[1]\n\n        parsedCookies[key] = value\n\n        return\n    \n    parsedCookies\n\nmodule.exports = (options = {}, callback) ->\n    url = SGN.config.get 'graphUrl'\n    timeout = 1000 * 12\n    appKey = SGN.config.get 'appKey'\n    authToken = SGN.config.get 'authToken'\n    authTokenCookieName = 'shopgun-auth-token'\n    options =\n        method: 'post'\n        url: url\n        timeout: timeout\n        json: true\n        headers: {}\n        body:\n            query: options.query\n            operationName: options.operationName\n            variables: options.variables\n\n    # Apply authorization header when app key is provided to avoid rate limiting.\n    options.headers.Authorization = 'Basic ' + SGN.util.btoa(\"app-key:#{appKey}\") if appKey?\n\n    # Set cookies manually in node.js.\n    if SGN.util.isNode() and authToken?\n        options.cookies = [\n            key: authTokenCookieName\n            value: authToken\n            url: url\n        ]\n    else if SGN.util.isBrowser()\n        options.useCookies = true\n\n    SGN.request options, (err, data) ->\n        if err?\n            callback SGN.util.error(new Error('Graph request error'),\n                code: 'GraphRequestError'\n            )\n        else\n            # Update auth token as it might have changed.\n            if SGN.util.isNode()\n                cookies = parseCookies data.headers?['set-cookie']\n                authCookie = cookies[authTokenCookieName]\n\n                if SGN.config.get('authToken') isnt authCookie\n                    SGN.config.set 'authToken', authCookie\n\n            if data.statusCode is 200\n                callback null, data.body\n            else\n                callback SGN.util.error(new Error('Graph API error'),\n                    code: 'GraphAPIError'\n                    statusCode: data.statusCode\n                )\n\n        return\n\n    return\n\n\n","module.exports =\n    Tracker: require './tracker'\n\n    Pulse: require './pulse'\n","SGN = require '../../sgn'\n\nrequest = (options = {}, callback = ->, runs = 0) ->\n    SGN.CoreKit.session.ensure (err) ->\n        return callback err if err?\n\n        url = options.url ? ''\n        headers = options.headers ? {}\n        token = SGN.config.get 'coreSessionToken'\n        clientId = SGN.config.get 'coreSessionClientId'\n        appVersion = SGN.config.get 'appVersion'\n        appSecret = SGN.config.get 'appSecret'\n        locale = SGN.config.get 'locale'\n        qs = options.qs ? {}\n        geo = options.geolocation\n\n        headers['X-Token'] = token\n        headers['X-Signature'] = SGN.CoreKit.session.sign appSecret, token if appSecret?\n\n        qs.r_locale = locale if locale?\n        qs.api_av = appVersion if appVersion?\n        qs.client_id = clientId if clientId?\n\n        if geo?\n            qs.r_lat = geo.latitude if geo.latitude? and not qs.r_lat?\n            qs.r_lng = geo.longitude if geo.longitude? and not qs.r_lng?\n            qs.r_radius = geo.radius if geo.radius? and not qs.r_radius?\n            qs.r_sensor = geo.sensor if geo.sensor? and not qs.r_sensor?\n\n        SGN.request\n            method: options.method\n            url: SGN.config.get('coreUrl') + url\n            qs: qs\n            body: options.body\n            formData: options.formData\n            headers: headers\n            json: true\n            useCookies: false\n        , (err, data) ->\n            if err?\n                callback SGN.util.error(new Error('Core request error'),\n                    code: 'CoreRequestError'\n                )\n            else\n                token = SGN.config.get 'coreSessionToken'\n                responseToken = data.headers['x-token']\n\n                SGN.CoreKit.session.saveToken responseToken if responseToken and token isnt responseToken\n\n                if data.statusCode >= 200 and data.statusCode < 300 or data.statusCode is 304\n                    callback null, data.body\n                else\n                    if runs is 0 and data.body? and data.body.code in [1101, 1107, 1108]\n                        SGN.config.set coreSessionToken: undefined\n\n                        request options, callback, ++runs\n                    else\n                        callback SGN.util.error(new Error('Core API error'),\n                            code: 'CoreAPIError'\n                            statusCode: data.statusCode\n                        ), data.body\n\n            return\n\n    return\n\nmodule.exports = request\n","SGN = require '../../sgn'\nsha256 = require 'sha256'\nclientCookieStorage = require '../../storage/client-cookie'\ncallbackQueue = []\nrenewed = false\n\nsession =\n    ttl: 1 * 60 * 60 * 24 * 60\n\n    saveToken: (token) ->\n        throw new Error('No token provided for saving') if not token\n\n        SGN.config.set coreSessionToken: token\n\n        session.saveCookie()\n\n        return\n\n    saveClientId: (clientId) ->\n        SGN.config.set coreSessionClientId: clientId\n\n        session.saveCookie()\n\n        return\n\n    saveCookie: ->\n        clientCookieStorage.set 'session',\n            token: SGN.config.get 'coreSessionToken'\n            client_id: SGN.config.get 'coreSessionClientId'\n\n        return\n\n    create: (callback) ->\n        SGN.request\n            method: 'post'\n            url: SGN.config.get('coreUrl') + '/v2/sessions'\n            json: true\n            qs:\n                api_key: SGN.config.get 'appKey'\n                token_ttl: session.ttl\n        , (err, data) ->\n            if err?\n                callback err\n            else if data.statusCode is 201\n                session.saveToken data.body.token\n                session.saveClientId data.body.client_id\n\n                callback err, data.body\n            else\n                callback new Error('Could not create session')\n\n            return\n\n        return\n    \n    update: (callback) ->\n        headers = {}\n        token = SGN.config.get 'coreSessionToken'\n        appSecret = SGN.config.get 'appSecret'\n\n        headers['X-Token'] = token\n        headers['X-Signature'] = session.sign appSecret, token if appSecret?\n\n        SGN.request\n            url: SGN.config.get('coreUrl') + '/v2/sessions'\n            headers: headers\n            json: true\n        , (err, data) ->\n            if err?\n                callback err\n            else if data.statusCode is 200\n                session.saveToken data.body.token\n                session.saveClientId data.body.client_id\n\n                callback err, data.body\n            else\n                callback new Error('Could not update session')\n\n            return\n\n        return\n\n    renew: (callback) ->\n        headers = {}\n        token = SGN.config.get 'coreSessionToken'\n        appSecret = SGN.config.get 'appSecret'\n\n        headers['X-Token'] = token\n        headers['X-Signature'] = session.sign appSecret, token if appSecret?\n\n        SGN.request\n            method: 'put'\n            url: SGN.config.get('coreUrl') + '/v2/sessions'\n            headers: headers\n            json: true\n        , (err, data) ->\n            if err?\n                callback err\n            else if data.statusCode is 200\n                session.saveToken data.body.token\n                session.saveClientId data.body.client_id\n\n                callback err, data.body\n            else\n                callback new Error('Could not renew session')\n\n            return\n\n        return\n\n    ensure: (callback) ->\n        queueCount = callbackQueue.length\n        complete = (err) ->\n            callbackQueue = callbackQueue.filter (fn) ->\n                fn err\n\n                false\n\n            return\n\n        callbackQueue.push callback\n\n        if queueCount is 0\n            if not SGN.config.get('coreSessionToken')?\n                session.create complete\n            else if renewed is false\n                renewed = true\n                session.renew (err) ->\n                    if err?\n                        session.create complete\n                    else\n                        complete()\n                    \n                    return\n            else\n                complete()\n\n        return\n\n    sign: (appSecret, token) ->\n        sha256 [appSecret, token].join('')\n\nmodule.exports = session\n","!function(globals) {\n'use strict'\n\nvar convertHex = {\n  bytesToHex: function(bytes) {\n    /*if (typeof bytes.byteLength != 'undefined') {\n      var newBytes = []\n\n      if (typeof bytes.buffer != 'undefined')\n        bytes = new DataView(bytes.buffer)\n      else\n        bytes = new DataView(bytes)\n\n      for (var i = 0; i < bytes.byteLength; ++i) {\n        newBytes.push(bytes.getUint8(i))\n      }\n      bytes = newBytes\n    }*/\n    return arrBytesToHex(bytes)\n  },\n  hexToBytes: function(hex) {\n    if (hex.length % 2 === 1) throw new Error(\"hexToBytes can't have a string with an odd number of characters.\")\n    if (hex.indexOf('0x') === 0) hex = hex.slice(2)\n    return hex.match(/../g).map(function(x) { return parseInt(x,16) })\n  }\n}\n\n\n// PRIVATE\n\nfunction arrBytesToHex(bytes) {\n  return bytes.map(function(x) { return padLeft(x.toString(16),2) }).join('')\n}\n\nfunction padLeft(orig, len) {\n  if (orig.length > len) return orig\n  return Array(len - orig.length + 1).join('0') + orig\n}\n\n\nif (typeof module !== 'undefined' && module.exports) { //CommonJS\n  module.exports = convertHex\n} else {\n  globals.convertHex = convertHex\n}\n\n}(this);","!function(globals) {\n'use strict'\n\nvar convertString = {\n  bytesToString: function(bytes) {\n    return bytes.map(function(x){ return String.fromCharCode(x) }).join('')\n  },\n  stringToBytes: function(str) {\n    return str.split('').map(function(x) { return x.charCodeAt(0) })\n  }\n}\n\n//http://hossa.in/2012/07/20/utf-8-in-javascript.html\nconvertString.UTF8 = {\n   bytesToString: function(bytes) {\n    return decodeURIComponent(escape(convertString.bytesToString(bytes)))\n  },\n  stringToBytes: function(str) {\n   return convertString.stringToBytes(unescape(encodeURIComponent(str)))\n  }\n}\n\nif (typeof module !== 'undefined' && module.exports) { //CommonJS\n  module.exports = convertString\n} else {\n  globals.convertString = convertString\n}\n\n}(this);","!function(globals) {\n'use strict'\n\nvar _imports = {}\n\nif (typeof module !== 'undefined' && module.exports) { //CommonJS\n  _imports.bytesToHex = require('convert-hex').bytesToHex\n  _imports.convertString = require('convert-string')\n  module.exports = sha256\n} else {\n  _imports.bytesToHex = globals.convertHex.bytesToHex\n  _imports.convertString = globals.convertString\n  globals.sha256 = sha256\n}\n\n/*\nCryptoJS v3.1.2\ncode.google.com/p/crypto-js\n(c) 2009-2013 by Jeff Mott. All rights reserved.\ncode.google.com/p/crypto-js/wiki/License\n*/\n\n// Initialization round constants tables\nvar K = []\n\n// Compute constants\n!function () {\n  function isPrime(n) {\n    var sqrtN = Math.sqrt(n);\n    for (var factor = 2; factor <= sqrtN; factor++) {\n      if (!(n % factor)) return false\n    }\n\n    return true\n  }\n\n  function getFractionalBits(n) {\n    return ((n - (n | 0)) * 0x100000000) | 0\n  }\n\n  var n = 2\n  var nPrime = 0\n  while (nPrime < 64) {\n    if (isPrime(n)) {\n      K[nPrime] = getFractionalBits(Math.pow(n, 1 / 3))\n      nPrime++\n    }\n\n    n++\n  }\n}()\n\nvar bytesToWords = function (bytes) {\n  var words = []\n  for (var i = 0, b = 0; i < bytes.length; i++, b += 8) {\n    words[b >>> 5] |= bytes[i] << (24 - b % 32)\n  }\n  return words\n}\n\nvar wordsToBytes = function (words) {\n  var bytes = []\n  for (var b = 0; b < words.length * 32; b += 8) {\n    bytes.push((words[b >>> 5] >>> (24 - b % 32)) & 0xFF)\n  }\n  return bytes\n}\n\n// Reusable object\nvar W = []\n\nvar processBlock = function (H, M, offset) {\n  // Working variables\n  var a = H[0], b = H[1], c = H[2], d = H[3]\n  var e = H[4], f = H[5], g = H[6], h = H[7]\n\n    // Computation\n  for (var i = 0; i < 64; i++) {\n    if (i < 16) {\n      W[i] = M[offset + i] | 0\n    } else {\n      var gamma0x = W[i - 15]\n      var gamma0  = ((gamma0x << 25) | (gamma0x >>> 7))  ^\n                    ((gamma0x << 14) | (gamma0x >>> 18)) ^\n                    (gamma0x >>> 3)\n\n      var gamma1x = W[i - 2];\n      var gamma1  = ((gamma1x << 15) | (gamma1x >>> 17)) ^\n                    ((gamma1x << 13) | (gamma1x >>> 19)) ^\n                    (gamma1x >>> 10)\n\n      W[i] = gamma0 + W[i - 7] + gamma1 + W[i - 16];\n    }\n\n    var ch  = (e & f) ^ (~e & g);\n    var maj = (a & b) ^ (a & c) ^ (b & c);\n\n    var sigma0 = ((a << 30) | (a >>> 2)) ^ ((a << 19) | (a >>> 13)) ^ ((a << 10) | (a >>> 22));\n    var sigma1 = ((e << 26) | (e >>> 6)) ^ ((e << 21) | (e >>> 11)) ^ ((e << 7)  | (e >>> 25));\n\n    var t1 = h + sigma1 + ch + K[i] + W[i];\n    var t2 = sigma0 + maj;\n\n    h = g;\n    g = f;\n    f = e;\n    e = (d + t1) | 0;\n    d = c;\n    c = b;\n    b = a;\n    a = (t1 + t2) | 0;\n  }\n\n  // Intermediate hash value\n  H[0] = (H[0] + a) | 0;\n  H[1] = (H[1] + b) | 0;\n  H[2] = (H[2] + c) | 0;\n  H[3] = (H[3] + d) | 0;\n  H[4] = (H[4] + e) | 0;\n  H[5] = (H[5] + f) | 0;\n  H[6] = (H[6] + g) | 0;\n  H[7] = (H[7] + h) | 0;\n}\n\nfunction sha256(message, options) {;\n  if (message.constructor === String) {\n    message = _imports.convertString.UTF8.stringToBytes(message);\n  }\n\n  var H =[ 0x6A09E667, 0xBB67AE85, 0x3C6EF372, 0xA54FF53A,\n           0x510E527F, 0x9B05688C, 0x1F83D9AB, 0x5BE0CD19 ];\n\n  var m = bytesToWords(message);\n  var l = message.length * 8;\n\n  m[l >> 5] |= 0x80 << (24 - l % 32);\n  m[((l + 64 >> 9) << 4) + 15] = l;\n\n  for (var i=0 ; i<m.length; i += 16) {\n    processBlock(H, m, i);\n  }\n\n  var digestbytes = wordsToBytes(H);\n  return options && options.asBytes ? digestbytes :\n         options && options.asString ? _imports.convertString.bytesToString(digestbytes) :\n         _imports.bytesToHex(digestbytes)\n}\n\nsha256.x2 = function(message, options) {\n  return sha256(sha256(message, { asBytes:true }), options)\n}\n\n}(this);\n","SGN = require '../../sgn'\nrequest = require './request'\nsession = require './session'\n\nmodule.exports =\n    request: request\n\n    session: session\n","MicroEvent = require 'microevent'\nSGN = require '../../sgn'\n\nclass PagedPublicationPageSpread\n    constructor: (@options = {}) ->\n        @contentsRendered = false\n        @hotspotsRendered = false\n        @el = @renderEl()\n\n        return\n\n    getId: ->\n        @options.id\n\n    getEl: ->\n        @el\n\n    getPages: ->\n        @options.pages\n\n    renderEl: ->\n        el = document.createElement 'div'\n        pageIds = @getPages().map (page) -> page.id\n\n        el.className = 'verso__page-spread sgn-pp__page-spread'\n\n        el.setAttribute 'data-id', @getId()\n        el.setAttribute 'data-type', 'page'\n        el.setAttribute 'data-width', @options.width\n        el.setAttribute 'data-page-ids', pageIds.join(',')\n        el.setAttribute 'data-max-zoom-scale', @options.maxZoomScale\n        el.setAttribute 'data-zoomable', false\n\n        el\n\n    renderContents: ->\n        id = @getId()\n        el = @getEl()\n        pages = @getPages()\n        pageCount = pages.length\n        imageLoads = 0\n\n        pages.forEach (page, i) =>\n            image = page.images.medium\n            pageEl = document.createElement 'div'\n            loaderEl = document.createElement 'div'\n\n            pageEl.className = 'sgn-pp__page verso__page'\n            pageEl.setAttribute('data-id', page.id) if page.id?\n\n            if pageCount is 2\n                pageEl.className += if i is 0 then ' verso-page--verso' else ' verso-page--recto'\n\n            pageEl.appendChild loaderEl\n            el.appendChild pageEl\n\n            loaderEl.className = 'sgn-pp-page__loader'\n            loaderEl.innerHTML = \"<span>#{page.label}</span>\"\n\n            SGN.util.loadImage image, (err, width, height) =>\n                if not err?\n                    isComplete = ++imageLoads is pageCount\n\n                    pageEl.style.backgroundImage = \"url(#{image})\"\n                    pageEl.setAttribute 'data-width', width\n                    pageEl.setAttribute 'data-height', height\n                    pageEl.innerHTML = '&nbsp;'\n\n                    el.setAttribute('data-zoomable', true) if isComplete\n\n                    @trigger 'pageLoaded', pageSpreadId: id, page: page\n                    @trigger 'pagesLoaded', pageSpreadId: id, pages: pages if isComplete\n                else\n                    loaderEl.innerHTML = '<span>!</span>'\n\n                return\n\n            return\n\n        @contentsRendered = true\n\n        @\n\n    clearContents: (pageSpread, versoPageSpread) ->\n        @el.innerHTML = ''\n        @contentsRendered = false\n\n        @\n\n    zoomIn: ->\n        pageEls = [].slice.call @el.querySelectorAll('.sgn-pp__page')\n        pages = @getPages()\n\n        pageEls.forEach (pageEl) =>\n            id = pageEl.getAttribute 'data-id'\n            page = SGN.util.find pages, (page) -> page.id is id\n            image = page.images.large\n\n            SGN.util.loadImage image, (err) =>\n                if not err? and @el.getAttribute('data-active') is 'true'\n                    pageEl.setAttribute 'data-image', pageEl.style.backgroundImage\n                    pageEl.style.backgroundImage = \"url(#{image})\"\n\n                return\n\n            return\n\n        return\n\n    zoomOut: ->\n        pageEls = [].slice.call @el.querySelectorAll('.sgn-pp__page[data-image]')\n\n        pageEls.forEach (pageEl) ->\n            pageEl.style.backgroundImage = pageEl.getAttribute 'data-image'\n            \n            pageEl.removeAttribute 'data-image'\n\n            return\n\n        return\n\nMicroEvent.mixin PagedPublicationPageSpread\n\nmodule.exports = PagedPublicationPageSpread\n","MicroEvent = require 'microevent'\nPageSpread = require './page-spread'\nSGN = require '../../sgn'\n\nclass PagedPublicationPageSpreads\n    constructor: (@options) ->\n        @collection = []\n        @ids = {}\n\n        return\n\n    get: (id) ->\n        @ids[id]\n\n    getFrag: ->\n        frag = document.createDocumentFragment()\n\n        @collection.forEach (pageSpread) -> frag.appendChild pageSpread.el\n\n        frag\n\n    update: (pageMode = 'single') ->\n        pageSpreads = []\n        ids = {}\n        pages = @options.pages.slice()\n        width = @options.width\n        maxZoomScale = @options.maxZoomScale\n\n        if pageMode is 'single'\n            pages.forEach (page) -> pageSpreads.push [page]\n        else\n            firstPage = pages.shift()\n            lastPage = if pages.length % 2 is 1 then pages.pop() else null\n            midstPageSpreads = SGN.util.chunk pages, 2\n\n            pageSpreads.push [firstPage] if firstPage?\n            midstPageSpreads.forEach (midstPages) -> pageSpreads.push midstPages.map (page) -> page\n            pageSpreads.push [lastPage] if lastPage?\n\n        @collection = pageSpreads.map (pages, i) =>\n            id = \"#{pageMode}-#{i}\"\n            pageSpread = new PageSpread\n                width: width\n                maxZoomScale: maxZoomScale\n                pages: pages\n                id: id\n\n            pageSpread.bind 'pageLoaded', (e) => @trigger 'pageLoaded', e\n            pageSpread.bind 'pagesLoaded', (e) => @trigger 'pagesLoaded', e\n\n            ids[id] = pageSpread\n\n            pageSpread\n        @ids = ids\n\n        @\n\nMicroEvent.mixin PagedPublicationPageSpreads\n\nmodule.exports = PagedPublicationPageSpreads\n","MicroEvent = require 'microevent'\nPageSpreads = require './page-spreads'\nclientLocalStorage = require '../../storage/client-local'\nSGN = require '../../sgn'\n\nclass PagedPublicationCore\n    defaults:\n        pages: []\n        pageSpreadWidth: 100\n        pageSpreadMaxZoomScale: 2.3\n        idleDelay: 1000\n        resizeDelay: 400\n        color: '#ffffff'\n\n    constructor: (el, options = {}) ->\n        @options = @makeOptions options, @defaults\n        @pageId = @getOption 'pageId'\n        @els =\n            root: el\n            pages: el.querySelector '.sgn-pp__pages'\n            verso: el.querySelector '.verso'\n        @pageMode = @getPageMode()\n        @pageSpreads = new PageSpreads\n            pages: @getOption 'pages'\n            maxZoomScale: @getOption 'pageSpreadMaxZoomScale'\n            width: @getOption 'pageSpreadWidth'\n\n        @pageSpreads.bind 'pageLoaded', @pageLoaded.bind(@)\n        @pageSpreads.bind 'pagesLoaded', @pagesLoaded.bind(@)\n\n        @setColor @getOption('color')\n\n        # It's important to insert the page spreads before instantiating Verso.\n        @els.pages.parentNode.insertBefore @pageSpreads.update(@pageMode).getFrag(), @els.pages\n\n        @verso = @createVerso()\n\n        @bind 'started', @start.bind(@)\n        @bind 'destroyed', @destroy.bind(@)\n\n        return\n\n    start: ->\n        @getVerso().start()\n\n        @visibilityChangeListener = @visibilityChange.bind @\n        @resizeListener = SGN.util.throttle @resize, @getOption('resizeDelay'), @\n        @unloadListener = @unload.bind @\n\n        document.addEventListener 'visibilitychange', @visibilityChangeListener, false\n        window.addEventListener 'resize', @resizeListener, false\n        window.addEventListener 'beforeunload', @unloadListener, false\n\n        @els.root.setAttribute 'data-started', ''\n        @els.root.setAttribute 'tabindex', '-1'\n        @els.root.focus()\n\n        return\n\n    destroy: ->\n        verso = @getVerso()\n        pageSpreadEls = verso.el.querySelectorAll '.sgn-pp__page-spread'\n\n        @els.root.removeAttribute 'data-started'\n        @els.root.removeAttribute 'data-idle'\n        @els.root.removeAttribute 'data-navigating'\n        @els.root.removeAttribute 'data-color-brightness'\n        @els.root.removeAttribute 'data-zoomed-in'\n\n        @els.root.style.backgroundColor = '#ffffff'\n\n        pageSpreadEl.parentNode.removeChild pageSpreadEl for pageSpreadEl in pageSpreadEls\n\n        verso.destroy()\n\n        document.removeEventListener 'visibilitychange', @visibilityChangeListener, false\n        window.removeEventListener 'resize', @resizeListener, false\n        window.removeEventListener 'beforeunload', @unloadListener, false\n\n        return\n\n    makeOptions: (options, defaults) ->\n        opts = {}\n\n        opts[key] = options[key] ? defaults[key] for key, value of options\n\n        opts\n\n    getOption: (key) ->\n        @options[key]\n\n    setColor: (color) ->\n        @els.root.setAttribute 'data-color-brightness', SGN.util.getColorBrightness(color)\n        @els.root.style.backgroundColor = color\n\n        return\n\n    createVerso: ->\n        Verso = require 'verso-browser'\n        verso = new Verso @els.verso, pageId: @pageId\n\n        verso.pageSpreads.forEach @overridePageSpreadContentRect.bind(@)\n\n        verso.bind 'beforeNavigation', @beforeNavigation.bind(@)\n        verso.bind 'afterNavigation', @afterNavigation.bind(@)\n        verso.bind 'attemptedNavigation', @attemptedNavigation.bind(@)\n        verso.bind 'clicked', @clicked.bind(@)\n        verso.bind 'doubleClicked', @doubleClicked.bind(@)\n        verso.bind 'pressed', @pressed.bind(@)\n        verso.bind 'contextmenu', @contextmenu.bind(@)\n        verso.bind 'panStart', @panStart.bind(@)\n        verso.bind 'panEnd', @panEnd.bind(@)\n        verso.bind 'zoomedIn', @zoomedIn.bind(@)\n        verso.bind 'zoomedOut', @zoomedOut.bind(@)\n\n        verso\n\n    getVerso: ->\n        @verso\n\n    getContentRect: (pageSpread) ->\n        rect =\n            top: 0\n            left: 0\n            right: 0\n            bottom: 0\n            width: 0\n            height: 0\n        pageEls = pageSpread.getPageEls()\n        pageEl = pageEls[0]\n        pageCount = pageEls.length\n\n        return rect if not pageCount\n        \n        scale = @getVerso().transform.scale\n        pageWidth = pageEl.offsetWidth * pageCount * scale\n        pageHeight = pageEl.offsetHeight * scale\n        imageRatio = +pageEl.getAttribute('data-height') / (+pageEl.getAttribute('data-width') * pageCount)\n        actualHeight = pageHeight\n        actualWidth = actualHeight / imageRatio\n        actualWidth = Math.min pageWidth, actualWidth\n        actualHeight = actualWidth * imageRatio\n        clientRect = pageEl.getBoundingClientRect()\n\n        rect.width = actualWidth\n        rect.height = actualHeight\n        rect.top = clientRect.top + (pageHeight - actualHeight) / 2\n        rect.left = clientRect.left + (pageWidth - actualWidth) / 2\n        rect.right = rect.width + rect.left\n        rect.bottom = rect.height + rect.top\n\n        rect\n\n    formatProgressLabel: (pageSpread) ->\n        pages = pageSpread?.options.pages ? []\n        pageIds = pages.map (page) -> page.id\n        pageLabels = pages.map (page) -> page.label\n        pageCount = @getOption('pages').length\n        label = if pageIds.length > 0 then pageLabels.join('-') + ' / ' + pageCount else null\n\n        label\n\n    renderPageSpreads: ->\n        @getVerso().pageSpreads.forEach (pageSpread) =>\n            visibility = pageSpread.getVisibility()\n            match = @pageSpreads.get pageSpread.getId()\n\n            if match?\n                if visibility is 'visible' and match.contentsRendered is false\n                    setTimeout match.renderContents.bind(match), 0\n                if visibility is 'gone' and match.contentsRendered is true\n                    setTimeout match.clearContents.bind(match), 0\n\n            return\n\n        @\n\n    findPage: (pageId) ->\n        SGN.util.find @getOption('pages'), (page) -> page.id is pageId\n\n    pageLoaded: (e) ->\n        @trigger 'pageLoaded', e\n\n        return\n\n    pagesLoaded: (e) ->\n        @trigger 'pagesLoaded', e\n\n        return\n\n    beforeNavigation: (e) ->\n        position = e.newPosition\n        theVerso = @getVerso()\n        versoPageSpread = theVerso.getPageSpreadFromPosition position\n        pageSpread = @pageSpreads.get versoPageSpread.getId()\n        pageSpreadCount = theVerso.getPageSpreadCount()\n        newSpreadEl = theVerso.pageSpreadEls[e.newPosition]\n        progress = position / (pageSpreadCount - 1) * 100\n        progressLabel = @formatProgressLabel pageSpread\n\n        @els.root.setAttribute 'data-navigating', true\n\n        @renderPageSpreads()\n        @resetIdleTimer()\n        @startIdleTimer()\n        @trigger 'beforeNavigation',\n            verso: e\n            pageSpread: pageSpread\n            newSpreadEl: newSpreadEl\n            progress: progress\n            progressLabel: progressLabel\n            pageSpreadCount: pageSpreadCount\n            newPositionIsEnd: e.newPosition + 1 == pageSpreadCount\n\n        return\n\n    afterNavigation: (e) ->\n        position = e.newPosition\n        theVerso = @getVerso()\n        versoPageSpread = theVerso.getPageSpreadFromPosition position\n        pageSpread = @pageSpreads.get versoPageSpread.getId()\n        pageSpreadCount = theVerso.getPageSpreadCount()\n        newSpreadEl = theVerso.pageSpreadEls[e.newPosition]\n\n        @els.root.setAttribute 'data-navigating', false\n\n        @trigger 'afterNavigation',\n            verso: e\n            pageSpread: pageSpread\n            pageSpreadCount: pageSpreadCount\n            newSpreadEl: newSpreadEl\n            newPositionIsEnd: e.newPosition + 1 == pageSpreadCount\n\n        return\n\n    attemptedNavigation: (e) ->\n        @trigger 'attemptedNavigation', verso: e\n\n        return\n\n    clicked: (e) ->\n        if e.isInsideContent\n            pageId = e.pageEl.getAttribute 'data-id'\n            page = @findPage pageId\n\n            @trigger 'clicked', verso: e, page: page\n\n        return\n\n    doubleClicked: (e) ->\n        if e.isInsideContent\n            pageId = e.pageEl.getAttribute 'data-id'\n            page = @findPage pageId\n\n            @trigger 'doubleClicked', verso: e, page: page\n\n        return\n\n    pressed: (e) ->\n        if e.isInsideContent\n            pageId = e.pageEl.getAttribute 'data-id'\n            page = @findPage pageId\n\n            @trigger 'pressed', verso: e, page: page\n\n        return\n\n    contextmenu: (e) ->\n        if e.isInsideContent\n            pageId = e.pageEl.getAttribute 'data-id'\n            page = @findPage pageId\n\n            @trigger 'contextmenu', verso: e, page: page\n\n        return\n\n    panStart: ->\n        @resetIdleTimer()\n        @trigger 'panStart', scale: @getVerso().transform.scale\n\n        return\n\n    panEnd: ->\n        @startIdleTimer()\n        @trigger 'panEnd'\n\n        return\n\n    zoomedIn: (e) ->\n        position = e.position\n        versoPageSpread = @getVerso().getPageSpreadFromPosition position\n        pageSpread = @pageSpreads.get versoPageSpread.getId()\n\n        pageSpread.zoomIn() if pageSpread?\n\n        @els.root.setAttribute 'data-zoomed-in', true\n        @trigger 'zoomedIn', verso: e, pageSpread: pageSpread\n\n        return\n\n    zoomedOut: (e) ->\n        position = e.position\n        versoPageSpread = @getVerso().getPageSpreadFromPosition position\n        pageSpread = @pageSpreads.get versoPageSpread.getId()\n\n        pageSpread.zoomOut() if pageSpread?\n\n        @els.root.setAttribute 'data-zoomed-in', false\n        @trigger 'zoomedOut', verso: e, pageSpread: pageSpread\n\n        return\n\n    getPageMode: ->\n        pageMode = @getOption 'pageMode'\n\n        if not pageMode?\n            width = @els.root.offsetWidth\n            height = @els.root.offsetHeight\n\n            pageMode = if height / width < 0.8 then 'double' else 'single'\n\n        pageMode\n\n    resetIdleTimer: ->\n        clearTimeout @idleTimeout\n\n        @els.root.setAttribute 'data-idle', false\n\n        @\n\n    startIdleTimer: ->\n        @idleTimeout = setTimeout =>\n            @els.root.setAttribute 'data-idle', true\n\n            return\n        , @getOption('idleDelay')\n\n        @\n\n    switchPageMode: (pageMode) ->\n        return @ if @pageMode is pageMode\n\n        verso = @getVerso()\n        pageIds = verso.getPageSpreadFromPosition(verso.getPosition()).getPageIds()\n        pageSpreadEls = @getVerso().el.querySelectorAll '.sgn-pp__page-spread'\n\n        @pageMode = pageMode\n\n        @pageSpreads.update @pageMode\n\n        pageSpreadEl.parentNode.removeChild pageSpreadEl for pageSpreadEl in pageSpreadEls\n        @els.pages.parentNode.insertBefore @pageSpreads.getFrag(), @els.pages\n\n        verso.refresh()\n        verso.navigateTo verso.getPageSpreadPositionFromPageId(pageIds[0]), duration: 0\n        verso.pageSpreads.forEach @overridePageSpreadContentRect.bind(@)\n\n        @\n\n    overridePageSpreadContentRect: (pageSpread) ->\n        if pageSpread.getType() is 'page'\n            pageSpread.getContentRect = => @getContentRect pageSpread\n\n    visibilityChange: ->\n        pageSpread = @getVerso().getPageSpreadFromPosition @getVerso().getPosition()\n        eventName = if document.hidden is true then 'disappeared' else 'appeared'\n\n        @trigger eventName, pageSpread: @pageSpreads.get(pageSpread.id)\n\n        return\n\n    resize: ->\n        pageMode = @getPageMode()\n\n        if not @getOption('pageMode')? and pageMode isnt @pageMode\n            @switchPageMode pageMode\n        else\n            @trigger 'resized'\n\n        return\n\n    unload: ->\n        @trigger 'disappeared'\n\n        return\n\nMicroEvent.mixin PagedPublicationCore\n\nmodule.exports = PagedPublicationCore\n","MicroEvent = require 'microevent'\nMustache = require 'mustache'\ntemplate = require './templates/hotspot'\n\nclass PagedPublicationHotspots\n    constructor: ->\n        @currentPageSpreadId = null\n        @pageSpreadsLoaded = {}\n        @cache = {}\n\n        @bind 'hotspotsReceived', @hotspotsReceived.bind(@)\n        @bind 'afterNavigation', @afterNavigation.bind(@)\n        @bind 'pagesLoaded', @pagesLoaded.bind(@)\n        @bind 'resized', @resized.bind(@)\n\n        return\n\n    renderHotspots: (data) ->\n        frag = document.createDocumentFragment()\n        contentRect = data.versoPageSpread.getContentRect()\n        pageSpreadEl = data.pageSpread.getEl()\n        hotspotEls = pageSpreadEl.querySelectorAll '.sgn-pp__hotspot'\n        boundingRect = pageSpreadEl.getBoundingClientRect()\n\n        hotspotEl.parentNode.removeChild hotspotEl for hotspotEl in hotspotEls\n\n        for id, hotspot of data.hotspots\n            position = @getPosition data.pages, data.ratio, hotspot\n            el = @renderHotspot hotspot, position, contentRect, boundingRect\n            \n            frag.appendChild el\n\n        pageSpreadEl.appendChild frag\n\n        @\n\n    renderHotspot: (hotspot, position, contentRect, boundingRect) ->\n        el = document.createElement 'div'\n        top = Math.round contentRect.height / 100 * position.top\n        left = Math.round contentRect.width / 100 * position.left\n        width = Math.round contentRect.width / 100 * position.width\n        height = Math.round contentRect.height / 100 * position.height\n\n        top += Math.round contentRect.top\n        left += Math.round contentRect.left\n        top -= boundingRect.top\n        left -= boundingRect.left\n\n        el.className = 'sgn-pp__hotspot verso__overlay'\n        el.setAttribute 'data-id', hotspot.id if hotspot.id?\n        el.setAttribute 'data-type', hotspot.type if hotspot.type?\n        el.innerHTML = Mustache.render hotspot.template ? template, hotspot\n\n        el.style.top = \"#{top}px\"\n        el.style.left = \"#{left}px\"\n        el.style.width = \"#{width}px\"\n        el.style.height = \"#{height}px\"\n\n        el\n\n    getPosition: (pages, ratio, hotspot) ->\n        minX = null\n        minY = null\n        maxX = null\n        maxY = null\n        pageNumbers = pages.map (page) -> page.pageNumber\n\n        for pageNumber of hotspot.locations\n            continue if pageNumbers.indexOf(+pageNumber) is -1\n\n            hotspot.locations[pageNumber].forEach (coords) ->\n                x = coords[0]\n                y = coords[1]\n\n                x +=1 if pages[1] and pageNumbers[1] is +pageNumber\n                x /= pages.length\n\n                if not minX?\n                    minX = maxX = x\n                    minY = maxY = y\n\n                minX = x if x < minX\n                maxX = x if x > maxX\n                minY = y if y < minY\n                maxY = y if y > maxY\n\n        width = maxX - minX\n        height = maxY - minY\n\n        top: minY / ratio * 100\n        left: minX * 100\n        width: width * 100\n        height: height / ratio * 100\n\n    requestHotspots: (pageSpreadId, pages) ->\n        @trigger 'hotspotsRequested',\n            id: pageSpreadId\n            pages: pages\n\n        return\n\n    hotspotsReceived: (e) ->\n        pageSpreadId = e.pageSpread.getId()\n\n        @setCache pageSpreadId, e\n        @renderHotspots e\n\n        return\n\n    getCache: (pageSpreadId) ->\n        @cache[pageSpreadId]\n\n    setCache: (pageSpreadId, data) ->\n        @cache[pageSpreadId] = data\n\n        @\n\n    afterNavigation: (e) ->\n        return if not e.pageSpread?\n\n        id = e.pageSpread.getId()\n\n        @currentPageSpreadId = id\n        @requestHotspots id, e.pageSpread.getPages() if @pageSpreadsLoaded[id]\n\n        return\n\n    pagesLoaded: (e) ->\n        @pageSpreadsLoaded[e.pageSpreadId] = true\n        @requestHotspots e.pageSpreadId, e.pages if @currentPageSpreadId is e.pageSpreadId\n\n        return\n\n    resized: (e) ->\n        data = @getCache @currentPageSpreadId\n\n        @renderHotspots data if data?\n\n        return\n\nMicroEvent.mixin PagedPublicationHotspots\n\nmodule.exports = PagedPublicationHotspots\n\n\n","module.exports = \"\"\"\n\"\"\"\n","MicroEvent = require 'microevent'\nSGN = require '../../sgn'\nkeyCodes = require '../../key-codes'\n\nclass PagedPublicationControls\n    constructor: (el, @options = {}) ->\n        @els =\n            root: el\n            progress: el.querySelector '.sgn-pp__progress'\n            progressBar: el.querySelector '.sgn-pp-progress__bar'\n            progressLabel: el.querySelector '.sgn-pp__progress-label'\n            prevControl: el.querySelector '.sgn-pp__control[data-direction=prev]'\n            nextControl: el.querySelector '.sgn-pp__control[data-direction=next]'\n            close: el.querySelector '.sgn-pp--close'\n\n        @keyDownListener = SGN.util.throttle @keyDown, 150, @\n\n        @els.root.addEventListener 'keydown', @keyDownListener, false if @options.keyboard is true\n        @els.prevControl.addEventListener 'click', @prevClicked.bind(@), false if @els.prevControl?\n        @els.nextControl.addEventListener 'click', @nextClicked.bind(@), false if @els.nextControl?\n        @els.close.addEventListener 'click', @closeClicked.bind(@), false if @els.close?\n\n        @bind 'beforeNavigation', @beforeNavigation.bind(@)\n\n        return\n\n    destroy: ->\n        @els.root.removeEventListener 'keydown', @keyDownListener\n\n        return\n\n    beforeNavigation: (e) ->\n        showProgress = typeof e.progressLabel is 'string' and e.progressLabel.length > 0\n        visibilityClassName = 'sgn-pp--hidden'\n\n        if @els.progress? and @els.progressBar?\n            @els.progressBar.style.width = \"#{e.progress}%\"\n\n            if showProgress is true\n                @els.progress.classList.remove visibilityClassName\n            else\n                @els.progress.classList.add visibilityClassName\n\n        if @els.progressLabel?\n            if showProgress is true\n                @els.progressLabel.textContent = e.progressLabel\n                @els.progressLabel.classList.remove visibilityClassName\n            else\n                @els.progressLabel.classList.add visibilityClassName\n\n        if @els.prevControl?\n            if e.verso.newPosition is 0\n                @els.prevControl.classList.add visibilityClassName\n            else\n                @els.prevControl.classList.remove visibilityClassName\n\n        if @els.nextControl?\n            if e.verso.newPosition is e.pageSpreadCount - 1\n                @els.nextControl.classList.add visibilityClassName\n            else\n                @els.nextControl.classList.remove visibilityClassName\n\n        return\n\n    prevClicked: (e) ->\n        e.preventDefault()\n\n        @trigger 'prev'\n\n        return\n\n    nextClicked: (e) ->\n        e.preventDefault()\n\n        @trigger 'next'\n\n        return\n    \n    closeClicked: (e) ->\n        e.preventDefault()\n\n        @trigger 'close'\n\n        return\n\n    keyDown: (e) ->\n        keyCode = e.keyCode\n\n        if keyCodes.ARROW_LEFT is keyCode\n            @trigger 'prev', duration: 0\n        else if keyCodes.ARROW_RIGHT is keyCode or keyCodes.SPACE is keyCode\n            @trigger 'next', duration: 0\n        else if keyCodes.NUMBER_ONE is keyCode\n            @trigger 'first', duration: 0\n\n        return\n\nMicroEvent.mixin PagedPublicationControls\n\nmodule.exports = PagedPublicationControls\n","module.exports =\n    ESC: 27\n    ARROW_RIGHT: 39\n    ARROW_LEFT: 37\n    SPACE: 32\n    NUMBER_ONE: 49\n","MicroEvent = require 'microevent'\n\nclass PagedPublicationEventTracking\n    constructor: ->\n        @hidden = true\n        @pageSpread = null\n\n        @bind 'appeared', @appeared.bind(@)\n        @bind 'disappeared', @disappeared.bind(@)\n        @bind 'beforeNavigation', @beforeNavigation.bind(@)\n        @bind 'afterNavigation', @afterNavigation.bind(@)\n        @bind 'attemptedNavigation', @attemptedNavigation.bind(@)\n        @bind 'clicked', @clicked.bind(@)\n        @bind 'doubleClicked', @doubleClicked.bind(@)\n        @bind 'pressed', @pressed.bind(@)\n        @bind 'panStart', @panStart.bind(@)\n        @bind 'zoomedIn', @zoomedIn.bind(@)\n        @bind 'zoomedOut', @zoomedOut.bind(@)\n        @bind 'destroyed', @destroy.bind(@)\n\n        return\n\n    destroy: ->\n        @pageSpreadDisappeared()\n\n        return\n\n    trackEvent: (type, properties = {}) ->\n        @trigger 'trackEvent', type: type, properties: properties\n\n        return\n\n    trackOpened: (properties) ->\n        @trackEvent 'paged-publication-opened', properties\n\n        @\n\n    trackPageClicked: (properties) ->\n        @trackEvent 'paged-publication-page-clicked', properties\n\n        @\n\n    trackPageDoubleClicked: (properties) ->\n        @trackEvent 'paged-publication-page-double-clicked', properties\n\n        @\n\n    trackPageLongPressed: (properties) ->\n        @trackEvent 'paged-publication-page-long-pressed', properties\n\n        @\n\n    trackPageHotspotsClicked: (properties) ->\n        @trackEvent 'paged-publication-page-hotspots-clicked', properties\n\n        @\n\n    trackPageSpreadAppeared: (properties) ->\n        @trackEvent 'paged-publication-page-spread-appeared', properties\n\n        @\n\n    trackPageSpreadDisappeared: (properties) ->\n        @trackEvent 'paged-publication-page-spread-disappeared', properties\n\n        @\n\n    trackPageSpreadZoomedIn: (properties) ->\n        @trackEvent 'paged-publication-page-spread-zoomed-in', properties\n\n        @\n\n    trackPageSpreadZoomedOut: (properties) ->\n        @trackEvent 'paged-publication-page-spread-zoomed-out', properties\n\n        @\n\n    appeared: (e) ->\n        @pageSpreadAppeared e.pageSpread\n\n        return\n\n    disappeared: ->\n        @pageSpreadDisappeared()\n\n        return\n\n    beforeNavigation: ->\n        @pageSpreadDisappeared()\n\n        return\n\n    afterNavigation: (e) ->\n        @pageSpreadAppeared e.pageSpread\n\n        return\n\n    attemptedNavigation: (e) ->\n        @pageSpreadAppeared e.pageSpread\n\n        return\n\n    clicked: (e) ->\n        if e.page?\n            properties =\n                pageNumber: e.page.pageNumber\n                x: e.verso.pageX\n                y: e.verso.pageY\n\n            @trackPageClicked pagedPublicationPage: properties\n            @trackPageHotspotsClicked pagedPublicationPage: properties if e.verso.overlayEls.length > 0\n\n        return\n\n    doubleClicked: (e) =>\n        if e.page?\n            @trackPageDoubleClicked pagedPublicationPage:\n                pageNumber: e.page.pageNumber\n                x: e.verso.pageX\n                y: e.verso.pageY\n\n        return\n\n    pressed: (e) ->\n        if e.page?\n            @trackPageLongPressed pagedPublicationPage:\n                pageNumber: e.page.pageNumber\n                x: e.verso.pageX\n                y: e.verso.pageY\n\n        return\n\n    panStart: (e) ->\n        @pageSpreadDisappeared() if e.scale is 1\n\n        return\n\n    zoomedIn: (e) ->\n        if e.pageSpread?\n            @trackPageSpreadZoomedIn pagedPublicationPageSpread:\n                pageNumbers: e.pageSpread.getPages().map (page) -> page.pageNumber\n\n        return\n\n    zoomedOut: (e) ->\n        if e.pageSpread?\n            @trackPageSpreadZoomedOut pagedPublicationPageSpread:\n                pageNumbers: e.pageSpread.getPages().map (page) -> page.pageNumber\n\n        return\n\n    pageSpreadAppeared: (pageSpread) ->\n        if pageSpread? and @hidden is true\n            @pageSpread = pageSpread\n\n            @trackPageSpreadAppeared pagedPublicationPageSpread:\n                pageNumbers: pageSpread.getPages().map (page) -> page.pageNumber\n\n            @hidden = false\n\n        return\n\n    pageSpreadDisappeared: ->\n        if @pageSpread? and @hidden is false\n            @trackPageSpreadDisappeared pagedPublicationPageSpread:\n                pageNumbers: @pageSpread.getPages().map (page) -> page.pageNumber\n\n            @hidden = true\n            @pageSpread = null\n\n        return\n\nMicroEvent.mixin PagedPublicationEventTracking\n\nmodule.exports = PagedPublicationEventTracking\n","MicroEvent = require 'microevent'\nSGN = require '../../sgn'\nCore = require './core'\nHotspots = require './hotspots'\nControls = require './controls'\nEventTracking = require './event-tracking'\n\nclass Viewer\n    constructor: (@el, @options = {}) ->\n        @_core = new Core @el,\n            id: @options.id\n            pages: @options.pages\n            pageSpreadWidth: @options.pageSpreadWidth\n            pageSpreadMaxZoomScale: @options.pageSpreadMaxZoomScale\n            pageId: @options.pageId\n            idleDelay: @options.idleDelay\n            resizeDelay: @options.resizeDelay\n            color: @options.color\n        @_hotspots = new Hotspots()\n        @_controls = new Controls @el, keyboard: @options.keyboard\n        @_eventTracking = new EventTracking()\n        @viewSession = SGN.util.uuid()\n\n        @_setupEventListeners()\n\n        return\n\n    start: ->\n        @_eventTracking.trackOpened()\n        @_core.trigger 'started'\n\n        @\n\n    destroy: ->\n        @_core.trigger 'destroyed'\n        @_hotspots.trigger 'destroyed'\n        @_controls.trigger 'destroyed'\n        @_eventTracking.trigger 'destroyed'\n\n        @trigger 'destroyed'\n\n        @\n\n    navigateTo: (position, options) ->\n        @navigateToIndex position, options\n\n        @\n\n    navigateToIndex: (position, options) ->\n        @_core.getVerso().navigateTo position, options\n\n        @\n    \n    navigateToPageId: (pageId, options) ->\n        position = @_core.getVerso().getPageSpreadPositionFromPageId pageId\n        \n        @_core.getVerso().navigateTo position, options\n\n    first: (options) ->\n        @_core.getVerso().first options\n\n        @\n\n    prev: (options) ->\n        @_core.getVerso().prev options\n\n        @\n\n    next: (options) ->\n        @_core.getVerso().next options\n\n        @\n\n    last: (options) ->\n        @_core.getVerso().last options\n\n        @\n\n    _trackEvent: (e) ->\n        type = e.type\n        idType = 'legacy'\n        properties = pagedPublication:\n            id: [idType, @options.id]\n            ownedBy: [idType, @options.ownedBy]\n        eventTracker = @options.eventTracker\n\n        properties[key] = value for key, value of e.properties\n\n        eventTracker.trackEvent type, properties if eventTracker?\n\n        return\n\n    _setupEventListeners: ->\n        @_eventTracking.bind 'trackEvent', (e) =>\n            @_trackEvent e\n\n            return\n\n        @_controls.bind 'prev', (e) =>\n            @prev e\n            \n            return\n        @_controls.bind 'next', (e) =>\n            @next e\n            \n            return\n        @_controls.bind 'first', (e) =>\n            @first e\n            \n            return\n        @_controls.bind 'last', (e) =>\n            @last e\n            \n            return\n        @_controls.bind 'close', (e) =>\n            @destroy e\n\n            return\n        @_hotspots.bind 'hotspotsRequested', (e) =>\n            @trigger 'hotspotsRequested', e\n\n            return\n\n        @_core.bind 'appeared', (e) =>\n            @_eventTracking.trigger 'appeared', e\n            @trigger 'appeared', e\n\n            return\n        @_core.bind 'disappeared', (e) =>\n            @_eventTracking.trigger 'disappeared', e\n            @trigger 'disappeared', e\n\n            return\n        @_core.bind 'beforeNavigation', (e) =>\n            @_eventTracking.trigger 'beforeNavigation', e\n            @_controls.trigger 'beforeNavigation', e\n            @trigger 'beforeNavigation', e\n\n            return\n        @_core.bind 'afterNavigation', (e) =>\n            @_eventTracking.trigger 'afterNavigation', e\n            @_hotspots.trigger 'afterNavigation', e\n            @trigger 'afterNavigation', e\n\n            return\n        @_core.bind 'attemptedNavigation', (e) =>\n            @_eventTracking.trigger 'attemptedNavigation', e\n            @trigger 'attemptedNavigation', e\n\n            return\n        @_core.bind 'clicked', (e) =>\n            @_eventTracking.trigger 'clicked', e\n            @trigger 'clicked', e\n\n            return\n        @_core.bind 'doubleClicked', (e) =>\n            @_eventTracking.trigger 'doubleClicked', e\n            @trigger 'doubleClicked', e\n\n            return\n        @_core.bind 'contextmenu', (e) =>\n            @trigger 'contextmenu', e\n\n            return\n        @_core.bind 'pressed', (e) =>\n            @_eventTracking.trigger 'pressed', e\n            @trigger 'pressed', e\n\n            return\n        @_core.bind 'panStart', (e) =>\n            @_eventTracking.trigger 'panStart', e\n            @trigger 'panStart', e\n\n            return\n        @_core.bind 'zoomedIn', (e) =>\n            @_eventTracking.trigger 'zoomedIn', e\n            @trigger 'zoomedIn', e\n\n            return\n        @_core.bind 'zoomedOut', (e) =>\n            @_eventTracking.trigger 'zoomedOut', e\n            @trigger 'zoomedOut', e\n\n            return\n        @_core.bind 'pageLoaded', (e) =>\n            @_eventTracking.trigger 'pageLoaded', e\n            @trigger 'pageLoaded', e\n\n            return\n        @_core.bind 'pagesLoaded', (e) =>\n            @_hotspots.trigger 'pagesLoaded', e\n            @trigger 'pagesLoaded', e\n\n            return\n        @_core.bind 'resized', (e) =>\n            @_hotspots.trigger 'resized'\n            @trigger 'resized', e\n\n            return\n\n        @bind 'hotspotsReceived', (e) =>\n            @_hotspots.trigger 'hotspotsReceived',\n                pageSpread: @_core.pageSpreads.get e.id\n                versoPageSpread: SGN.util.find @_core.getVerso().pageSpreads, (pageSpread) ->\n                    pageSpread.getId() is e.id\n                ratio: e.ratio\n                pages: e.pages\n                hotspots: e.hotspots\n\n            return\n\n        return\n\nMicroEvent.mixin Viewer\n\nmodule.exports = Viewer\n","MicroEvent = require 'microevent'\nGator = require 'gator'\nMustache = require 'mustache'\ntemplate = require './templates/hotspot-picker'\nkeyCodes = require '../../key-codes'\n\nclass PagedPublicationHotspotPicker\n    constructor: (@options = {}) ->\n        @el = document.createElement 'div'\n        @resizeListener = @resize.bind @\n\n        return\n\n    render: ->\n        width = @options.width ? 100\n        header = @options.header\n        template = @options.template if @options.template?\n        trigger = @trigger.bind @\n        view =\n            header: header\n            hotspots: @options.hotspots\n            top: @options.y\n            left: @options.x\n\n        @el.className = 'sgn-pp__hotspot-picker'\n        @el.setAttribute 'tabindex', -1\n        @el.innerHTML = Mustache.render template, view\n\n        popoverEl = @el.querySelector '.sgn__popover'\n        width = popoverEl.offsetWidth\n        height = popoverEl.offsetHeight\n        parentWidth = @el.parentNode.offsetWidth\n        parentHeight = @el.parentNode.offsetHeight\n        boundingRect = @el.parentNode.getBoundingClientRect()\n\n        view.top -= boundingRect.top\n        view.left -= boundingRect.left\n\n        if view.top + height > parentHeight\n            popoverEl.style.top = parentHeight - height + 'px'\n        else\n            popoverEl.style.top = view.top + 'px'\n\n        if view.left + width > parentWidth\n            popoverEl.style.left = parentWidth - width + 'px'\n        else\n            popoverEl.style.left = view.left + 'px'\n\n        @el.addEventListener 'keyup', @keyUp.bind(@)\n\n        Gator(@el).on 'click', '[data-id]', ->\n            trigger 'selected', id: @getAttribute('data-id')\n\n            return\n\n        Gator(@el).on 'click', '[data-close]', @destroy.bind(@)\n\n        window.addEventListener 'resize', @resizeListener, false\n\n        @\n\n    destroy: ->\n        @el.parentNode.removeChild @el\n\n        @trigger 'destroyed'\n\n        return\n\n    keyUp: (e) ->\n        @destroy() if e.keyCode is keyCodes.ESC\n        \n        return\n\n    resize: ->\n        window.removeEventListener 'resize', @resizeListener\n\n        @destroy()\n\n        return\n\nMicroEvent.mixin PagedPublicationHotspotPicker\n\nmodule.exports = PagedPublicationHotspotPicker\n","MicroEvent = require 'microevent'\nSGN = require '../../core'\n\nmodule.exports = (options = {}, callback) ->\n    data =\n        details: null\n        pages: null\n        hotspots: null\n    viewer = null\n    hotspots = {}\n    hotspotQueue = []\n    hotspotPicker = null\n    fetch = (callback) ->\n        if options.data?.details\n            callback null, options.data.details\n        else\n            SGN.CoreKit.request\n                url: \"/v2/catalogs/#{options.id}\"\n            , callback\n\n        return\n    fetchPages = (callback) ->\n        if options.data?.pages\n            callback null, options.data.pages\n        else\n            SGN.CoreKit.request\n                url: \"/v2/catalogs/#{options.id}/pages\"\n            , callback\n\n        return\n    fetchHotspots = (callback) ->\n        if options.data?.hotspots\n            callback null, options.data.hotspots\n        else\n            SGN.CoreKit.request\n                url: \"/v2/catalogs/#{options.id}/hotspots\"\n            , callback\n\n        return\n    render = ->\n        viewer = new SGN.PagedPublicationKit.Viewer options.el,\n            id: options.id\n            ownedBy: data.details.dealer_id\n            color: '#' + data.details.branding.pageflip.color\n            keyboard: true\n            pageId: options.pageId\n            eventTracker: options.eventTracker\n            pages: transformPages data.pages\n\n        viewer.bind 'hotspotsRequested', (e) ->\n            hotspotQueue.push e\n            processHotspotQueue()\n\n            return\n\n        viewer.bind 'beforeNavigation', ->\n            hotspotPicker.destroy() if hotspotPicker?\n\n            return\n\n        viewer.bind 'clicked', (e) ->\n            getSelectedHotspot e, (hotspot) ->\n                viewer.trigger 'hotspotClicked', hotspot\n\n                return\n            \n            return\n\n        viewer.bind 'contextmenu', (e) ->\n            getSelectedHotspot e, (hotspot) ->\n                viewer.trigger 'hotspotContextmenu', hotspot\n\n                return\n            \n            return\n        \n        viewer.bind 'pressed', (e) ->\n            getSelectedHotspot e, (hotspot) ->\n                viewer.trigger 'hotspotPressed', hotspot\n\n                return\n            \n            return\n\n        callback null, viewer, data\n        \n        if !options.data?.details\n            viewer.trigger 'pagedPublicationFetched', data.details\n        if !options.data?.pages\n            viewer.trigger 'pagesFetched', data.pages\n        if data.hotspots and !options.data?.hotspots\n            viewer.trigger 'hotspotsFetched', Object.keys(data.hotspots).map((key) -> data.hotspots[key])\n\n        return\n    transformPages = (pages) ->\n        pages.map (page, i) ->\n            pageNumber = i + 1\n\n            id: 'page' + pageNumber\n            label: pageNumber + ''\n            pageNumber: pageNumber\n            images:\n                medium: page.view\n                large: page.zoom\n    processHotspotQueue = ->\n        return if not viewer or not data.hotspots\n\n        hotspotQueue = hotspotQueue.filter (hotspotRequest) ->\n            hotspots = {}\n\n            for id, hotspot of data.hotspots\n                match = false\n\n                hotspotRequest.pages.forEach (page) ->\n                    match = true if hotspot.locations[page.pageNumber]?\n\n                    return\n\n                if match\n                    hotspots[id] =\n                        type: hotspot.type\n                        id: hotspot.id\n                        locations: hotspot.locations\n\n            viewer.trigger 'hotspotsReceived',\n                id: hotspotRequest.id\n                pages: hotspotRequest.pages\n                ratio: data.details.dimensions.height\n                hotspots: hotspots\n\n            false\n\n        return\n    getSelectedHotspot = (e, callback) ->\n        hotspots = e.verso.overlayEls.map (overlayEl) ->\n            data.hotspots[overlayEl.getAttribute('data-id')]\n\n        if hotspots.length is 1\n            callback hotspots[0]\n        else if hotspots.length > 1\n            hotspots = hotspots\n                .filter (hotspot) -> hotspot.type is 'offer'\n                .map (hotspot) ->\n                    id: hotspot.id\n                    title: hotspot.offer.heading\n                    subtitle: hotspot.offer.pricing.currency + '' + hotspot.offer.pricing.price\n\n            hotspotPicker = new SGN.PagedPublicationKit.HotspotPicker\n                header: SGN.translations.t 'paged_publication.hotspot_picker.header'\n                x: e.verso.x\n                y: e.verso.y\n                hotspots: hotspots\n\n            hotspotPicker.bind 'selected', (e) ->\n                callback data.hotspots[e.id]\n                hotspotPicker.destroy()\n\n                return\n\n            hotspotPicker.bind 'destroyed', ->\n                hotspotPicker = null\n                viewer.el.focus()\n\n                return\n\n            viewer.el.appendChild hotspotPicker.el\n            hotspotPicker.render().el.focus()\n\n    SGN.util.async.parallel [fetch, fetchPages], (result) ->\n        details = result[0][1]\n        pages = result[1][1]\n\n        if details? and pages?\n            data.details = details\n            data.pages = pages\n\n            if options.showHotspots isnt false\n                fetchHotspots (err, response) ->\n                    return if err?\n\n                    data.hotspots = {}\n\n                    response.forEach (hotspot) ->\n                        data.hotspots[hotspot.id] = hotspot\n\n                        return\n\n                    processHotspotQueue()\n\n                    render()\n            else\n                render()\n        else\n            callback new Error()\n\n        return\n\n\n    return\n","/**\n * Copyright 2014 Craig Campbell\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n * GATOR.JS\n * Simple Event Delegation\n *\n * @version 1.2.4\n *\n * Compatible with IE 9+, FF 3.6+, Safari 5+, Chrome\n *\n * Include legacy.js for compatibility with older browsers\n *\n *             .-._   _ _ _ _ _ _ _ _\n *  .-''-.__.-'00  '-' ' ' ' ' ' ' ' '-.\n * '.___ '    .   .--_'-' '-' '-' _'-' '._\n *  V: V 'vv-'   '_   '.       .'  _..' '.'.\n *    '=.____.=_.--'   :_.__.__:_   '.   : :\n *            (((____.-'        '-.  /   : :\n *                              (((-'\\ .' /\n *                            _____..'  .'\n *                           '-._____.-'\n */\n(function() {\n    var _matcher,\n        _level = 0,\n        _id = 0,\n        _handlers = {},\n        _gatorInstances = {};\n\n    function _addEvent(gator, type, callback) {\n\n        // blur and focus do not bubble up but if you use event capturing\n        // then you will get them\n        var useCapture = type == 'blur' || type == 'focus';\n        gator.element.addEventListener(type, callback, useCapture);\n    }\n\n    function _cancel(e) {\n        e.preventDefault();\n        e.stopPropagation();\n    }\n\n    /**\n     * returns function to use for determining if an element\n     * matches a query selector\n     *\n     * @returns {Function}\n     */\n    function _getMatcher(element) {\n        if (_matcher) {\n            return _matcher;\n        }\n\n        if (element.matches) {\n            _matcher = element.matches;\n            return _matcher;\n        }\n\n        if (element.webkitMatchesSelector) {\n            _matcher = element.webkitMatchesSelector;\n            return _matcher;\n        }\n\n        if (element.mozMatchesSelector) {\n            _matcher = element.mozMatchesSelector;\n            return _matcher;\n        }\n\n        if (element.msMatchesSelector) {\n            _matcher = element.msMatchesSelector;\n            return _matcher;\n        }\n\n        if (element.oMatchesSelector) {\n            _matcher = element.oMatchesSelector;\n            return _matcher;\n        }\n\n        // if it doesn't match a native browser method\n        // fall back to the gator function\n        _matcher = Gator.matchesSelector;\n        return _matcher;\n    }\n\n    /**\n     * determines if the specified element matches a given selector\n     *\n     * @param {Node} element - the element to compare against the selector\n     * @param {string} selector\n     * @param {Node} boundElement - the element the listener was attached to\n     * @returns {void|Node}\n     */\n    function _matchesSelector(element, selector, boundElement) {\n\n        // no selector means this event was bound directly to this element\n        if (selector == '_root') {\n            return boundElement;\n        }\n\n        // if we have moved up to the element you bound the event to\n        // then we have come too far\n        if (element === boundElement) {\n            return;\n        }\n\n        // if this is a match then we are done!\n        if (_getMatcher(element).call(element, selector)) {\n            return element;\n        }\n\n        // if this element did not match but has a parent we should try\n        // going up the tree to see if any of the parent elements match\n        // for example if you are looking for a click on an <a> tag but there\n        // is a <span> inside of the a tag that it is the target,\n        // it should still work\n        if (element.parentNode) {\n            _level++;\n            return _matchesSelector(element.parentNode, selector, boundElement);\n        }\n    }\n\n    function _addHandler(gator, event, selector, callback) {\n        if (!_handlers[gator.id]) {\n            _handlers[gator.id] = {};\n        }\n\n        if (!_handlers[gator.id][event]) {\n            _handlers[gator.id][event] = {};\n        }\n\n        if (!_handlers[gator.id][event][selector]) {\n            _handlers[gator.id][event][selector] = [];\n        }\n\n        _handlers[gator.id][event][selector].push(callback);\n    }\n\n    function _removeHandler(gator, event, selector, callback) {\n\n        // if there are no events tied to this element at all\n        // then don't do anything\n        if (!_handlers[gator.id]) {\n            return;\n        }\n\n        // if there is no event type specified then remove all events\n        // example: Gator(element).off()\n        if (!event) {\n            for (var type in _handlers[gator.id]) {\n                if (_handlers[gator.id].hasOwnProperty(type)) {\n                    _handlers[gator.id][type] = {};\n                }\n            }\n            return;\n        }\n\n        // if no callback or selector is specified remove all events of this type\n        // example: Gator(element).off('click')\n        if (!callback && !selector) {\n            _handlers[gator.id][event] = {};\n            return;\n        }\n\n        // if a selector is specified but no callback remove all events\n        // for this selector\n        // example: Gator(element).off('click', '.sub-element')\n        if (!callback) {\n            delete _handlers[gator.id][event][selector];\n            return;\n        }\n\n        // if we have specified an event type, selector, and callback then we\n        // need to make sure there are callbacks tied to this selector to\n        // begin with.  if there aren't then we can stop here\n        if (!_handlers[gator.id][event][selector]) {\n            return;\n        }\n\n        // if there are then loop through all the callbacks and if we find\n        // one that matches remove it from the array\n        for (var i = 0; i < _handlers[gator.id][event][selector].length; i++) {\n            if (_handlers[gator.id][event][selector][i] === callback) {\n                _handlers[gator.id][event][selector].splice(i, 1);\n                break;\n            }\n        }\n    }\n\n    function _handleEvent(id, e, type) {\n        if (!_handlers[id][type]) {\n            return;\n        }\n\n        var target = e.target || e.srcElement,\n            selector,\n            match,\n            matches = {},\n            i = 0,\n            j = 0;\n\n        // find all events that match\n        _level = 0;\n        for (selector in _handlers[id][type]) {\n            if (_handlers[id][type].hasOwnProperty(selector)) {\n                match = _matchesSelector(target, selector, _gatorInstances[id].element);\n\n                if (match && Gator.matchesEvent(type, _gatorInstances[id].element, match, selector == '_root', e)) {\n                    _level++;\n                    _handlers[id][type][selector].match = match;\n                    matches[_level] = _handlers[id][type][selector];\n                }\n            }\n        }\n\n        // stopPropagation() fails to set cancelBubble to true in Webkit\n        // @see http://code.google.com/p/chromium/issues/detail?id=162270\n        e.stopPropagation = function() {\n            e.cancelBubble = true;\n        };\n\n        for (i = 0; i <= _level; i++) {\n            if (matches[i]) {\n                for (j = 0; j < matches[i].length; j++) {\n                    if (matches[i][j].call(matches[i].match, e) === false) {\n                        Gator.cancel(e);\n                        return;\n                    }\n\n                    if (e.cancelBubble) {\n                        return;\n                    }\n                }\n            }\n        }\n    }\n\n    /**\n     * binds the specified events to the element\n     *\n     * @param {string|Array} events\n     * @param {string} selector\n     * @param {Function} callback\n     * @param {boolean=} remove\n     * @returns {Object}\n     */\n    function _bind(events, selector, callback, remove) {\n\n        // fail silently if you pass null or undefined as an alement\n        // in the Gator constructor\n        if (!this.element) {\n            return;\n        }\n\n        if (!(events instanceof Array)) {\n            events = [events];\n        }\n\n        if (!callback && typeof(selector) == 'function') {\n            callback = selector;\n            selector = '_root';\n        }\n\n        var id = this.id,\n            i;\n\n        function _getGlobalCallback(type) {\n            return function(e) {\n                _handleEvent(id, e, type);\n            };\n        }\n\n        for (i = 0; i < events.length; i++) {\n            if (remove) {\n                _removeHandler(this, events[i], selector, callback);\n                continue;\n            }\n\n            if (!_handlers[id] || !_handlers[id][events[i]]) {\n                Gator.addEvent(this, events[i], _getGlobalCallback(events[i]));\n            }\n\n            _addHandler(this, events[i], selector, callback);\n        }\n\n        return this;\n    }\n\n    /**\n     * Gator object constructor\n     *\n     * @param {Node} element\n     */\n    function Gator(element, id) {\n\n        // called as function\n        if (!(this instanceof Gator)) {\n            // only keep one Gator instance per node to make sure that\n            // we don't create a ton of new objects if you want to delegate\n            // multiple events from the same node\n            //\n            // for example: Gator(document).on(...\n            for (var key in _gatorInstances) {\n                if (_gatorInstances[key].element === element) {\n                    return _gatorInstances[key];\n                }\n            }\n\n            _id++;\n            _gatorInstances[_id] = new Gator(element, _id);\n\n            return _gatorInstances[_id];\n        }\n\n        this.element = element;\n        this.id = id;\n    }\n\n    /**\n     * adds an event\n     *\n     * @param {string|Array} events\n     * @param {string} selector\n     * @param {Function} callback\n     * @returns {Object}\n     */\n    Gator.prototype.on = function(events, selector, callback) {\n        return _bind.call(this, events, selector, callback);\n    };\n\n    /**\n     * removes an event\n     *\n     * @param {string|Array} events\n     * @param {string} selector\n     * @param {Function} callback\n     * @returns {Object}\n     */\n    Gator.prototype.off = function(events, selector, callback) {\n        return _bind.call(this, events, selector, callback, true);\n    };\n\n    Gator.matchesSelector = function() {};\n    Gator.cancel = _cancel;\n    Gator.addEvent = _addEvent;\n    Gator.matchesEvent = function() {\n        return true;\n    };\n\n    if (typeof module !== 'undefined' && module.exports) {\n        module.exports = Gator;\n    }\n\n    window.Gator = Gator;\n}) ();\n","module.exports = \"\"\"\n<div class=\"sgn-pp-hotspot-picker__background\" data-close></div>\n<div class=\"sgn__popover\">\n    {{#header}}\n        <div class=\"sgn-popover__header\">{{header}}</div>\n    {{/header}}\n    <div class=\"sgn-popover__content\">\n        <ul>\n            {{#hotspots}}\n                <li data-id=\"{{id}}\">\n                    <p>{{title}}</p>\n                    <p>{{subtitle}}</p>\n                </li>\n            {{/hotspots}}\n        </ul>\n    </div>\n</div>\n\"\"\"\n","SGN = require './sgn'\n\n# Expose storage backends.\nSGN.storage =\n    local: require './storage/client-local'\n    cookie: require './storage/client-cookie'\n\n# Expose request handler.\nSGN.request = require './request/browser'\n\n# Expose the different kits.\nSGN.AuthKit = require './kits/auth'\nSGN.AssetsKit = require './kits/assets'\nSGN.EventsKit = require './kits/events'\nSGN.GraphKit = require './kits/graph'\nSGN.CoreKit = require './kits/core'\nSGN.PagedPublicationKit = require './kits/paged-publication'\nSGN.ShoppingListKit = require './kits/shopping-list'\n\n# Set the core session from the cookie store if possible.\nsession = SGN.storage.cookie.get 'session'\n\nif typeof session is 'object'\n    SGN.config.set\n        coreSessionToken: session.token\n        coreSessionClientId: session.client_id\n\nSGN.client = do ->\n    id = SGN.storage.local.get 'client-id'\n    id = id?.data\n    firstOpen = not id?\n\n    if firstOpen\n        id = SGN.util.uuid()\n        \n        SGN.storage.local.set 'client-id', id\n\n    firstOpen: firstOpen\n    id: id\n\n# Listen for changes in the config.\nSGN.config.bind 'change', (changedAttributes) ->\n    eventTracker = changedAttributes.eventTracker\n\n    if eventTracker?\n        eventTracker.trackEvent 'first-client-session-opened', {}, '1.0.0' if SGN.client.firstOpen is true\n        eventTracker.trackEvent 'client-session-opened', {}, '1.0.0'\n\n    return\n\n# Autoconfigure the SDK.\nscriptEl = document.getElementById 'sgn-sdk'\n\nif scriptEl?\n    appKey = scriptEl.getAttribute 'data-app-key'\n    trackId = scriptEl.getAttribute 'data-track-id'\n    config = {}\n\n    config.appKey = appKey if appKey?\n    config.eventTracker = new SGN.EventsKit.Tracker(trackId: trackId) if trackId?\n\n    SGN.config.set config\n\nmodule.exports = SGN\n","module.exports =\n    Viewer: require './viewer'\n\n    HotspotPicker: require './hotspot-picker'\n\n    initialize: require './initialize'\n"],"names":["Config","MicroEvent","prototype","event","fct","_events","this","push","splice","indexOf","i","length","apply","Array","slice","call","arguments","mixin","destObject","props","module","require$$0","attrs","changedAttributes","key","value","config","keys","trigger","option","Mustache","pairs","global","factory","mustache","objectToString","Object","toString","isArray","object","isFunction","escapeRegExp","string","replace","hasProperty","obj","propName","regExpTest","RegExp","test","nonSpaceRe","isWhitespace","re","entityMap","whiteRe","spaceRe","equalsRe","curlyRe","tagRe","Scanner","tail","pos","Context","view","parentContext","cache",".","parent","Writer","eos","scan","match","index","substring","scanUntil","search","lookup","name","hasOwnProperty","names","context","lookupHit","split","clearCache","parse","template","tags","tokens","openingTagRe","closingTagRe","closingCurlyRe","sections","spaces","hasTag","nonSpace","stripSpace","pop","compileTags","tagsToCompile","Error","start","type","chr","token","openSection","scanner","valueLength","charAt","nestedTokens","collector","numTokens","nestTokens","lastToken","squashedTokens","squashTokens","parseTemplate","render","partials","renderTokens","originalTemplate","symbol","buffer","undefined","renderSection","renderInverted","renderPartial","unescapedValue","escapedValue","rawValue","self","j","escape","version","defaultWriter","TypeError","to_html","send","result","String","s","exports","nodeName","process","util","translations","ref","cachedSetTimeout","cachedClearTimeout","defaultSetTimout","defaultClearTimeout","runTimeout","fun","setTimeout","e","clearTimeout","currentQueue","queue","draining","queueIndex","cleanUpNextTick","concat","drainQueue","timeout","len","run","marker","Item","array","noop","nextTick","args","title","browser","env","argv","versions","on","addListener","once","off","removeListener","removeAllListeners","emit","prependListener","prependOnceListener","listeners","binding","cwd","chdir","dir","umask","require$$1","isBrowser","err","options","message","code","stack","time","Date","c","r","Math","random","field","url","href","window","location","exec","queryParams","map","encodeURIComponent","join","from","to","floor","ua","navigator","userAgent","str","btoa","Buffer","density","logical","screen","width","height","round","jan1","now","tmp","getFullYear","toGMTString","lastIndexOf","getTimezoneOffset","color","hex","rgb","sum","x","parseInt","arr","fn","item","size","results","deferTimer","last","threshold","scope","getTime","src","callback","img","Image","onload","onerror","lat1","lng1","lat2","lng2","dist","radlat1","radlat2","radtheta","theta","PI","sin","cos","acos","asyncCalls","sharedCallback","allResults","counter","k","makeCallback","set","prefixKey","SGN","storage","localStorage","JSON","stringify","ca","ct","isNode","document","cookie","trim","date","days","setTime","toUTCString","clientLocalStorage","getPool","pool","formData","progressCallback","get","file","contentType","request","data","error","statusCode","body","loaded","total","addEventListener","Tracker","Pulse","dispatching","session","uuid","client","trackId","id","application","identity","interval","setInterval","dispatch","bind","dispatchInterval","properties","toISOString","getContext","getPoolSize","poolLimit","shift","ref1","determinedAt","timestamp","latitude","longitude","altitude","accuracy","horizontal","vertical","speed","build","path","previousPath","uri","campaign","loc","os","screenDimensions","getScreenDimensions","getOS","language","getUtcOffsetSeconds","getUtcDstOffsetSeconds","physical","getView","getQueryParam","referrer","forEach","personId","events","nacks","dryRun","dispatchLimit","ship","response","resEvent","status","filter","poolEvent","_this","http","payload","XMLHttpRequest","sentAt","open","setRequestHeader","responseText","defaultOptions","destroyed","connection","connect","close","WebSocket","onopen","onOpen","onmessage","onMessage","onError","onclose","onClose","parseCookies","parsedCookies","cookies","keyValuePair","appKey","authToken","authTokenCookieName","query","operationName","variables","headers","Authorization","useCookies","authCookie","callbackQueue","clientCookieStorage","renewed","sha256","runs","CoreKit","ensure","appSecret","appVersion","clientId","geo","locale","qs","ref2","geolocation","sign","r_locale","api_av","client_id","r_lat","r_lng","r_radius","radius","r_sensor","sensor","method","ref3","responseToken","saveToken","globals","convertHex","bytes","orig","convertString","fromCharCode","charCodeAt","UTF8","decodeURIComponent","bytesToString","stringToBytes","unescape","_imports","bytesToHex","K","isPrime","n","sqrtN","sqrt","factor","nPrime","pow","bytesToWords","words","b","wordsToBytes","W","processBlock","H","M","offset","a","d","f","g","h","gamma0x","gamma0","gamma1x","gamma1","maj","sigma0","t1","constructor","m","l","digestbytes","asBytes","asString","x2","require$$2","PagedPublicationPageSpread","PageSpread","PagedPublicationPageSpreads","saveCookie","ttl","saveClientId","complete","queueCount","create","renew","contentsRendered","hotspotsRendered","el","renderEl","pages","pageIds","createElement","getPages","page","className","setAttribute","getId","maxZoomScale","imageLoads","pageCount","getEl","image","loaderEl","pageEl","images","medium","appendChild","innerHTML","label","loadImage","isComplete","style","backgroundImage","pageSpread","versoPageSpread","pageEls","querySelectorAll","getAttribute","find","large","_this2","removeAttribute","collection","ids","frag","createDocumentFragment","firstPage","lastPage","midstPageSpreads","pageSpreads","pageMode","chunk","midstPages","PageSpreads","PagedPublicationCore","require$$3","makeOptions","defaults","pageId","getOption","els","querySelector","getPageMode","pageLoaded","pagesLoaded","setColor","parentNode","insertBefore","update","getFrag","verso","createVerso","destroy","getVerso","visibilityChangeListener","visibilityChange","resizeListener","throttle","resize","unloadListener","unload","root","focus","pageSpreadEl","pageSpreadEls","backgroundColor","removeChild","removeEventListener","opts","getColorBrightness","require$$4","overridePageSpreadContentRect","beforeNavigation","afterNavigation","attemptedNavigation","clicked","doubleClicked","pressed","contextmenu","panStart","panEnd","zoomedIn","zoomedOut","actualHeight","actualWidth","clientRect","imageRatio","pageHeight","pageWidth","rect","scale","getPageEls","transform","offsetWidth","offsetHeight","min","getBoundingClientRect","top","left","right","bottom","pageLabels","visibility","getVisibility","renderContents","clearContents","newSpreadEl","pageSpreadCount","position","progress","progressLabel","theVerso","newPosition","getPageSpreadFromPosition","getPageSpreadCount","formatProgressLabel","renderPageSpreads","resetIdleTimer","startIdleTimer","isInsideContent","findPage","zoomIn","zoomOut","idleTimeout","getPosition","getPageIds","refresh","navigateTo","getPageSpreadPositionFromPageId","getType","getContentRect","_this3","eventName","hidden","switchPageMode","PagedPublicationHotspots","currentPageSpreadId","pageSpreadsLoaded","hotspotsReceived","resized","boundingRect","contentRect","hotspot","hotspotEl","hotspotEls","ratio","renderHotspot","maxX","maxY","minX","minY","pageNumber","pageNumbers","locations","coords","y","pageSpreadId","setCache","renderHotspots","requestHotspots","getCache","PagedPublicationControls","keyCodes","keyDownListener","keyDown","keyboard","prevControl","prevClicked","nextControl","nextClicked","closeClicked","showProgress","visibilityClassName","progressBar","classList","remove","add","textContent","preventDefault","keyCode","ARROW_LEFT","ARROW_RIGHT","SPACE","NUMBER_ONE","PagedPublicationEventTracking","Controls","Core","EventTracking","Hotspots","Viewer","appeared","disappeared","pageSpreadDisappeared","trackEvent","pageSpreadAppeared","pageX","pageY","trackPageClicked","overlayEls","trackPageHotspotsClicked","trackPageDoubleClicked","trackPageLongPressed","trackPageSpreadZoomedIn","trackPageSpreadZoomedOut","trackPageSpreadAppeared","trackPageSpreadDisappeared","_core","pageSpreadWidth","pageSpreadMaxZoomScale","idleDelay","resizeDelay","_hotspots","_controls","_eventTracking","viewSession","_setupEventListeners","trackOpened","navigateToIndex","first","prev","next","eventTracker","idType","ownedBy","_trackEvent","hotspots","Gator","PagedPublicationHotspotPicker","_matcher","_level","_id","_handlers","_gatorInstances","_matchesSelector","element","selector","boundElement","matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector","matchesSelector","_removeHandler","gator","_bind","addEvent","_getGlobalCallback","target","srcElement","matchesEvent","stopPropagation","cancelBubble","cancel","useCapture","header","parentHeight","parentWidth","popoverEl","keyUp","ESC","scriptEl","firstOpen","fetch","fetchHotspots","fetchPages","getSelectedHotspot","hotspotPicker","hotspotQueue","processHotspotQueue","transformPages","viewer","details","PagedPublicationKit","dealer_id","branding","pageflip","zoom","hotspotRequest","dimensions","overlayEl","offer","heading","pricing","currency","price","HotspotPicker","t","async","parallel","showHotspots","formatQueryParams","toUpperCase","withCredentials","json","getAllResponseHeaders","reduce","acc","current","parts","toLowerCase","lengthComputable","FormData","append","AuthKit","AssetsKit","require$$5","EventsKit","require$$6","GraphKit","require$$7","require$$8","require$$9","ShoppingListKit","local","getElementById"],"mappings":"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"}