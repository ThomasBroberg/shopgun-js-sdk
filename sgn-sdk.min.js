!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):t.SGN=e()}(this,function(){"use strict";var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function e(){throw new Error("Dynamic requires are not currently supported by rollup-plugin-commonjs")}function i(t,e){return t(e={exports:{}},e.exports),e.exports}var n,r,o=i(function(t){var e=function(){};e.prototype={bind:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},unbind:function(t,e){this._events=this._events||{},t in this._events!=!1&&this._events[t].splice(this._events[t].indexOf(e),1)},trigger:function(t){if(this._events=this._events||{},t in this._events!=!1)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},e.mixin=function(t){for(var i=["bind","unbind","trigger"],n=0;n<i.length;n++)t.prototype[i[n]]=e.prototype[i[n]]},"exports"in t&&(t.exports=e)}),s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},a=function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")},l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),u=[].indexOf;r=o,n=n=function(){var t=function(){function t(){a(this,t),this.attrs={}}return l(t,[{key:"set",value:function(){var t,e,i,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(e in t={},n)i=n[e],u.call(this.keys,e)>=0&&(this.attrs[e]=i,t[e]=i);this.trigger("change",t)}},{key:"get",value:function(t){return this.attrs[t]}}]),t}();return t.prototype.keys=["appVersion","appKey","appSecret","authToken","eventTracker","locale","coreSessionToken","coreSessionClientId","coreUrl","graphUrl","eventsTrackUrl","eventsPulseUrl","assetsFileUploadUrl"],t}.call(t),r.mixin(n);var h,c,d=n,p=i(function(e,i){var n,r;n=t,r=function(t){var e=Object.prototype.toString,i=Array.isArray||function(t){return"[object Array]"===e.call(t)};function n(t){return"function"==typeof t}function r(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")}function o(t,e){return null!=t&&"object"==typeof t&&e in t}var s=RegExp.prototype.test;var a=/\S/;function l(t){return!function(t,e){return s.call(t,e)}(a,t)}var u={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;","`":"&#x60;","=":"&#x3D;"};var h=/\s*/,c=/\s+/,d=/\s*=/,p=/\s*\}/,f=/#|\^|\/|>|\{|&|=|!/;function g(t){this.string=t,this.tail=t,this.pos=0}function v(t,e){this.view=t,this.cache={".":this.view},this.parent=e}function y(){this.cache={}}g.prototype.eos=function(){return""===this.tail},g.prototype.scan=function(t){var e=this.tail.match(t);if(!e||0!==e.index)return"";var i=e[0];return this.tail=this.tail.substring(i.length),this.pos+=i.length,i},g.prototype.scanUntil=function(t){var e,i=this.tail.search(t);switch(i){case-1:e=this.tail,this.tail="";break;case 0:e="";break;default:e=this.tail.substring(0,i),this.tail=this.tail.substring(i)}return this.pos+=e.length,e},v.prototype.push=function(t){return new v(t,this)},v.prototype.lookup=function(t){var e,i=this.cache;if(i.hasOwnProperty(t))e=i[t];else{for(var r,s,a=this,l=!1;a;){if(t.indexOf(".")>0)for(e=a.view,r=t.split("."),s=0;null!=e&&s<r.length;)s===r.length-1&&(l=o(e,r[s])),e=e[r[s++]];else e=a.view[t],l=o(a.view,t);if(l)break;a=a.parent}i[t]=e}return n(e)&&(e=e.call(this.view)),e},y.prototype.clearCache=function(){this.cache={}},y.prototype.parse=function(e,n){var o=this.cache,s=o[e];return null==s&&(s=o[e]=function(e,n){if(!e)return[];var o,s,a,u=[],v=[],y=[],m=!1,b=!1;function _(){if(m&&!b)for(;y.length;)delete v[y.pop()];else y=[];m=!1,b=!1}function w(t){if("string"==typeof t&&(t=t.split(c,2)),!i(t)||2!==t.length)throw new Error("Invalid tags: "+t);o=new RegExp(r(t[0])+"\\s*"),s=new RegExp("\\s*"+r(t[1])),a=new RegExp("\\s*"+r("}"+t[1]))}w(n||t.tags);for(var k,S,x,E,T,P,C=new g(e);!C.eos();){if(k=C.pos,x=C.scanUntil(o))for(var O=0,I=x.length;O<I;++O)l(E=x.charAt(O))?y.push(v.length):b=!0,v.push(["text",E,k,k+1]),k+=1,"\n"===E&&_();if(!C.scan(o))break;if(m=!0,S=C.scan(f)||"name",C.scan(h),"="===S?(x=C.scanUntil(d),C.scan(d),C.scanUntil(s)):"{"===S?(x=C.scanUntil(a),C.scan(p),C.scanUntil(s),S="&"):x=C.scanUntil(s),!C.scan(s))throw new Error("Unclosed tag at "+C.pos);if(T=[S,x,k,C.pos],v.push(T),"#"===S||"^"===S)u.push(T);else if("/"===S){if(!(P=u.pop()))throw new Error('Unopened section "'+x+'" at '+k);if(P[1]!==x)throw new Error('Unclosed section "'+P[1]+'" at '+k)}else"name"===S||"{"===S||"&"===S?b=!0:"="===S&&w(x)}if(P=u.pop())throw new Error('Unclosed section "'+P[1]+'" at '+C.pos);return function(t){for(var e,i=[],n=i,r=[],o=0,s=t.length;o<s;++o)switch((e=t[o])[0]){case"#":case"^":n.push(e),r.push(e),n=e[4]=[];break;case"/":r.pop()[5]=e[2],n=r.length>0?r[r.length-1][4]:i;break;default:n.push(e)}return i}(function(t){for(var e,i,n=[],r=0,o=t.length;r<o;++r)(e=t[r])&&("text"===e[0]&&i&&"text"===i[0]?(i[1]+=e[1],i[3]=e[3]):(n.push(e),i=e));return n}(v))}(e,n)),s},y.prototype.render=function(t,e,i){var n=this.parse(t),r=e instanceof v?e:new v(e);return this.renderTokens(n,r,i,t)},y.prototype.renderTokens=function(t,e,i,n){for(var r,o,s,a="",l=0,u=t.length;l<u;++l)s=void 0,"#"===(o=(r=t[l])[0])?s=this.renderSection(r,e,i,n):"^"===o?s=this.renderInverted(r,e,i,n):">"===o?s=this.renderPartial(r,e,i,n):"&"===o?s=this.unescapedValue(r,e):"name"===o?s=this.escapedValue(r,e):"text"===o&&(s=this.rawValue(r)),void 0!==s&&(a+=s);return a},y.prototype.renderSection=function(t,e,r,o){var s=this,a="",l=e.lookup(t[1]);if(l){if(i(l))for(var u=0,h=l.length;u<h;++u)a+=this.renderTokens(t[4],e.push(l[u]),r,o);else if("object"==typeof l||"string"==typeof l||"number"==typeof l)a+=this.renderTokens(t[4],e.push(l),r,o);else if(n(l)){if("string"!=typeof o)throw new Error("Cannot use higher-order sections without the original template");null!=(l=l.call(e.view,o.slice(t[3],t[5]),function(t){return s.render(t,e,r)}))&&(a+=l)}else a+=this.renderTokens(t[4],e,r,o);return a}},y.prototype.renderInverted=function(t,e,n,r){var o=e.lookup(t[1]);if(!o||i(o)&&0===o.length)return this.renderTokens(t[4],e,n,r)},y.prototype.renderPartial=function(t,e,i){if(i){var r=n(i)?i(t[1]):i[t[1]];return null!=r?this.renderTokens(this.parse(r),e,i,r):void 0}},y.prototype.unescapedValue=function(t,e){var i=e.lookup(t[1]);if(null!=i)return i},y.prototype.escapedValue=function(e,i){var n=i.lookup(e[1]);if(null!=n)return t.escape(n)},y.prototype.rawValue=function(t){return t[1]},t.name="mustache.js",t.version="2.3.0",t.tags=["{{","}}"];var m=new y;return t.clearCache=function(){return m.clearCache()},t.parse=function(t,e){return m.parse(t,e)},t.render=function(t,e,n){if("string"!=typeof t)throw new TypeError('Invalid template! Template should be a "string" but "'+(i(r=t)?"array":typeof r)+'" was given as the first argument for mustache#render(template, view, partials)');var r;return m.render(t,e,n)},t.to_html=function(e,i,r,o){var s=t.render(e,i,r);if(!n(o))return s;o(s)},t.escape=function(t){return String(t).replace(/[&<>"'`=\/]/g,function(t){return u[t]})},t.Scanner=g,t.Context=v,t.Writer=y,t},i&&"string"!=typeof i.nodeName?r(i):(n.Mustache={},r(n.Mustache))});h=p,c={"paged_publication.hotspot_picker.header":"Which offer did you mean?","incito_publication.product_picker.header":"Which product?"};var f,g,v={t:function(t,e){var i,n;return n=null!=(i=c[t])?i:"",h.render(n,e)},update:function(t){var e,i;for(e in t)i=t[e],c[e]=i}},y=i(function(t){var e,i,n=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===r||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(i){try{return e.call(null,t,0)}catch(i){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:r}catch(t){e=r}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var a,l=[],u=!1,h=-1;function c(){u&&a&&(u=!1,a.length?l=a.concat(l):h=-1,l.length&&d())}function d(){if(!u){var t=s(c);u=!0;for(var e=l.length;e;){for(a=l,l=[];++h<e;)a&&a[h].run();h=-1,e=l.length}a=null,u=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function p(t,e){this.fun=t,this.array=e}function f(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)e[i-1]=arguments[i];l.push(new p(t,e)),1!==l.length||u||s(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=f,n.addListener=f,n.once=f,n.off=f,n.removeListener=f,n.removeAllListeners=f,n.emit=f,n.prependListener=f,n.prependOnceListener=f,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0}});f=y;var m,b,_,w=g={isBrowser:function(){return void 0!==f&&f.browser},isNode:function(){return!g.isBrowser()},error:function(t,e){var i,n;if(t.message=t.message||null,"string"==typeof e)t.message=e;else if("object"===(void 0===e?"undefined":s(e))&&null!=e){for(i in e)n=e[i],t[i]=n;null!=e.message&&(t.message=e.message),null==e.code&&null==e.message||(t.code=e.code||e.name),null!=e.stack&&(t.stack=e.stack)}return t.name=e&&e.name||t.name||t.code||"Error",t.time=new Date,t},uuid:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e;return e=16*Math.random()|0,("x"===t?e:3&e|8).toString(16)})},getQueryParam:function(t,e){var i,n;return i=e||window.location.href,(n=new RegExp("[?&]"+t+"=([^&#]*)","i").exec(i))?n[1]:void 0},formatQueryParams:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object.keys(t).map(function(e){return e+"="+encodeURIComponent(t[e])}).join("&")},getRandomNumberBetween:function(t,e){return Math.floor(Math.random()*e)+t},getOS:function(){var t,e;return t=null,(e=window.navigator.userAgent).indexOf("Windows")>-1?t="Windows":e.indexOf("Mac")>-1?t="macOS":e.indexOf("X11")>-1?t="unix":e.indexOf("Linux")>-1?t="Linux":e.indexOf("iOS")>-1?t="iOS":e.indexOf("Android")>-1&&(t="Android"),t},getDeviceCategory:function(){var t;return t="desktop","iPod"===navigator.platform||"iPhone"===navigator.platform?t="mobile":"iPad"===navigator.platform?t="tablet":("Android"===navigator.platform||/android/gi.test(navigator.userAgent))&&(t=/tablet/gi.test(navigator.userAgent)?"tablet":"mobile"),t},getPointer:function(){var t;return t="fine",matchMedia("(pointer:coarse)").matches&&(t="coarse"),t},getOrientation:function(t,e){return t===e?"quadratic":t>e?"horizontal":"vertical"},getScreenDimensions:function(){var t,e,i;return{density:t=null!=(i=window.devicePixelRatio)?i:1,logical:e={width:window.screen.width,height:window.screen.height},physical:{width:Math.round(e.width*t),height:Math.round(e.height*t)}}},getUtcOffsetSeconds:function(){var t,e,i;return e=new Date,i=(t=new Date(e.getFullYear(),0,1,0,0,0,0)).toGMTString(),(t-new Date(i.substring(0,i.lastIndexOf(" ")-1)))/1e3},getUtcDstOffsetSeconds:function(){return 60*(new Date).getTimezoneOffset()*-1},getColorBrightness:function(t){var e,i,n,r,o;for(t=t.replace("#",""),e=parseInt((e+"").replace(/[^a-f0-9]/gi,""),16),i=[],r=0,o=0;o<3;)n=parseInt(t.substring(2*o,2),16),i[o]=n,n>0&&(r+=n),++o;return r<=381?"dark":"light"},btoa:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(t){return g.isBrowser()?btoa(t):(null,(t instanceof Buffer?t:new Buffer(t.toString(),"binary")).toString("base64"))}),find:function(t,e){var i,n,r;for(n=0,r=t.length;n<r;n++)if(!0===e(i=t[n]))return i},chunk:function(t,e){var i;for(i=[];t.length;)i.push(t.splice(0,e));return i},throttle:function(t){var e,i,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:250,r=arguments[2];return i=void 0,e=void 0,function(){var o,s,a;s=r||this,a=(new Date).getTime(),o=arguments,i&&a<i+n?(clearTimeout(e),e=setTimeout(function(){i=a,t.apply(s,o)},n)):(i=a,t.apply(s,o))}},loadImage:function(t,e){var i;return(i=new Image).onload=function(){return e(null,i.width,i.height)},i.onerror=function(){return e(new Error)},i.src=t,i},distance:function(t,e,i,n){var r,o,s,a,l;return o=Math.PI*t/180,s=Math.PI*i/180,l=e-n,a=Math.PI*l/180,r=Math.sin(o)*Math.sin(s)+Math.cos(o)*Math.cos(s)*Math.cos(a),r=1.609344*(r=60*(r=180*(r=Math.acos(r))/Math.PI)*1.1515)*1e3},isElementInViewport:function(t){var e,i,n,r,o,s,a,l,u,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return u=(n=t.getBoundingClientRect()).top-(null!=(r=h.top)?r:0),i=n.left-(null!=(o=h.left)?o:0),l=n.right+(null!=(s=h.right)?s:0),e=n.bottom+(null!=(a=h.bottom)?a:0),u>=0&&i>=0&&e<=window.innerHeight&&l<=window.innerWidth},async:{parallel:function(t,e){var i,n,r,o;for(n=t.length,i=[],r=0,o=function(t){return function(){var r,o;for(o=[],r=0,n--;r<arguments.length;)o.push(arguments[r]),r++;i[t]=o,0===n&&e(i)}};r<t.length;)t[r](o(r)),r++}}};b=v,_=w,(m=new d).set({locale:"en_US",coreUrl:"https://api.etilbudsavis.dk",graphUrl:"https://graph.service.shopgun.com",eventsTrackUrl:"https://events.service.shopgun.com/track",eventsPulseUrl:"wss://events.service.shopgun.com/pulse",assetsFileUploadUrl:"https://assets.service.shopgun.com/upload"});var k={config:m,translations:b,util:_},S=k;var x={key:"sgn-",storage:function(){var t;try{return(t=window.localStorage)["sgn-test-storage"]="foobar",delete t["sgn-test-storage"],t}catch(t){return{}}}(),get:function(t){try{return JSON.parse(this.storage["sgn-"+t])}catch(t){}},set:function(t,e){try{this.storage["sgn-"+t]=JSON.stringify(e)}catch(t){}return this}};var E,T={key:"sgn-",storage:function(){var t;try{return(t=window.sessionStorage)["sgn-test-storage"]="foobar",delete t["sgn-test-storage"],t}catch(t){return{}}}(),get:function(t){try{return JSON.parse(this.storage["sgn-"+t])}catch(t){}},set:function(t,e){try{this.storage["sgn-"+t]=JSON.stringify(e)}catch(t){}return this}};E=S;var P,C={get:function(t){var e,i,n,r,o,s;if(!E.util.isNode()){try{for(o="sgn-"+t+"=",e=document.cookie.split(";"),n=0,r=e.length;n<r;n++)0===(i=e[n].trim()).indexOf(o)&&(s=i.substring(o.length,i.length));s=JSON.parse(s)}catch(t){s={}}return s}},set:function(t,e){var i,n;if(!E.util.isNode())try{365,i=new Date,n=JSON.stringify(e),i.setTime(i.getTime()+31536e6),document.cookie="sgn-"+t+"="+n+";expires="+i.toUTCString()+";path=/"}catch(t){}}};P=S;var O;O=S;var I,A,L,N,D={fileUpload:function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments[1],n=arguments[2];if(null==e.file)throw new Error("File is not defined");t=O.config.get("assetsFileUploadUrl"),O.request({method:"post",url:t,headers:{Accept:"application/json"},formData:{file:e.file},timeout:36e5},function(t,e){null!=t?i(O.util.error(new Error("Request error"),{code:"RequestError"})):200===e.statusCode?i(null,JSON.parse(e.body)):i(O.util.error(new Error("Request error"),{code:"RequestError",statusCode:e.statusCode}))},function(t,e){"function"==typeof n&&n({progress:t/e,loaded:t,total:e})})}};I=S,A=x,N=(L=function(){var t;return t=A.get("event-tracker-pool"),!1===Array.isArray(t)&&(t=[]),t})(),A.set("event-tracker-pool",[]);try{window.addEventListener("unload",function(){N=N.concat(L()),A.set("event-tracker-pool",N)},!1)}catch(t){}var R,z,M=function(){var t=function(){function t(){var e,i,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};for(e in a(this,t),i=this.defaultOptions)n=i[e],this[e]=r[e]||n;this.dispatching=!1,this.session={id:I.util.uuid()},this.client={trackId:this.trackId,id:I.client.id},this.view={path:[],previousPath:[],uri:null},this.location={},this.application={},this.identity={},this.interval=setInterval(this.dispatch.bind(this),this.dispatchInterval)}return l(t,[{key:"trackEvent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"1.0.0";if("string"!=typeof t)throw I.util.error(new Error("Event type is required"));if(null!=this.trackId){for(N.push({id:I.util.uuid(),type:t,version:i,recordedAt:(new Date).toISOString(),sentAt:null,client:{id:this.client.id,trackId:this.client.trackId},context:this.getContext(),properties:e});this.getPoolSize()>this.poolLimit;)N.shift();return this}}},{key:"identify",value:function(t){return this.identity.id=t,this}},{key:"setLocation",value:function(){var t,e,i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.location.determinedAt=new Date(i.timestamp).toISOString(),this.location.latitude=i.latitude,this.location.longitude=i.longitude,this.location.altitude=i.altitude,this.location.accuracy={horizontal:null!=(t=i.accuracy)?t.horizontal:void 0,vertical:null!=(e=i.accuracy)?e.vertical:void 0},this.location.speed=i.speed,this.location.floor=i.floor,this}},{key:"setApplication",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.application.name=t.name,this.application.version=t.version,this.application.build=t.build,this}},{key:"setView",value:function(t){return this.view.previousPath=this.view.path,!0===Array.isArray(t)&&(this.view.path=t),this.view.uri=window.location.href,this}},{key:"getView",value:function(){var t;return t={},this.view.path.length>0&&(t.path=this.view.path),this.view.previousPath.length>0&&(t.previousPath=this.view.previousPath),null!=this.view.uri&&(t.uri=this.view.uri),t}},{key:"getContext",value:function(){var t,e,i,n,r,o,s,a;return a=I.util.getScreenDimensions(),r=I.util.getOS(),i={userAgent:window.navigator.userAgent,locale:navigator.language,timeZone:{utcOffsetSeconds:I.util.getUtcOffsetSeconds(),utcDstOffsetSeconds:I.util.getUtcDstOffsetSeconds()},device:{screen:{width:a.physical.width,height:a.physical.height,density:a.density}},session:{id:this.session.id},view:this.getView()},t={name:this.application.name,version:this.application.version,build:this.application.build},e={source:I.util.getQueryParam("utm_source"),medium:I.util.getQueryParam("utm_medium"),name:I.util.getQueryParam("utm_campaign"),term:I.util.getQueryParam("utm_term"),content:I.util.getQueryParam("utm_content")},n={determinedAt:this.location.determinedAt,latitude:this.location.latitude,longitude:this.location.longitude,altitude:this.location.altitude,speed:this.location.speed,floor:this.location.floor,accuracy:{horizontal:null!=(o=this.location.accuracy)?o.horizontal:void 0,vertical:null!=(s=this.location.accuracy)?s.vertical:void 0}},null!=r&&(i.os={name:r}),document.referrer.length>0&&(i.session.referrer=document.referrer),["name","version","build"].forEach(function(e){"string"==typeof t[e]&&0!==t[e].length||delete t[e]}),Object.keys(t).length>0&&(i.application=t),["source","medium","name","term","content"].forEach(function(t){"string"==typeof e[t]&&0!==e[t].length||delete e[t]}),Object.keys(e).length>0&&(i.campaign=e),["latitude","longitude","altitude","speed","floor"].forEach(function(t){"number"!=typeof n[t]&&delete n[t]}),"number"!=typeof n.accuracy.horizontal&&delete n.accuracy.horizontal,"number"!=typeof n.accuracy.vertical&&delete n.accuracy.vertical,0===Object.keys(n.accuracy).length&&delete n.accuracy,"string"==typeof n.determinedAt&&0!==n.determinedAt.length||delete n.determinedAt,Object.keys(n).length>0&&(i.location=n),null!=this.identity.id&&(i.personId=this.identity.id),i}},{key:"getPoolSize",value:function(){return N.length}},{key:"dispatch",value:function(){var t,e,i=this;if(!0!==this.dispatching&&0!==this.getPoolSize())return!0===this.dryRun?N.splice(0,this.dispatchLimit):(t=N.slice(0,this.dispatchLimit),e=0,this.dispatching=!0,this.ship(t,function(t,n){i.dispatching=!1,null==t&&(n.events.forEach(function(t){"validation_error"===t.status||"ack"===t.status?N=N.filter(function(e){return e.id!==t.id}):e++}),i.getPoolSize()>=i.dispatchLimit&&0===e&&i.dispatch())}),this)}},{key:"ship",value:function(){var t,e,i,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=arguments[1];return t=new XMLHttpRequest,i=I.config.get("eventsTrackUrl"),e={events:n.map(function(t){return t.sentAt=(new Date).toISOString(),t})},t.open("POST",i),t.setRequestHeader("Content-Type","application/json"),t.setRequestHeader("Accept","application/json"),t.timeout=2e4,t.onload=function(){if(200===t.status)try{r(null,JSON.parse(t.responseText))}catch(t){r(I.util.error(new Error("Could not parse JSON")))}else r(I.util.error(new Error("Server did not accept request")))},t.onerror=function(){r(I.util.error(new Error("Could not perform network request")))},t.send(JSON.stringify(e)),this}}]),t}();return t.prototype.defaultOptions={trackId:null,dispatchInterval:3e3,dispatchLimit:100,poolLimit:1e3,dryRun:!1},t}.call(t);R=o,z=function(){function t(){a(this,t),this.destroyed=!1,this.connection=this.connect()}return l(t,[{key:"destroy",value:function(){return this.destroyed=!0,this.connection.close(),this}},{key:"connect",value:function(){var t;return(t=new WebSocket(SGN.config.get("eventsPulseUrl"))).onopen=this.onOpen.bind(this),t.onmessage=this.onMessage.bind(this),t.onerror=this.onError.bind(this),t.onclose=this.onClose.bind(this),t}},{key:"onOpen",value:function(){this.trigger("open")}},{key:"onMessage",value:function(t){try{this.trigger("event",JSON.parse(t.data))}catch(t){}}},{key:"onError",value:function(){}},{key:"onClose",value:function(){var t=this;!1===this.destroyed&&setTimeout(function(){t.connection=t.connect()},2e3)}}]),t}(),R.mixin(z);var j,U,H={Tracker:M,Pulse:z};j=S,U=function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return t={},e.map(function(e){var i,n,r;i=(n=e.split("; ")[0].split("="))[0],r=n[1],t[i]=r}),t};var q,F,V={request:function(){var t,e,i,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments[1];i=j.config.get("graphUrl"),t=j.config.get("appKey"),e=j.config.get("authToken"),n={method:"post",url:i,timeout:12e3,json:!0,headers:{},body:{query:n.query,operationName:n.operationName,variables:n.variables}},null!=t&&(n.headers.Authorization="Basic "+j.util.btoa("app-key:"+t)),j.util.isNode()&&null!=e?n.cookies=[{key:"shopgun-auth-token",value:e,url:i}]:j.util.isBrowser()&&(n.useCookies=!0),j.request(n,function(t,e){var i,n;null!=t?r(j.util.error(new Error("Graph request error"),{code:"GraphRequestError"})):(j.util.isNode()&&(i=U(null!=(n=e.headers)?n["set-cookie"]:void 0)["shopgun-auth-token"],j.config.get("authToken")!==i&&j.config.set("authToken",i)),200===e.statusCode?r(null,e.body):r(j.util.error(new Error("Graph API error"),{code:"GraphAPIError",statusCode:e.statusCode})))})}};q=S;var X,B,W,Y,Z,G,K=F=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;q.CoreKit.session.ensure(function(n){var r,o,s,a,l,u,h,c,d,p,f,g;return null!=n?e(n):(g=null!=(c=t.url)?c:"",l=null!=(d=t.headers)?d:{},f=q.config.get("coreSessionToken"),s=q.config.get("coreSessionClientId"),o=q.config.get("appVersion"),r=q.config.get("appSecret"),u=q.config.get("locale"),h=null!=(p=t.qs)?p:{},a=t.geolocation,l["X-Token"]=f,null!=r&&(l["X-Signature"]=q.CoreKit.session.sign(r,f)),null!=u&&(h.r_locale=u),null!=o&&(h.api_av=o),null!=s&&(h.client_id=s),null!=a&&(null!=a.latitude&&null==h.r_lat&&(h.r_lat=a.latitude),null!=a.longitude&&null==h.r_lng&&(h.r_lng=a.longitude),null!=a.radius&&null==h.r_radius&&(h.r_radius=a.radius),null!=a.sensor&&null==h.r_sensor&&(h.r_sensor=a.sensor)),q.request({method:t.method,url:q.config.get("coreUrl")+g,qs:h,body:t.body,formData:t.formData,headers:l,json:!0,useCookies:!1},function(n,r){var o,s;null!=n?e(q.util.error(new Error("Core request error"),{code:"CoreRequestError"})):(f=q.config.get("coreSessionToken"),(s=r.headers["x-token"])&&f!==s&&q.CoreKit.session.saveToken(s),r.statusCode>=200&&r.statusCode<300||304===r.statusCode?e(null,r.body):0!==i||null==r.body||1101!==(o=r.body.code)&&1107!==o&&1108!==o?e(q.util.error(new Error("Core API error"),{code:"CoreAPIError",statusCode:r.statusCode}),r.body):(q.config.set({coreSessionToken:void 0}),F(t,e,++i)))}))})},$=i(function(e){!function(t){var i={bytesToHex:function(t){return function(t){return t.map(function(t){return e=t.toString(16),i=2,e.length>i?e:Array(i-e.length+1).join("0")+e;var e,i}).join("")}(t)},hexToBytes:function(t){if(t.length%2==1)throw new Error("hexToBytes can't have a string with an odd number of characters.");return 0===t.indexOf("0x")&&(t=t.slice(2)),t.match(/../g).map(function(t){return parseInt(t,16)})}};e.exports?e.exports=i:t.convertHex=i}(t)}),Q=i(function(e){var i,n;i=t,(n={bytesToString:function(t){return t.map(function(t){return String.fromCharCode(t)}).join("")},stringToBytes:function(t){return t.split("").map(function(t){return t.charCodeAt(0)})}}).UTF8={bytesToString:function(t){return decodeURIComponent(escape(n.bytesToString(t)))},stringToBytes:function(t){return n.stringToBytes(unescape(encodeURIComponent(t)))}},e.exports?e.exports=n:i.convertString=n}),J=i(function(e){!function(t){var i={};e.exports?(i.bytesToHex=$.bytesToHex,i.convertString=Q,e.exports=l):(i.bytesToHex=t.convertHex.bytesToHex,i.convertString=t.convertString,t.sha256=l);var n=[];!function(){function t(t){for(var e=Math.sqrt(t),i=2;i<=e;i++)if(!(t%i))return!1;return!0}function e(t){return 4294967296*(t-(0|t))|0}for(var i=2,r=0;r<64;)t(i)&&(n[r]=e(Math.pow(i,1/3)),r++),i++}();var r=function(t){for(var e=[],i=0,n=0;i<t.length;i++,n+=8)e[n>>>5]|=t[i]<<24-n%32;return e},o=function(t){for(var e=[],i=0;i<32*t.length;i+=8)e.push(t[i>>>5]>>>24-i%32&255);return e},s=[],a=function(t,e,i){for(var r=t[0],o=t[1],a=t[2],l=t[3],u=t[4],h=t[5],c=t[6],d=t[7],p=0;p<64;p++){if(p<16)s[p]=0|e[i+p];else{var f=s[p-15],g=(f<<25|f>>>7)^(f<<14|f>>>18)^f>>>3,v=s[p-2],y=(v<<15|v>>>17)^(v<<13|v>>>19)^v>>>10;s[p]=g+s[p-7]+y+s[p-16]}var m=r&o^r&a^o&a,b=(r<<30|r>>>2)^(r<<19|r>>>13)^(r<<10|r>>>22),_=d+((u<<26|u>>>6)^(u<<21|u>>>11)^(u<<7|u>>>25))+(u&h^~u&c)+n[p]+s[p];d=c,c=h,h=u,u=l+_|0,l=a,a=o,o=r,r=_+(b+m)|0}t[0]=t[0]+r|0,t[1]=t[1]+o|0,t[2]=t[2]+a|0,t[3]=t[3]+l|0,t[4]=t[4]+u|0,t[5]=t[5]+h|0,t[6]=t[6]+c|0,t[7]=t[7]+d|0};function l(t,e){t.constructor===String&&(t=i.convertString.UTF8.stringToBytes(t));var n=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],s=r(t),l=8*t.length;s[l>>5]|=128<<24-l%32,s[15+(l+64>>9<<4)]=l;for(var u=0;u<s.length;u+=16)a(n,s,u);var h=o(n);return e&&e.asBytes?h:e&&e.asString?i.convertString.bytesToString(h):i.bytesToHex(h)}l.x2=function(t,e){return l(l(t,{asBytes:!0}),e)}}(t)});X=S,G=J,W=C,B=[],Y=!1;var tt,et,it,nt,rt,ot,st,at,lt,ut,ht,ct,dt={request:K,session:Z={ttl:5184e3,saveToken:function(t){if(!t)throw new Error("No token provided for saving");X.config.set({coreSessionToken:t}),Z.saveCookie()},saveClientId:function(t){X.config.set({coreSessionClientId:t}),Z.saveCookie()},saveCookie:function(){W.set("session",{token:X.config.get("coreSessionToken"),client_id:X.config.get("coreSessionClientId")})},create:function(t){X.request({method:"post",url:X.config.get("coreUrl")+"/v2/sessions",json:!0,qs:{api_key:X.config.get("appKey"),token_ttl:Z.ttl}},function(e,i){null!=e?t(e):201===i.statusCode?(Z.saveToken(i.body.token),Z.saveClientId(i.body.client_id),t(e,i.body)):t(new Error("Could not create session"))})},update:function(t){var e,i,n;i={},n=X.config.get("coreSessionToken"),e=X.config.get("appSecret"),i["X-Token"]=n,null!=e&&(i["X-Signature"]=Z.sign(e,n)),X.request({url:X.config.get("coreUrl")+"/v2/sessions",headers:i,json:!0},function(e,i){null!=e?t(e):200===i.statusCode?(Z.saveToken(i.body.token),Z.saveClientId(i.body.client_id),t(e,i.body)):t(new Error("Could not update session"))})},renew:function(t){var e,i,n;i={},n=X.config.get("coreSessionToken"),e=X.config.get("appSecret"),i["X-Token"]=n,null!=e&&(i["X-Signature"]=Z.sign(e,n)),X.request({method:"put",url:X.config.get("coreUrl")+"/v2/sessions",headers:i,json:!0},function(e,i){null!=e?t(e):200===i.statusCode?(Z.saveToken(i.body.token),Z.saveClientId(i.body.client_id),t(e,i.body)):t(new Error("Could not renew session"))})},ensure:function(t){var e,i;i=B.length,e=function(t){B=B.filter(function(e){return e(t),!1})},B.push(t),0===i&&(null==X.config.get("coreSessionToken")?Z.create(e):!1===Y?(Y=!0,Z.renew(function(t){null!=t?Z.create(e):e()})):e())},sign:function(t,e){return G([t,e].join(""))}}},pt=i(function(t,i){t.exports=function t(i,n,r){function o(a,l){if(!n[a]){if(!i[a]){var u=e;if(!l&&u)return u(a,!0);if(s)return s(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var c=n[a]={exports:{}};i[a][0].call(c.exports,function(t){var e=i[a][1][t];return o(e||t)},c,c.exports,t,i,n,r)}return n[a].exports}for(var s=e,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e,i){var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.exports=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.run=0}return n(t,[{key:"animate",value:function(){var t,e,i,n,r,o,s,a,l,u,h,c,d,p=this,f=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},g=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};return c=null!=(i=f.x)?i:0,d=null!=(n=f.y)?n:0,l=null!=(r=f.scale)?r:1,e=null!=(o=f.easing)?o:"ease-out",t=null!=(s=f.duration)?s:0,a=++this.run,u="translate3d("+c+", "+d+", 0px) scale3d("+l+", "+l+", 1)",this.el.style.transform===u?g():t>0?(h=function(){a===p.run&&(p.el.removeEventListener("transitionend",h),p.el.style.transition="none",g())},this.el.addEventListener("transitionend",h,!1),this.el.style.transition="transform "+e+" "+t+"ms",this.el.style.transform=u):(this.el.style.transition="none",this.el.style.transform=u,g()),this}}]),t}()},{}],2:[function(t,e,i){var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.exports=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.options=i,this.visibility="gone",this.positioned=!1,this.active=!1,this.id=this.options.id,this.type=this.options.type,this.pageIds=this.options.pageIds,this.width=this.options.width,this.left=this.options.left,this.maxZoomScale=this.options.maxZoomScale}return n(t,[{key:"isZoomable",value:function(){return this.getMaxZoomScale()>1&&"false"!==this.getEl().getAttribute("data-zoomable")}},{key:"isScrollable",value:function(){return this.getEl().classList.contains("verso--scrollable")}},{key:"getEl",value:function(){return this.el}},{key:"getOverlayEls",value:function(){return this.getEl().querySelectorAll(".verso__overlay")}},{key:"getPageEls",value:function(){return this.getEl().querySelectorAll(".verso__page")}},{key:"getRect",value:function(){return this.getEl().getBoundingClientRect()}},{key:"getContentRect",value:function(){var t,e,i,n,r,o,s,a,l,u,h,c,d,p,f;for(u={top:null,left:null,right:null,bottom:null,width:null,height:null},h=this.getPageEls(),e=0,i=h.length;e<i;e++)a=h[e],t=a.getBoundingClientRect(),o=a.offsetTop,n=a.offsetLeft,s=o-t.top,r=n-t.left,((l={top:t.top+s,left:t.left+r,right:t.right+r,bottom:t.bottom+s,width:t.width,height:t.height}).top<u.top||null==u.top)&&(u.top=l.top),(l.left<u.left||null==u.left)&&(u.left=l.left),(l.right>u.right||null==u.right)&&(u.right=l.right),(l.bottom>u.bottom||null==u.bottom)&&(u.bottom=l.bottom);return u.top=null!=(c=u.top)?c:0,u.left=null!=(d=u.left)?d:0,u.right=null!=(p=u.right)?p:0,u.bottom=null!=(f=u.bottom)?f:0,u.width=u.right-u.left,u.height=u.bottom-u.top,u}},{key:"getId",value:function(){return this.id}},{key:"getType",value:function(){return this.type}},{key:"getPageIds",value:function(){return this.pageIds}},{key:"getWidth",value:function(){return this.width}},{key:"getLeft",value:function(){return this.left}},{key:"getMaxZoomScale",value:function(){return this.maxZoomScale}},{key:"getVisibility",value:function(){return this.visibility}},{key:"setVisibility",value:function(t){return this.visibility!==t&&(this.getEl().style.display="visible"===t?"block":"none",this.visibility=t),this}},{key:"position",value:function(){return!1===this.positioned&&(this.getEl().style.left=this.getLeft()+"%",this.positioned=!0),this}},{key:"activate",value:function(){this.active=!0,this.getEl().setAttribute("data-active",this.active)}},{key:"deactivate",value:function(){this.active=!1,this.getEl().setAttribute("data-active",this.active)}}]),t}()},{}],3:[function(t,e,i){var n,r,o,s,a,l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();r=t("hammerjs"),o=t("microevent"),s=t("./page_spread"),n=t("./animation"),a=function(){function t(e){var i,o,s,a,l,u,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.el=e,this.options=h,this.swipeVelocity=null!=(i=this.options.swipeVelocity)?i:.3,this.swipeThreshold=null!=(o=this.options.swipeThreshold)?o:10,this.navigationDuration=null!=(s=this.options.navigationDuration)?s:240,this.navigationPanDuration=null!=(a=this.options.navigationPanDuration)?a:200,this.zoomDuration=null!=(l=this.options.zoomDuration)?l:200,this.doubleTapDelay=null!=(u=this.options.doubleTapDelay)?u:300,this.position=-1,this.pinching=!1,this.panning=!1,this.transform={left:0,top:0,scale:1},this.startTransform={left:0,top:0,scale:1},this.tap={count:0,delay:this.doubleTapDelay},this.scrollerEl=this.el.querySelector(".verso__scroller"),this.pageSpreadEls=this.el.querySelectorAll(".verso__page-spread"),this.pageSpreads=this.traversePageSpreads(this.pageSpreadEls),this.pageIds=this.buildPageIds(this.pageSpreads),this.animation=new n(this.scrollerEl),this.hammer=new r.Manager(this.scrollerEl,{touchAction:"none",enable:!1,inputClass:this.getHammerInputClass()}),this.hammer.add(new r.Pan({threshold:5,direction:r.DIRECTION_ALL})),this.hammer.add(new r.Tap({event:"singletap",interval:0})),this.hammer.add(new r.Pinch),this.hammer.add(new r.Press({time:500})),this.hammer.on("panstart",this.onPanStart.bind(this)),this.hammer.on("panmove",this.onPanMove.bind(this)),this.hammer.on("panend",this.onPanEnd.bind(this)),this.hammer.on("pancancel",this.onPanEnd.bind(this)),this.hammer.on("singletap",this.onSingletap.bind(this)),this.hammer.on("pinchstart",this.onPinchStart.bind(this)),this.hammer.on("pinchmove",this.onPinchMove.bind(this)),this.hammer.on("pinchend",this.onPinchEnd.bind(this)),this.hammer.on("pinchcancel",this.onPinchEnd.bind(this)),this.hammer.on("press",this.onPress.bind(this)),this.scrollerEl.addEventListener("contextmenu",this.onContextmenu.bind(this))}return l(t,[{key:"start",value:function(){var t,e;return t=null!=(e=this.getPageSpreadPositionFromPageId(this.options.pageId))?e:0,this.hammer.set({enable:!0}),this.navigateTo(t,{duration:0}),this.resizeListener=this.onResize.bind(this),this.touchStartListener=this.onTouchStart.bind(this),this.touchEndListener=this.onTouchEnd.bind(this),this.el.addEventListener("touchstart",this.touchStartListener,!1),this.el.addEventListener("touchend",this.touchEndListener,!1),window.addEventListener("resize",this.resizeListener,!1),this}},{key:"destroy",value:function(){return this.hammer.destroy(),this.el.removeEventListener("touchstart",this.touchStartListener),this.el.removeEventListener("touchend",this.touchEndListener),window.removeEventListener("resize",this.resizeListener),this}},{key:"first",value:function(t){return this.navigateTo(0,t)}},{key:"prev",value:function(t){return this.navigateTo(this.getPosition()-1,t)}},{key:"next",value:function(t){return this.navigateTo(this.getPosition()+1,t)}},{key:"last",value:function(t){return this.navigateTo(this.getPageSpreadCount()-1,t)}},{key:"navigateTo",value:function(t){var e,i,n,r,o,s,a,l,u,h=this,c=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};t<0||t>this.getPageSpreadCount()-1||(r=this.getPosition(),n=this.getPageSpreadFromPosition(r),e=this.getPageSpreadFromPosition(t),i=this.getCarouselFromPageSpread(e),u=null!=(s=c.velocity)?s:1,o=null!=(a=c.duration)?a:this.navigationDuration,o/=Math.abs(u),l=e.isScrollable()?"pan-y":"none",null!=n&&n.deactivate(),e.activate(),i.visible.forEach(function(t){return t.position().setVisibility("visible")}),this.hammer.set({touchAction:l}),this.transform.left=this.getLeftTransformFromPageSpread(t,e),this.setPosition(t),this.transform.scale>1&&(this.transform.top=0,this.transform.scale=1,this.trigger("zoomedOut",{position:r})),this.trigger("beforeNavigation",{currentPosition:r,newPosition:t}),this.animation.animate({x:this.transform.left+"%",duration:o},function(){(i=h.getCarouselFromPageSpread(h.getActivePageSpread())).gone.forEach(function(t){return t.setVisibility("gone")}),h.trigger("afterNavigation",{newPosition:h.getPosition(),previousPosition:r})}))}},{key:"getPosition",value:function(){return this.position}},{key:"setPosition",value:function(t){return this.position=t,this}},{key:"getLeftTransformFromPageSpread",value:function(t,e){var i;return i=0,t===this.getPageSpreadCount()-1?i=100-e.getWidth()-e.getLeft():t>0&&(i=(100-e.getWidth())/2-e.getLeft()),i}},{key:"getCarouselFromPageSpread",value:function(t){var e;return e={visible:[],gone:[]},this.pageSpreads.forEach(function(i){var n;n=!1,i.getLeft()<=t.getLeft()?i.getLeft()+i.getWidth()>t.getLeft()-100&&(n=!0):i.getLeft()-i.getWidth()<t.getLeft()+100&&(n=!0),!0===n?e.visible.push(i):e.gone.push(i)}),e}},{key:"traversePageSpreads",value:function(t){var e,i,n,r,o,a,l,u,h,c,d;for(h=[],r=0,n=0,o=t.length;n<o;n++)e=t[n],i=e.getAttribute("data-id"),c=e.getAttribute("data-type"),l=null!=(l=e.getAttribute("data-page-ids"))?l.split(",").map(function(t){return t}):[],a=null!=(a=e.getAttribute("data-max-zoom-scale"))?+a:1,d=e.getAttribute("data-width"),u=new s(e,{id:i,type:c,pageIds:l,maxZoomScale:a,width:d=null!=d?+d:100,left:r}),r+=d,h.push(u);return h}},{key:"buildPageIds",value:function(t){var e;return e={},t.forEach(function(t,i){t.options.pageIds.forEach(function(i){e[i]=t})}),e}},{key:"isCoordinateInsideElement",value:function(t,e,i){var n;return n=i.getBoundingClientRect(),t>=n.left&&t<=n.right&&e>=n.top&&e<=n.bottom}},{key:"getCoordinateInfo",value:function(t,e,i){var n,r,o,s,a,l,u,h,c,d;for(t-=this.el.offsetLeft,e-=this.el.offsetTop,r={x:t,y:e,contentX:0,contentY:0,pageX:0,pageY:0,overlayEls:[],pageEl:null,isInsideContentX:!1,isInsideContentY:!1,isInsideContent:!1},n=i.getContentRect(),h=i.getOverlayEls(),d=i.getPageEls(),o=0,a=h.length;o<a;o++)u=h[o],this.isCoordinateInsideElement(t,e,u)&&r.overlayEls.push(u);for(s=0,l=d.length;s<l;s++)if(c=d[s],this.isCoordinateInsideElement(t,e,c)){r.pageEl=c;break}return r.contentX=(t-n.left)/Math.max(1,n.width),r.contentY=(e-n.top)/Math.max(1,n.height),null!=r.pageEl&&(r.isInsideContentX=r.contentX>=0&&r.contentX<=1,r.isInsideContentY=r.contentY>=0&&r.contentY<=1,r.isInsideContent=r.isInsideContentX&&r.isInsideContentY),r}},{key:"getPageSpreadCount",value:function(){return this.pageSpreads.length}},{key:"getActivePageSpread",value:function(){return this.getPageSpreadFromPosition(this.getPosition())}},{key:"getPageSpreadFromPosition",value:function(t){return this.pageSpreads[t]}},{key:"getPageSpreadPositionFromPageId",value:function(t){var e,i,n,r;for(r=this.pageSpreads,e=i=0,n=r.length;i<n;e=++i)if(r[e].options.pageIds.indexOf(t)>-1)return e}},{key:"getPageSpreadBounds",value:function(t){var e,i;return i=t.getRect(),{left:((e=t.getContentRect()).left-i.left)/i.width*100,top:(e.top-i.top)/i.height*100,width:e.width/i.width*100,height:e.height/i.height*100,pageSpreadRect:i,pageSpreadContentRect:e}}},{key:"clipCoordinate",value:function(t,e,i,n){return i*e<100?t=n*-e+50-i*e/2:(t=Math.min(t,n*-e),t=Math.max(t,n*-e-i*e+100)),t}},{key:"zoomTo",value:function(){var t,e,i,n,r,o,s,a,l,u,h=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},c=arguments[1];a=h.scale,n=this.transform.scale,t=this.getActivePageSpread(),r=this.getPageSpreadBounds(t),e=t.getLeft(),i=e*n,l=null!=(o=h.x)?o:0,u=null!=(s=h.y)?s:0,1!==a?(l-=r.pageSpreadRect.left,u-=r.pageSpreadRect.top,l=l/(r.pageSpreadRect.width/n)*100,u=u/(r.pageSpreadRect.height/n)*100,l=this.transform.left+i+l-l*a/n,u=this.transform.top+u-u*a/n,!1!==h.bounds&&a>1&&(l=this.clipCoordinate(l,a,r.width,r.left),u=this.clipCoordinate(u,a,r.height,r.top))):(l=0,u=0),l-=e*a,this.transform.left=l,this.transform.top=u,this.transform.scale=a,this.animation.animate({x:l+"%",y:u+"%",scale:a,easing:h.easing,duration:h.duration},c)}},{key:"refresh",value:function(){return this.pageSpreadEls=this.el.querySelectorAll(".verso__page-spread"),this.pageSpreads=this.traversePageSpreads(this.pageSpreadEls),this.pageIds=this.buildPageIds(this.pageSpreads),this}},{key:"getHammerInputClass",value:function(){return"ontouchstart"in window&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent)?r.TouchInput:null}},{key:"onPanStart",value:function(t){var e,i;(this.transform.scale>1||t.direction===r.DIRECTION_LEFT||t.direction===r.DIRECTION_RIGHT)&&(i=t.center.x,e=this.scrollerEl.offsetWidth,i>30&&i<e-30&&(this.startTransform.left=this.transform.left,this.startTransform.top=this.transform.top,this.panning=!0,this.trigger("panStart")))}},{key:"onPanMove",value:function(t){var e,i,n,r,o,s,a;!0!==this.pinching&&!1!==this.panning&&(this.transform.scale>1?(e=this.getActivePageSpread(),i=e.getLeft(),n=i*this.transform.scale,r=this.getPageSpreadBounds(e),o=this.transform.scale,s=this.startTransform.left+n+t.deltaX/this.scrollerEl.offsetWidth*100,a=this.startTransform.top+t.deltaY/this.scrollerEl.offsetHeight*100,s=this.clipCoordinate(s,o,r.width,r.left),a=this.clipCoordinate(a,o,r.height,r.top),s-=n,this.transform.left=s,this.transform.top=a,this.animation.animate({x:s+"%",y:a+"%",scale:o,easing:"linear"})):(s=this.transform.left+t.deltaX/this.scrollerEl.offsetWidth*100,this.animation.animate({x:s+"%",easing:"linear"})))}},{key:"onPanEnd",value:function(t){var e,i;!1!==this.panning&&(this.panning=!1,this.trigger("panEnd"),1===this.transform.scale&&!1===this.pinching&&(e=this.getPosition(),i=t.overallVelocityX,Math.abs(i)>=this.swipeVelocity&&Math.abs(t.deltaX)>=this.swipeThreshold&&(t.offsetDirection===r.DIRECTION_LEFT?this.next({velocity:i,duration:this.navigationPanDuration}):t.offsetDirection===r.DIRECTION_RIGHT&&this.prev({velocity:i,duration:this.navigationPanDuration})),e===this.getPosition()&&(this.animation.animate({x:this.transform.left+"%",duration:this.navigationPanDuration}),this.trigger("attemptedNavigation",{position:this.getPosition()}))))}},{key:"onPinchStart",value:function(t){this.getActivePageSpread().isZoomable()&&(this.pinching=!0,this.el.setAttribute("data-pinching",!0),this.startTransform.scale=this.transform.scale)}},{key:"onPinchMove",value:function(t){!1!==this.pinching&&this.zoomTo({x:t.center.x,y:t.center.y,scale:this.startTransform.scale*t.scale,bounds:!1,easing:"linear"})}},{key:"onPinchEnd",value:function(t){var e,i,n,r,o=this;!1!==this.pinching&&(e=this.getActivePageSpread(),i=e.getMaxZoomScale(),r=Math.max(1,Math.min(this.transform.scale,i)),n=this.getPosition(),1===this.startTransform.scale&&r>1?this.trigger("zoomedIn",{position:n}):this.startTransform.scale>1&&1===r&&this.trigger("zoomedOut",{position:n}),this.zoomTo({x:t.center.x,y:t.center.y,scale:r,duration:this.zoomDuration},function(){o.pinching=!1,o.el.setAttribute("data-pinching",!1)}))}},{key:"onPress",value:function(t){this.trigger("pressed",this.getCoordinateInfo(t.center.x,t.center.y,this.getActivePageSpread()))}},{key:"onContextmenu",value:function(t){return t.preventDefault(),this.trigger("contextmenu",this.getCoordinateInfo(t.clientX,t.clientY,this.getActivePageSpread())),!1}},{key:"onSingletap",value:function(t){var e,i,n,r,o,s,a,l=this;e=this.getActivePageSpread(),i=this.getCoordinateInfo(t.center.x,t.center.y,e),clearTimeout(this.tap.timeout),1===this.tap.count?(this.tap.count=0,this.trigger("doubleClicked",i),e.isZoomable()&&(n=e.getMaxZoomScale(),a=this.transform.scale>1,o=a?1:n,s=a?"zoomedOut":"zoomedIn",r=this.getPosition(),this.zoomTo({x:t.center.x,y:t.center.y,scale:o,duration:this.zoomDuration},function(){l.trigger(s,{position:r})}))):(this.tap.count++,this.tap.timeout=setTimeout(function(){l.tap.count=0,l.trigger("clicked",i)},this.tap.delay))}},{key:"onTouchStart",value:function(t){this.getActivePageSpread().isScrollable()||t.preventDefault()}},{key:"onTouchEnd",value:function(t){this.getActivePageSpread().isScrollable()||t.preventDefault()}},{key:"onResize",value:function(){var t,e;this.transform.scale>1&&(e=this.getPosition(),t=this.getActivePageSpread(),this.transform.left=this.getLeftTransformFromPageSpread(e,t),this.transform.top=0,this.transform.scale=1,this.zoomTo({x:this.transform.left,y:this.transform.top,scale:this.transform.scale,duration:0}),this.trigger("zoomedOut",{position:e}))}}]),t}(),o.mixin(a),e.exports=a},{"./animation":1,"./page_spread":2,hammerjs:4,microevent:5}],4:[function(t,e,i){!function(t,i,n,r){var o,s=["","webkit","Moz","MS","ms","o"],a=i.createElement("div"),l="function",u=Math.round,h=Math.abs,c=Date.now;function d(t,e,i){return setTimeout(b(t,i),e)}function p(t,e,i){return!!Array.isArray(t)&&(f(t,i[e],i),!0)}function f(t,e,i){var n;if(t)if(t.forEach)t.forEach(e,i);else if(t.length!==r)for(n=0;n<t.length;)e.call(i,t[n],n,t),n++;else for(n in t)t.hasOwnProperty(n)&&e.call(i,t[n],n,t)}function g(e,i,n){var r="DEPRECATED METHOD: "+i+"\n"+n+" AT \n";return function(){var i=new Error("get-stack-trace"),n=i&&i.stack?i.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",o=t.console&&(t.console.warn||t.console.log);return o&&o.call(t.console,r,n),e.apply(this,arguments)}}o="function"!=typeof Object.assign?function(t){if(t===r||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),i=1;i<arguments.length;i++){var n=arguments[i];if(n!==r&&null!==n)for(var o in n)n.hasOwnProperty(o)&&(e[o]=n[o])}return e}:Object.assign;var v=g(function(t,e,i){for(var n=Object.keys(e),o=0;o<n.length;)(!i||i&&t[n[o]]===r)&&(t[n[o]]=e[n[o]]),o++;return t},"extend","Use `assign`."),y=g(function(t,e){return v(t,e,!0)},"merge","Use `assign`.");function m(t,e,i){var n,r=e.prototype;(n=t.prototype=Object.create(r)).constructor=t,n._super=r,i&&o(n,i)}function b(t,e){return function(){return t.apply(e,arguments)}}function _(t,e){return typeof t==l?t.apply(e&&e[0]||r,e):t}function w(t,e){return t===r?e:t}function k(t,e,i){f(T(e),function(e){t.addEventListener(e,i,!1)})}function S(t,e,i){f(T(e),function(e){t.removeEventListener(e,i,!1)})}function x(t,e){for(;t;){if(t==e)return!0;t=t.parentNode}return!1}function E(t,e){return t.indexOf(e)>-1}function T(t){return t.trim().split(/\s+/g)}function P(t,e,i){if(t.indexOf&&!i)return t.indexOf(e);for(var n=0;n<t.length;){if(i&&t[n][i]==e||!i&&t[n]===e)return n;n++}return-1}function C(t){return Array.prototype.slice.call(t,0)}function O(t,e,i){for(var n=[],r=[],o=0;o<t.length;){var s=e?t[o][e]:t[o];P(r,s)<0&&n.push(t[o]),r[o]=s,o++}return i&&(n=e?n.sort(function(t,i){return t[e]>i[e]}):n.sort()),n}function I(t,e){for(var i,n,o=e[0].toUpperCase()+e.slice(1),a=0;a<s.length;){if(i=s[a],(n=i?i+o:e)in t)return n;a++}return r}var A=1;function L(e){var i=e.ownerDocument||e;return i.defaultView||i.parentWindow||t}var N="ontouchstart"in t,D=I(t,"PointerEvent")!==r,R=N&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),z=25,M=1,j=2,U=4,H=8,q=1,F=2,V=4,X=8,B=16,W=F|V,Y=X|B,Z=W|Y,G=["x","y"],K=["clientX","clientY"];function $(t,e){var i=this;this.manager=t,this.callback=e,this.element=t.element,this.target=t.options.inputTarget,this.domHandler=function(e){_(t.options.enable,[t])&&i.handler(e)},this.init()}function Q(t,e,i){var n=i.pointers.length,o=i.changedPointers.length,s=e&M&&n-o==0,a=e&(U|H)&&n-o==0;i.isFirst=!!s,i.isFinal=!!a,s&&(t.session={}),i.eventType=e,function(t,e){var i=t.session,n=e.pointers,o=n.length;i.firstInput||(i.firstInput=J(e)),o>1&&!i.firstMultiple?i.firstMultiple=J(e):1===o&&(i.firstMultiple=!1);var s=i.firstInput,a=i.firstMultiple,l=a?a.center:s.center,u=e.center=tt(n);e.timeStamp=c(),e.deltaTime=e.timeStamp-s.timeStamp,e.angle=rt(l,u),e.distance=nt(l,u),function(t,e){var i=e.center,n=t.offsetDelta||{},r=t.prevDelta||{},o=t.prevInput||{};e.eventType!==M&&o.eventType!==U||(r=t.prevDelta={x:o.deltaX||0,y:o.deltaY||0},n=t.offsetDelta={x:i.x,y:i.y}),e.deltaX=r.x+(i.x-n.x),e.deltaY=r.y+(i.y-n.y)}(i,e),e.offsetDirection=it(e.deltaX,e.deltaY);var d,p,f=et(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=f.x,e.overallVelocityY=f.y,e.overallVelocity=h(f.x)>h(f.y)?f.x:f.y,e.scale=a?(d=a.pointers,nt((p=n)[0],p[1],K)/nt(d[0],d[1],K)):1,e.rotation=a?function(t,e){return rt(e[1],e[0],K)+rt(t[1],t[0],K)}(a.pointers,n):0,e.maxPointers=i.prevInput?e.pointers.length>i.prevInput.maxPointers?e.pointers.length:i.prevInput.maxPointers:e.pointers.length,function(t,e){var i,n,o,s,a=t.lastInterval||e,l=e.timeStamp-a.timeStamp;if(e.eventType!=H&&(l>z||a.velocity===r)){var u=e.deltaX-a.deltaX,c=e.deltaY-a.deltaY,d=et(l,u,c);n=d.x,o=d.y,i=h(d.x)>h(d.y)?d.x:d.y,s=it(u,c),t.lastInterval=e}else i=a.velocity,n=a.velocityX,o=a.velocityY,s=a.direction;e.velocity=i,e.velocityX=n,e.velocityY=o,e.direction=s}(i,e);var g=t.element;x(e.srcEvent.target,g)&&(g=e.srcEvent.target),e.target=g}(t,i),t.emit("hammer.input",i),t.recognize(i),t.session.prevInput=i}function J(t){for(var e=[],i=0;i<t.pointers.length;)e[i]={clientX:u(t.pointers[i].clientX),clientY:u(t.pointers[i].clientY)},i++;return{timeStamp:c(),pointers:e,center:tt(e),deltaX:t.deltaX,deltaY:t.deltaY}}function tt(t){var e=t.length;if(1===e)return{x:u(t[0].clientX),y:u(t[0].clientY)};for(var i=0,n=0,r=0;r<e;)i+=t[r].clientX,n+=t[r].clientY,r++;return{x:u(i/e),y:u(n/e)}}function et(t,e,i){return{x:e/t||0,y:i/t||0}}function it(t,e){return t===e?q:h(t)>=h(e)?t<0?F:V:e<0?X:B}function nt(t,e,i){i||(i=G);var n=e[i[0]]-t[i[0]],r=e[i[1]]-t[i[1]];return Math.sqrt(n*n+r*r)}function rt(t,e,i){i||(i=G);var n=e[i[0]]-t[i[0]],r=e[i[1]]-t[i[1]];return 180*Math.atan2(r,n)/Math.PI}$.prototype={handler:function(){},init:function(){this.evEl&&k(this.element,this.evEl,this.domHandler),this.evTarget&&k(this.target,this.evTarget,this.domHandler),this.evWin&&k(L(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&S(this.element,this.evEl,this.domHandler),this.evTarget&&S(this.target,this.evTarget,this.domHandler),this.evWin&&S(L(this.element),this.evWin,this.domHandler)}};var ot={mousedown:M,mousemove:j,mouseup:U},st="mousedown",at="mousemove mouseup";function lt(){this.evEl=st,this.evWin=at,this.pressed=!1,$.apply(this,arguments)}m(lt,$,{handler:function(t){var e=ot[t.type];e&M&&0===t.button&&(this.pressed=!0),e&j&&1!==t.which&&(e=U),this.pressed&&(e&U&&(this.pressed=!1),this.callback(this.manager,e,{pointers:[t],changedPointers:[t],pointerType:"mouse",srcEvent:t}))}});var ut={pointerdown:M,pointermove:j,pointerup:U,pointercancel:H,pointerout:H},ht={2:"touch",3:"pen",4:"mouse",5:"kinect"},ct="pointerdown",dt="pointermove pointerup pointercancel";function pt(){this.evEl=ct,this.evWin=dt,$.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}t.MSPointerEvent&&!t.PointerEvent&&(ct="MSPointerDown",dt="MSPointerMove MSPointerUp MSPointerCancel"),m(pt,$,{handler:function(t){var e=this.store,i=!1,n=t.type.toLowerCase().replace("ms",""),r=ut[n],o=ht[t.pointerType]||t.pointerType,s="touch"==o,a=P(e,t.pointerId,"pointerId");r&M&&(0===t.button||s)?a<0&&(e.push(t),a=e.length-1):r&(U|H)&&(i=!0),a<0||(e[a]=t,this.callback(this.manager,r,{pointers:e,changedPointers:[t],pointerType:o,srcEvent:t}),i&&e.splice(a,1))}});var ft={touchstart:M,touchmove:j,touchend:U,touchcancel:H},gt="touchstart",vt="touchstart touchmove touchend touchcancel";function yt(){this.evTarget=gt,this.evWin=vt,this.started=!1,$.apply(this,arguments)}m(yt,$,{handler:function(t){var e=ft[t.type];if(e===M&&(this.started=!0),this.started){var i=function(t,e){var i=C(t.touches),n=C(t.changedTouches);return e&(U|H)&&(i=O(i.concat(n),"identifier",!0)),[i,n]}.call(this,t,e);e&(U|H)&&i[0].length-i[1].length==0&&(this.started=!1),this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:t})}}});var mt={touchstart:M,touchmove:j,touchend:U,touchcancel:H},bt="touchstart touchmove touchend touchcancel";function _t(){this.evTarget=bt,this.targetIds={},$.apply(this,arguments)}m(_t,$,{handler:function(t){var e=mt[t.type],i=function(t,e){var i=C(t.touches),n=this.targetIds;if(e&(M|j)&&1===i.length)return n[i[0].identifier]=!0,[i,i];var r,o,s=C(t.changedTouches),a=[],l=this.target;if(o=i.filter(function(t){return x(t.target,l)}),e===M)for(r=0;r<o.length;)n[o[r].identifier]=!0,r++;for(r=0;r<s.length;)n[s[r].identifier]&&a.push(s[r]),e&(U|H)&&delete n[s[r].identifier],r++;return a.length?[O(o.concat(a),"identifier",!0),a]:void 0}.call(this,t,e);i&&this.callback(this.manager,e,{pointers:i[0],changedPointers:i[1],pointerType:"touch",srcEvent:t})}});var wt=2500,kt=25;function St(){$.apply(this,arguments);var t=b(this.handler,this);this.touch=new _t(this.manager,t),this.mouse=new lt(this.manager,t),this.primaryTouch=null,this.lastTouches=[]}function xt(t){var e=t.changedPointers[0];if(e.identifier===this.primaryTouch){var i={x:e.clientX,y:e.clientY};this.lastTouches.push(i);var n=this.lastTouches;setTimeout(function(){var t=n.indexOf(i);t>-1&&n.splice(t,1)},wt)}}m(St,$,{handler:function(t,e,i){var n="touch"==i.pointerType,r="mouse"==i.pointerType;if(!(r&&i.sourceCapabilities&&i.sourceCapabilities.firesTouchEvents)){if(n)(function(t,e){t&M?(this.primaryTouch=e.changedPointers[0].identifier,xt.call(this,e)):t&(U|H)&&xt.call(this,e)}).call(this,e,i);else if(r&&function(t){for(var e=t.srcEvent.clientX,i=t.srcEvent.clientY,n=0;n<this.lastTouches.length;n++){var r=this.lastTouches[n],o=Math.abs(e-r.x),s=Math.abs(i-r.y);if(o<=kt&&s<=kt)return!0}return!1}.call(this,i))return;this.callback(t,e,i)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var Et=I(a.style,"touchAction"),Tt=Et!==r,Pt="auto",Ct="manipulation",Ot="none",It="pan-x",At="pan-y",Lt=function(){if(!Tt)return!1;var e={},i=t.CSS&&t.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(n){e[n]=!i||t.CSS.supports("touch-action",n)}),e}();function Nt(t,e){this.manager=t,this.set(e)}Nt.prototype={set:function(t){"compute"==t&&(t=this.compute()),Tt&&this.manager.element.style&&Lt[t]&&(this.manager.element.style[Et]=t),this.actions=t.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var t=[];return f(this.manager.recognizers,function(e){_(e.options.enable,[e])&&(t=t.concat(e.getTouchAction()))}),function(t){if(E(t,Ot))return Ot;var e=E(t,It),i=E(t,At);return e&&i?Ot:e||i?e?It:At:E(t,Ct)?Ct:Pt}(t.join(" "))},preventDefaults:function(t){var e=t.srcEvent,i=t.offsetDirection;if(this.manager.session.prevented)e.preventDefault();else{var n=this.actions,r=E(n,Ot)&&!Lt[Ot],o=E(n,At)&&!Lt[At],s=E(n,It)&&!Lt[It];if(r){var a=1===t.pointers.length,l=t.distance<2,u=t.deltaTime<250;if(a&&l&&u)return}if(!s||!o)return r||o&&i&W||s&&i&Y?this.preventSrc(e):void 0}},preventSrc:function(t){this.manager.session.prevented=!0,t.preventDefault()}};var Dt=1,Rt=2,zt=4,Mt=8,jt=Mt,Ut=16;function Ht(t){this.options=o({},this.defaults,t||{}),this.id=A++,this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=Dt,this.simultaneous={},this.requireFail=[]}function qt(t){return t&Ut?"cancel":t&Mt?"end":t&zt?"move":t&Rt?"start":""}function Ft(t){return t==B?"down":t==X?"up":t==F?"left":t==V?"right":""}function Vt(t,e){var i=e.manager;return i?i.get(t):t}function Xt(){Ht.apply(this,arguments)}function Bt(){Xt.apply(this,arguments),this.pX=null,this.pY=null}function Wt(){Xt.apply(this,arguments)}function Yt(){Ht.apply(this,arguments),this._timer=null,this._input=null}function Zt(){Xt.apply(this,arguments)}function Gt(){Xt.apply(this,arguments)}function Kt(){Ht.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function $t(t,e){return(e=e||{}).recognizers=w(e.recognizers,$t.defaults.preset),new Qt(t,e)}function Qt(t,e){var i;this.options=o({},$t.defaults,e||{}),this.options.inputTarget=this.options.inputTarget||t,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=t,this.input=new((i=this).options.inputClass||(D?pt:R?_t:N?St:lt))(i,Q),this.touchAction=new Nt(this,this.options.touchAction),Jt(this,!0),f(this.options.recognizers,function(t){var e=this.add(new t[0](t[1]));t[2]&&e.recognizeWith(t[2]),t[3]&&e.requireFailure(t[3])},this)}function Jt(t,e){var i,n=t.element;n.style&&(f(t.options.cssProps,function(r,o){i=I(n.style,o),e?(t.oldCssProps[i]=n.style[i],n.style[i]=r):n.style[i]=t.oldCssProps[i]||""}),e||(t.oldCssProps={}))}Ht.prototype={defaults:{},set:function(t){return o(this.options,t),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(t){if(p(t,"recognizeWith",this))return this;var e=this.simultaneous;return t=Vt(t,this),e[t.id]||(e[t.id]=t,t.recognizeWith(this)),this},dropRecognizeWith:function(t){return p(t,"dropRecognizeWith",this)?this:(t=Vt(t,this),delete this.simultaneous[t.id],this)},requireFailure:function(t){if(p(t,"requireFailure",this))return this;var e=this.requireFail;return t=Vt(t,this),-1===P(e,t)&&(e.push(t),t.requireFailure(this)),this},dropRequireFailure:function(t){if(p(t,"dropRequireFailure",this))return this;t=Vt(t,this);var e=P(this.requireFail,t);return e>-1&&this.requireFail.splice(e,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(t){return!!this.simultaneous[t.id]},emit:function(t){var e=this,i=this.state;function n(i){e.manager.emit(i,t)}i<Mt&&n(e.options.event+qt(i)),n(e.options.event),t.additionalEvent&&n(t.additionalEvent),i>=Mt&&n(e.options.event+qt(i))},tryEmit:function(t){if(this.canEmit())return this.emit(t);this.state=32},canEmit:function(){for(var t=0;t<this.requireFail.length;){if(!(this.requireFail[t].state&(32|Dt)))return!1;t++}return!0},recognize:function(t){var e=o({},t);if(!_(this.options.enable,[this,e]))return this.reset(),void(this.state=32);this.state&(jt|Ut|32)&&(this.state=Dt),this.state=this.process(e),this.state&(Rt|zt|Mt|Ut)&&this.tryEmit(e)},process:function(t){},getTouchAction:function(){},reset:function(){}},m(Xt,Ht,{defaults:{pointers:1},attrTest:function(t){var e=this.options.pointers;return 0===e||t.pointers.length===e},process:function(t){var e=this.state,i=t.eventType,n=e&(Rt|zt),r=this.attrTest(t);return n&&(i&H||!r)?e|Ut:n||r?i&U?e|Mt:e&Rt?e|zt:Rt:32}}),m(Bt,Xt,{defaults:{event:"pan",threshold:10,pointers:1,direction:Z},getTouchAction:function(){var t=this.options.direction,e=[];return t&W&&e.push(At),t&Y&&e.push(It),e},directionTest:function(t){var e=this.options,i=!0,n=t.distance,r=t.direction,o=t.deltaX,s=t.deltaY;return r&e.direction||(e.direction&W?(r=0===o?q:o<0?F:V,i=o!=this.pX,n=Math.abs(t.deltaX)):(r=0===s?q:s<0?X:B,i=s!=this.pY,n=Math.abs(t.deltaY))),t.direction=r,i&&n>e.threshold&&r&e.direction},attrTest:function(t){return Xt.prototype.attrTest.call(this,t)&&(this.state&Rt||!(this.state&Rt)&&this.directionTest(t))},emit:function(t){this.pX=t.deltaX,this.pY=t.deltaY;var e=Ft(t.direction);e&&(t.additionalEvent=this.options.event+e),this._super.emit.call(this,t)}}),m(Wt,Xt,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[Ot]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.scale-1)>this.options.threshold||this.state&Rt)},emit:function(t){if(1!==t.scale){var e=t.scale<1?"in":"out";t.additionalEvent=this.options.event+e}this._super.emit.call(this,t)}}),m(Yt,Ht,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[Pt]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,r=t.deltaTime>e.time;if(this._input=t,!n||!i||t.eventType&(U|H)&&!r)this.reset();else if(t.eventType&M)this.reset(),this._timer=d(function(){this.state=jt,this.tryEmit()},e.time,this);else if(t.eventType&U)return jt;return 32},reset:function(){clearTimeout(this._timer)},emit:function(t){this.state===jt&&(t&&t.eventType&U?this.manager.emit(this.options.event+"up",t):(this._input.timeStamp=c(),this.manager.emit(this.options.event,this._input)))}}),m(Zt,Xt,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[Ot]},attrTest:function(t){return this._super.attrTest.call(this,t)&&(Math.abs(t.rotation)>this.options.threshold||this.state&Rt)}}),m(Gt,Xt,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:W|Y,pointers:1},getTouchAction:function(){return Bt.prototype.getTouchAction.call(this)},attrTest:function(t){var e,i=this.options.direction;return i&(W|Y)?e=t.overallVelocity:i&W?e=t.overallVelocityX:i&Y&&(e=t.overallVelocityY),this._super.attrTest.call(this,t)&&i&t.offsetDirection&&t.distance>this.options.threshold&&t.maxPointers==this.options.pointers&&h(e)>this.options.velocity&&t.eventType&U},emit:function(t){var e=Ft(t.offsetDirection);e&&this.manager.emit(this.options.event+e,t),this.manager.emit(this.options.event,t)}}),m(Kt,Ht,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Ct]},process:function(t){var e=this.options,i=t.pointers.length===e.pointers,n=t.distance<e.threshold,r=t.deltaTime<e.time;if(this.reset(),t.eventType&M&&0===this.count)return this.failTimeout();if(n&&r&&i){if(t.eventType!=U)return this.failTimeout();var o=!this.pTime||t.timeStamp-this.pTime<e.interval,s=!this.pCenter||nt(this.pCenter,t.center)<e.posThreshold;this.pTime=t.timeStamp,this.pCenter=t.center,s&&o?this.count+=1:this.count=1,this._input=t;var a=this.count%e.taps;if(0===a)return this.hasRequireFailures()?(this._timer=d(function(){this.state=jt,this.tryEmit()},e.interval,this),Rt):jt}return 32},failTimeout:function(){return this._timer=d(function(){this.state=32},this.options.interval,this),32},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==jt&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),$t.VERSION="2.0.7",$t.defaults={domEvents:!1,touchAction:"compute",enable:!0,inputTarget:null,inputClass:null,preset:[[Zt,{enable:!1}],[Wt,{enable:!1},["rotate"]],[Gt,{direction:W}],[Bt,{direction:W},["swipe"]],[Kt],[Kt,{event:"doubletap",taps:2},["tap"]],[Yt]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},Qt.prototype={set:function(t){return o(this.options,t),t.touchAction&&this.touchAction.update(),t.inputTarget&&(this.input.destroy(),this.input.target=t.inputTarget,this.input.init()),this},stop:function(t){this.session.stopped=t?2:1},recognize:function(t){var e=this.session;if(!e.stopped){var i;this.touchAction.preventDefaults(t);var n=this.recognizers,r=e.curRecognizer;(!r||r&&r.state&jt)&&(r=e.curRecognizer=null);for(var o=0;o<n.length;)i=n[o],2===e.stopped||r&&i!=r&&!i.canRecognizeWith(r)?i.reset():i.recognize(t),!r&&i.state&(Rt|zt|Mt)&&(r=e.curRecognizer=i),o++}},get:function(t){if(t instanceof Ht)return t;for(var e=this.recognizers,i=0;i<e.length;i++)if(e[i].options.event==t)return e[i];return null},add:function(t){if(p(t,"add",this))return this;var e=this.get(t.options.event);return e&&this.remove(e),this.recognizers.push(t),t.manager=this,this.touchAction.update(),t},remove:function(t){if(p(t,"remove",this))return this;if(t=this.get(t)){var e=this.recognizers,i=P(e,t);-1!==i&&(e.splice(i,1),this.touchAction.update())}return this},on:function(t,e){if(t!==r&&e!==r){var i=this.handlers;return f(T(t),function(t){i[t]=i[t]||[],i[t].push(e)}),this}},off:function(t,e){if(t!==r){var i=this.handlers;return f(T(t),function(t){e?i[t]&&i[t].splice(P(i[t],e),1):delete i[t]}),this}},emit:function(t,e){this.options.domEvents&&function(t,e){var n=i.createEvent("Event");n.initEvent(t,!0,!0),n.gesture=e,e.target.dispatchEvent(n)}(t,e);var n=this.handlers[t]&&this.handlers[t].slice();if(n&&n.length){e.type=t,e.preventDefault=function(){e.srcEvent.preventDefault()};for(var r=0;r<n.length;)n[r](e),r++}},destroy:function(){this.element&&Jt(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},o($t,{INPUT_START:M,INPUT_MOVE:j,INPUT_END:U,INPUT_CANCEL:H,STATE_POSSIBLE:Dt,STATE_BEGAN:Rt,STATE_CHANGED:zt,STATE_ENDED:Mt,STATE_RECOGNIZED:jt,STATE_CANCELLED:Ut,STATE_FAILED:32,DIRECTION_NONE:q,DIRECTION_LEFT:F,DIRECTION_RIGHT:V,DIRECTION_UP:X,DIRECTION_DOWN:B,DIRECTION_HORIZONTAL:W,DIRECTION_VERTICAL:Y,DIRECTION_ALL:Z,Manager:Qt,Input:$,TouchAction:Nt,TouchInput:_t,MouseInput:lt,PointerEventInput:pt,TouchMouseInput:St,SingleTouchInput:yt,Recognizer:Ht,AttrRecognizer:Xt,Tap:Kt,Pan:Bt,Swipe:Gt,Pinch:Wt,Rotate:Zt,Press:Yt,on:k,off:S,each:f,merge:y,extend:v,assign:o,inherit:m,bindFn:b,prefixed:I});var te=void 0!==t?t:"undefined"!=typeof self?self:{};te.Hammer=$t,void 0!==e&&e.exports?e.exports=$t:t.Hammer=$t}(window,document)},{}],5:[function(t,e,i){var n=function(){};n.prototype={bind:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},unbind:function(t,e){this._events=this._events||{},t in this._events!=0&&this._events[t].splice(this._events[t].indexOf(e),1)},trigger:function(t){if(this._events=this._events||{},t in this._events!=0)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},n.mixin=function(t){for(var e=["bind","unbind","trigger"],i=0;i<e.length;i++)t.prototype[e[i]]=n.prototype[e[i]]},void 0!==e&&"exports"in e&&(e.exports=n)},{}]},{},[3])(3)});tt=o,it=S,et=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,t),this.options=e,this.contentsRendered=!1,this.hotspotsRendered=!1,this.el=this.renderEl()}return l(t,[{key:"getId",value:function(){return this.options.id}},{key:"getEl",value:function(){return this.el}},{key:"getPages",value:function(){return this.options.pages}},{key:"renderEl",value:function(){var t,e;return t=document.createElement("div"),e=this.getPages().map(function(t){return t.id}),t.className="verso__page-spread sgn-pp__page-spread",t.setAttribute("data-id",this.getId()),t.setAttribute("data-type","page"),t.setAttribute("data-width",this.options.width),t.setAttribute("data-page-ids",e.join(",")),t.setAttribute("data-max-zoom-scale",this.options.maxZoomScale),t.setAttribute("data-zoomable",!1),t}},{key:"renderContents",value:function(){var t,e,i,n,r,o=this;return e=this.getId(),t=this.getEl(),r=this.getPages(),n=r.length,i=0,r.forEach(function(s,a){var l,u,h;l=s.images.medium,h=document.createElement("div"),u=document.createElement("div"),h.className="sgn-pp__page verso__page",null!=s.id&&h.setAttribute("data-id",s.id),2===n&&(h.className+=0===a?" verso-page--verso":" verso-page--recto"),h.appendChild(u),t.appendChild(h),u.className="sgn-pp-page__loader",u.innerHTML="<span>"+s.label+"</span>",it.util.loadImage(l,function(a,c,d){var p;null==a?(p=++i===n,h.style.backgroundImage="url("+l+")",h.setAttribute("data-width",c),h.setAttribute("data-height",d),h.innerHTML="&nbsp;",p&&t.setAttribute("data-zoomable",!0),o.trigger("pageLoaded",{pageSpreadId:e,page:s}),p&&o.trigger("pagesLoaded",{pageSpreadId:e,pages:r})):u.innerHTML="<span>!</span>"})}),this.contentsRendered=!0,this}},{key:"clearContents",value:function(t,e){return this.el.innerHTML="",this.contentsRendered=!1,this}},{key:"zoomIn",value:function(){var t,e,i=this;t=[].slice.call(this.el.querySelectorAll(".sgn-pp__page")),e=this.getPages(),t.forEach(function(t){var n,r,o;n=t.getAttribute("data-id"),o=it.util.find(e,function(t){return t.id===n}),r=o.images.large,it.util.loadImage(r,function(e){null==e&&"true"===i.el.getAttribute("data-active")&&(t.setAttribute("data-image",t.style.backgroundImage),t.style.backgroundImage="url("+r+")")})})}},{key:"zoomOut",value:function(){[].slice.call(this.el.querySelectorAll(".sgn-pp__page[data-image]")).forEach(function(t){t.style.backgroundImage=t.getAttribute("data-image"),t.removeAttribute("data-image")})}}]),t}(),tt.mixin(et),nt=o,rt=et,st=S,ot=function(){function t(e){a(this,t),this.options=e,this.collection=[],this.ids={}}return l(t,[{key:"get",value:function(t){return this.ids[t]}},{key:"getFrag",value:function(){var t;return t=document.createDocumentFragment(),this.collection.forEach(function(e){return t.appendChild(e.el)}),t}},{key:"update",value:function(){var t,e,i,n,r,o,s,a,l=this,u=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"single";return o=[],e={},s=this.options.pages.slice(),a=this.options.width,n=this.options.maxZoomScale,"single"===u?s.forEach(function(t){return o.push([t])}):(t=s.shift(),i=s.length%2==1?s.pop():null,r=st.util.chunk(s,2),null!=t&&o.push([t]),r.forEach(function(t){return o.push(t.map(function(t){return t}))}),null!=i&&o.push([i])),this.collection=o.map(function(t,i){var r,o;return(o=new rt({width:a,maxZoomScale:n,pages:t,id:r=u+"-"+i})).bind("pageLoaded",function(t){return l.trigger("pageLoaded",t)}),o.bind("pagesLoaded",function(t){return l.trigger("pagesLoaded",t)}),e[r]=o,o}),this.ids=e,this}}]),t}(),nt.mixin(ot),at=o,ct=pt,lt=ot,ht=S,ut=function(){var t=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,t),this.options=this.makeOptions(i,this.defaults),this.pageId=this.getOption("pageId"),this.els={root:e,pages:e.querySelector(".sgn-pp__pages"),verso:e.querySelector(".verso")},this.pageMode=this.getPageMode(),this.pageSpreads=new lt({pages:this.getOption("pages"),maxZoomScale:this.getOption("pageSpreadMaxZoomScale"),width:this.getOption("pageSpreadWidth")}),this.pageSpreads.bind("pageLoaded",this.pageLoaded.bind(this)),this.pageSpreads.bind("pagesLoaded",this.pagesLoaded.bind(this)),this.setColor(this.getOption("color")),this.els.pages.parentNode.insertBefore(this.pageSpreads.update(this.pageMode).getFrag(),this.els.pages),this.verso=this.createVerso(),this.bind("started",this.start.bind(this)),this.bind("destroyed",this.destroy.bind(this))}return l(t,[{key:"start",value:function(){this.getVerso().start(),this.visibilityChangeListener=this.visibilityChange.bind(this),this.resizeListener=ht.util.throttle(this.resize,this.getOption("resizeDelay"),this),this.unloadListener=this.unload.bind(this),document.addEventListener("visibilitychange",this.visibilityChangeListener,!1),window.addEventListener("resize",this.resizeListener,!1),window.addEventListener("beforeunload",this.unloadListener,!1),this.els.root.setAttribute("data-started",""),this.els.root.setAttribute("tabindex","-1"),this.els.root.focus()}},{key:"destroy",value:function(){var t,e,i,n,r;for(n=(r=this.getVerso()).el.querySelectorAll(".sgn-pp__page-spread"),this.els.root.removeAttribute("data-started"),this.els.root.removeAttribute("data-idle"),this.els.root.removeAttribute("data-navigating"),this.els.root.removeAttribute("data-color-brightness"),this.els.root.removeAttribute("data-zoomed-in"),this.els.root.style.backgroundColor="#ffffff",t=0,e=n.length;t<e;t++)(i=n[t]).parentNode.removeChild(i);r.destroy(),document.removeEventListener("visibilitychange",this.visibilityChangeListener,!1),window.removeEventListener("resize",this.resizeListener,!1),window.removeEventListener("beforeunload",this.unloadListener,!1)}},{key:"makeOptions",value:function(t,e){var i,n,r;for(i in n={},t)t[i],n[i]=null!=(r=t[i])?r:e[i];return n}},{key:"getOption",value:function(t){return this.options[t]}},{key:"setColor",value:function(t){this.els.root.setAttribute("data-color-brightness",ht.util.getColorBrightness(t)),this.els.root.style.backgroundColor=t}},{key:"createVerso",value:function(){var t;return(t=new ct(this.els.verso,{pageId:this.pageId})).pageSpreads.forEach(this.overridePageSpreadContentRect.bind(this)),t.bind("beforeNavigation",this.beforeNavigation.bind(this)),t.bind("afterNavigation",this.afterNavigation.bind(this)),t.bind("attemptedNavigation",this.attemptedNavigation.bind(this)),t.bind("clicked",this.clicked.bind(this)),t.bind("doubleClicked",this.doubleClicked.bind(this)),t.bind("pressed",this.pressed.bind(this)),t.bind("contextmenu",this.contextmenu.bind(this)),t.bind("panStart",this.panStart.bind(this)),t.bind("panEnd",this.panEnd.bind(this)),t.bind("zoomedIn",this.zoomedIn.bind(this)),t.bind("zoomedOut",this.zoomedOut.bind(this)),t}},{key:"getVerso",value:function(){return this.verso}},{key:"getContentRect",value:function(t){var e,i,n,r,o,s,a,l,u,h,c;return h={top:0,left:0,right:0,bottom:0,width:0,height:0},s=(a=t.getPageEls())[0],(o=a.length)?(c=this.getVerso().transform.scale,u=s.offsetWidth*o*c,i=(e=l=s.offsetHeight*c)/(r=+s.getAttribute("data-height")/(+s.getAttribute("data-width")*o)),e=(i=Math.min(u,i))*r,n=s.getBoundingClientRect(),h.width=i,h.height=e,h.top=n.top+(l-e)/2,h.left=n.left+(u-i)/2,h.right=h.width+h.left,h.bottom=h.height+h.top,h):h}},{key:"formatProgressLabel",value:function(t){var e,i,n,r,o;return i=(r=null!=(o=null!=t?t.options.pages:void 0)?o:[]).map(function(t){return t.id}),n=r.map(function(t){return t.label}),e=this.getOption("pages").length,i.length>0?n.join("-")+" / "+e:null}},{key:"renderPageSpreads",value:function(){var t=this;return this.getVerso().pageSpreads.forEach(function(e){var i,n;n=e.getVisibility(),null!=(i=t.pageSpreads.get(e.getId()))&&("visible"===n&&!1===i.contentsRendered&&setTimeout(i.renderContents.bind(i),0),"gone"===n&&!0===i.contentsRendered&&setTimeout(i.clearContents.bind(i),0))}),this}},{key:"findPage",value:function(t){return ht.util.find(this.getOption("pages"),function(e){return e.id===t})}},{key:"pageLoaded",value:function(t){this.trigger("pageLoaded",t)}},{key:"pagesLoaded",value:function(t){this.trigger("pagesLoaded",t)}},{key:"beforeNavigation",value:function(t){var e,i,n,r,o,s,a,l;r=t.newPosition,l=(a=this.getVerso()).getPageSpreadFromPosition(r),i=this.pageSpreads.get(l.getId()),n=a.getPageSpreadCount(),e=a.pageSpreadEls[t.newPosition],o=r/(n-1)*100,s=this.formatProgressLabel(i),this.els.root.setAttribute("data-navigating",!0),this.renderPageSpreads(),this.resetIdleTimer(),this.startIdleTimer(),this.trigger("beforeNavigation",{verso:t,pageSpread:i,newSpreadEl:e,progress:o,progressLabel:s,pageSpreadCount:n,newPositionIsEnd:t.newPosition+1===n})}},{key:"afterNavigation",value:function(t){var e,i,n,r,o,s;r=t.newPosition,s=(o=this.getVerso()).getPageSpreadFromPosition(r),i=this.pageSpreads.get(s.getId()),n=o.getPageSpreadCount(),e=o.pageSpreadEls[t.newPosition],this.els.root.setAttribute("data-navigating",!1),this.trigger("afterNavigation",{verso:t,pageSpread:i,pageSpreadCount:n,newSpreadEl:e,newPositionIsEnd:t.newPosition+1===n})}},{key:"attemptedNavigation",value:function(t){this.trigger("attemptedNavigation",{verso:t})}},{key:"clicked",value:function(t){var e,i;t.isInsideContent&&(i=t.pageEl.getAttribute("data-id"),e=this.findPage(i),this.trigger("clicked",{verso:t,page:e}))}},{key:"doubleClicked",value:function(t){var e,i;t.isInsideContent&&(i=t.pageEl.getAttribute("data-id"),e=this.findPage(i),this.trigger("doubleClicked",{verso:t,page:e}))}},{key:"pressed",value:function(t){var e,i;t.isInsideContent&&(i=t.pageEl.getAttribute("data-id"),e=this.findPage(i),this.trigger("pressed",{verso:t,page:e}))}},{key:"contextmenu",value:function(t){var e,i;t.isInsideContent&&(i=t.pageEl.getAttribute("data-id"),e=this.findPage(i),this.trigger("contextmenu",{verso:t,page:e}))}},{key:"panStart",value:function(){this.resetIdleTimer(),this.trigger("panStart",{scale:this.getVerso().transform.scale})}},{key:"panEnd",value:function(){this.startIdleTimer(),this.trigger("panEnd")}},{key:"zoomedIn",value:function(t){var e,i,n;i=t.position,n=this.getVerso().getPageSpreadFromPosition(i),null!=(e=this.pageSpreads.get(n.getId()))&&e.zoomIn(),this.els.root.setAttribute("data-zoomed-in",!0),this.trigger("zoomedIn",{verso:t,pageSpread:e})}},{key:"zoomedOut",value:function(t){var e,i,n;i=t.position,n=this.getVerso().getPageSpreadFromPosition(i),null!=(e=this.pageSpreads.get(n.getId()))&&e.zoomOut(),this.els.root.setAttribute("data-zoomed-in",!1),this.trigger("zoomedOut",{verso:t,pageSpread:e})}},{key:"getPageMode",value:function(){var t,e;return null==(t=this.getOption("pageMode"))&&(e=this.els.root.offsetWidth,t=this.els.root.offsetHeight/e<.8?"double":"single"),t}},{key:"resetIdleTimer",value:function(){return clearTimeout(this.idleTimeout),this.els.root.setAttribute("data-idle",!1),this}},{key:"startIdleTimer",value:function(){var t=this;return this.idleTimeout=setTimeout(function(){t.els.root.setAttribute("data-idle",!0)},this.getOption("idleDelay")),this}},{key:"switchPageMode",value:function(t){var e,i,n,r,o,s;if(this.pageMode===t)return this;for(n=(s=this.getVerso()).getPageSpreadFromPosition(s.getPosition()).getPageIds(),o=this.getVerso().el.querySelectorAll(".sgn-pp__page-spread"),this.pageMode=t,this.pageSpreads.update(this.pageMode),e=0,i=o.length;e<i;e++)(r=o[e]).parentNode.removeChild(r);return this.els.pages.parentNode.insertBefore(this.pageSpreads.getFrag(),this.els.pages),s.refresh(),s.navigateTo(s.getPageSpreadPositionFromPageId(n[0]),{duration:0}),s.pageSpreads.forEach(this.overridePageSpreadContentRect.bind(this)),this}},{key:"overridePageSpreadContentRect",value:function(t){var e=this;if("page"===t.getType())return t.getContentRect=function(){return e.getContentRect(t)}}},{key:"visibilityChange",value:function(){var t,e;e=this.getVerso().getPageSpreadFromPosition(this.getVerso().getPosition()),t=!0===document.hidden?"disappeared":"appeared",this.trigger(t,{pageSpread:this.pageSpreads.get(e.id)})}},{key:"resize",value:function(){var t;t=this.getPageMode(),null==this.getOption("pageMode")&&t!==this.pageMode?this.switchPageMode(t):this.trigger("resized")}},{key:"unload",value:function(){this.trigger("disappeared")}}]),t}();return t.prototype.defaults={pages:[],pageSpreadWidth:100,pageSpreadMaxZoomScale:2.3,idleDelay:1e3,resizeDelay:400,color:"#ffffff"},t}.call(t),at.mixin(ut);var ft,gt,vt,yt=ut;ft=o,gt=p,vt=function(){function t(){a(this,t),this.currentPageSpreadId=null,this.pageSpreadsLoaded={},this.cache={},this.bind("hotspotsReceived",this.hotspotsReceived.bind(this)),this.bind("afterNavigation",this.afterNavigation.bind(this)),this.bind("pagesLoaded",this.pagesLoaded.bind(this)),this.bind("resized",this.resized.bind(this))}return l(t,[{key:"renderHotspots",value:function(t){var e,i,n,r,o,s,a,l,u,h,c,d,p;for(r=document.createDocumentFragment(),i=t.versoPageSpread.getContentRect(),a=(c=t.pageSpread.getEl()).querySelectorAll(".sgn-pp__hotspot"),e=c.getBoundingClientRect(),l=0,h=a.length;l<h;l++)(s=a[l]).parentNode.removeChild(s);for(u in p=t.hotspots)o=p[u],d=this.getPosition(t.pages,t.ratio,o),n=this.renderHotspot(o,d,i,e),r.appendChild(n);return c.appendChild(r),this}},{key:"renderHotspot",value:function(t,e,i,n){var r,o,s,a,l,u;return r=document.createElement("div"),l=Math.round(i.height/100*e.top),s=Math.round(i.width/100*e.left),u=Math.round(i.width/100*e.width),o=Math.round(i.height/100*e.height),l+=Math.round(i.top),s+=Math.round(i.left),l-=n.top,s-=n.left,r.className="sgn-pp__hotspot verso__overlay",null!=t.id&&r.setAttribute("data-id",t.id),null!=t.type&&r.setAttribute("data-type",t.type),r.innerHTML=gt.render(null!=(a=t.template)?a:"",t),r.style.top=l+"px",r.style.left=s+"px",r.style.width=u+"px",r.style.height=o+"px",r}},{key:"getPosition",value:function(t,e,i){var n,r,o,s,a,l;for(a in o=null,s=null,n=null,r=null,l=t.map(function(t){return t.pageNumber}),i.locations)-1!==l.indexOf(+a)&&i.locations[a].forEach(function(e){var i,u;if(i=e[0],u=e[1],t[1]&&l[1]===+a&&(i+=1),i/=t.length,null==o&&(o=n=i,s=r=u),i<o&&(o=i),i>n&&(n=i),u<s&&(s=u),u>r)return r=u});return{top:s/e*100,left:100*o,width:100*(n-o),height:(r-s)/e*100}}},{key:"requestHotspots",value:function(t,e){this.trigger("hotspotsRequested",{id:t,pages:e})}},{key:"hotspotsReceived",value:function(t){var e;e=t.pageSpread.getId(),this.setCache(e,t),this.renderHotspots(t)}},{key:"getCache",value:function(t){return this.cache[t]}},{key:"setCache",value:function(t,e){return this.cache[t]=e,this}},{key:"afterNavigation",value:function(t){var e;null!=t.pageSpread&&(e=t.pageSpread.getId(),this.currentPageSpreadId=e,this.pageSpreadsLoaded[e]&&this.requestHotspots(e,t.pageSpread.getPages()))}},{key:"pagesLoaded",value:function(t){this.pageSpreadsLoaded[t.pageSpreadId]=!0,this.currentPageSpreadId===t.pageSpreadId&&this.requestHotspots(t.pageSpreadId,t.pages)}},{key:"resized",value:function(t){var e;null!=(e=this.getCache(this.currentPageSpreadId))&&this.renderHotspots(e)}}]),t}(),ft.mixin(vt);var mt,bt,_t,wt,kt=vt,St={ESC:27,ARROW_RIGHT:39,ARROW_LEFT:37,SPACE:32,NUMBER_ONE:49};mt=o,_t=S,wt=St,bt=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,t),this.options=i,this.els={root:e,progress:e.querySelector(".sgn-pp__progress"),progressBar:e.querySelector(".sgn-pp-progress__bar"),progressLabel:e.querySelector(".sgn-pp__progress-label"),prevControl:e.querySelector(".sgn-pp__control[data-direction=prev]"),nextControl:e.querySelector(".sgn-pp__control[data-direction=next]"),close:e.querySelector(".sgn-pp--close")},this.keyDownListener=_t.util.throttle(this.keyDown,150,this),!0===this.options.keyboard&&this.els.root.addEventListener("keydown",this.keyDownListener,!1),null!=this.els.prevControl&&this.els.prevControl.addEventListener("click",this.prevClicked.bind(this),!1),null!=this.els.nextControl&&this.els.nextControl.addEventListener("click",this.nextClicked.bind(this),!1),null!=this.els.close&&this.els.close.addEventListener("click",this.closeClicked.bind(this),!1),this.bind("beforeNavigation",this.beforeNavigation.bind(this))}return l(t,[{key:"destroy",value:function(){this.els.root.removeEventListener("keydown",this.keyDownListener)}},{key:"beforeNavigation",value:function(t){var e;e="string"==typeof t.progressLabel&&t.progressLabel.length>0,null!=this.els.progress&&null!=this.els.progressBar&&(this.els.progressBar.style.width=t.progress+"%",!0===e?this.els.progress.classList.remove("sgn-pp--hidden"):this.els.progress.classList.add("sgn-pp--hidden")),null!=this.els.progressLabel&&(!0===e?(this.els.progressLabel.textContent=t.progressLabel,this.els.progressLabel.classList.remove("sgn-pp--hidden")):this.els.progressLabel.classList.add("sgn-pp--hidden")),null!=this.els.prevControl&&(0===t.verso.newPosition?this.els.prevControl.classList.add("sgn-pp--hidden"):this.els.prevControl.classList.remove("sgn-pp--hidden")),null!=this.els.nextControl&&(t.verso.newPosition===t.pageSpreadCount-1?this.els.nextControl.classList.add("sgn-pp--hidden"):this.els.nextControl.classList.remove("sgn-pp--hidden"))}},{key:"prevClicked",value:function(t){t.preventDefault(),this.trigger("prev")}},{key:"nextClicked",value:function(t){t.preventDefault(),this.trigger("next")}},{key:"closeClicked",value:function(t){t.preventDefault(),this.trigger("close")}},{key:"keyDown",value:function(t){var e;e=t.keyCode,wt.ARROW_LEFT===e?this.trigger("prev",{duration:0}):wt.ARROW_RIGHT===e||wt.SPACE===e?this.trigger("next",{duration:0}):wt.NUMBER_ONE===e&&this.trigger("first",{duration:0})}}]),t}(),mt.mixin(bt);var xt,Et,Tt,Pt,Ct,Ot,It,At,Lt,Nt,Dt=bt;xt=o,Et=function(){function t(){a(this,t),this.doubleClicked=this.doubleClicked.bind(this),this.hidden=!0,this.pageSpread=null,this.bind("appeared",this.appeared.bind(this)),this.bind("disappeared",this.disappeared.bind(this)),this.bind("beforeNavigation",this.beforeNavigation.bind(this)),this.bind("afterNavigation",this.afterNavigation.bind(this)),this.bind("attemptedNavigation",this.attemptedNavigation.bind(this)),this.bind("clicked",this.clicked.bind(this)),this.bind("doubleClicked",this.doubleClicked.bind(this)),this.bind("pressed",this.pressed.bind(this)),this.bind("panStart",this.panStart.bind(this)),this.bind("zoomedIn",this.zoomedIn.bind(this)),this.bind("zoomedOut",this.zoomedOut.bind(this)),this.bind("destroyed",this.destroy.bind(this))}return l(t,[{key:"destroy",value:function(){this.pageSpreadDisappeared()}},{key:"trackEvent",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.trigger("trackEvent",{type:t,properties:e})}},{key:"trackOpened",value:function(t){return this.trackEvent("paged-publication-opened",t),this}},{key:"trackPageClicked",value:function(t){return this.trackEvent("paged-publication-page-clicked",t),this}},{key:"trackPageDoubleClicked",value:function(t){return this.trackEvent("paged-publication-page-double-clicked",t),this}},{key:"trackPageLongPressed",value:function(t){return this.trackEvent("paged-publication-page-long-pressed",t),this}},{key:"trackPageHotspotsClicked",value:function(t){return this.trackEvent("paged-publication-page-hotspots-clicked",t),this}},{key:"trackPageSpreadAppeared",value:function(t){return this.trackEvent("paged-publication-page-spread-appeared",t),this}},{key:"trackPageSpreadDisappeared",value:function(t){return this.trackEvent("paged-publication-page-spread-disappeared",t),this}},{key:"trackPageSpreadZoomedIn",value:function(t){return this.trackEvent("paged-publication-page-spread-zoomed-in",t),this}},{key:"trackPageSpreadZoomedOut",value:function(t){return this.trackEvent("paged-publication-page-spread-zoomed-out",t),this}},{key:"appeared",value:function(t){this.pageSpreadAppeared(t.pageSpread)}},{key:"disappeared",value:function(){this.pageSpreadDisappeared()}},{key:"beforeNavigation",value:function(){this.pageSpreadDisappeared()}},{key:"afterNavigation",value:function(t){this.pageSpreadAppeared(t.pageSpread)}},{key:"attemptedNavigation",value:function(t){this.pageSpreadAppeared(t.pageSpread)}},{key:"clicked",value:function(t){var e;null!=t.page&&(e={pageNumber:t.page.pageNumber,x:t.verso.pageX,y:t.verso.pageY},this.trackPageClicked({pagedPublicationPage:e}),t.verso.overlayEls.length>0&&this.trackPageHotspotsClicked({pagedPublicationPage:e}))}},{key:"doubleClicked",value:function(t){null!=t.page&&this.trackPageDoubleClicked({pagedPublicationPage:{pageNumber:t.page.pageNumber,x:t.verso.pageX,y:t.verso.pageY}})}},{key:"pressed",value:function(t){null!=t.page&&this.trackPageLongPressed({pagedPublicationPage:{pageNumber:t.page.pageNumber,x:t.verso.pageX,y:t.verso.pageY}})}},{key:"panStart",value:function(t){1===t.scale&&this.pageSpreadDisappeared()}},{key:"zoomedIn",value:function(t){null!=t.pageSpread&&this.trackPageSpreadZoomedIn({pagedPublicationPageSpread:{pageNumbers:t.pageSpread.getPages().map(function(t){return t.pageNumber})}})}},{key:"zoomedOut",value:function(t){null!=t.pageSpread&&this.trackPageSpreadZoomedOut({pagedPublicationPageSpread:{pageNumbers:t.pageSpread.getPages().map(function(t){return t.pageNumber})}})}},{key:"pageSpreadAppeared",value:function(t){null!=t&&!0===this.hidden&&(this.pageSpread=t,this.trackPageSpreadAppeared({pagedPublicationPageSpread:{pageNumbers:t.getPages().map(function(t){return t.pageNumber})}}),this.hidden=!1)}},{key:"pageSpreadDisappeared",value:function(){null!=this.pageSpread&&!1===this.hidden&&(this.trackPageSpreadDisappeared({pagedPublicationPageSpread:{pageNumbers:this.pageSpread.getPages().map(function(t){return t.pageNumber})}}),this.hidden=!0,this.pageSpread=null)}}]),t}(),xt.mixin(Et),It=o,At=S,Pt=yt,Ot=kt,Tt=Dt,Ct=Et,Lt=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,t),this.el=e,this.options=i,this._core=new Pt(this.el,{id:this.options.id,pages:this.options.pages,pageSpreadWidth:this.options.pageSpreadWidth,pageSpreadMaxZoomScale:this.options.pageSpreadMaxZoomScale,pageId:this.options.pageId,idleDelay:this.options.idleDelay,resizeDelay:this.options.resizeDelay,color:this.options.color}),this._hotspots=new Ot,this._controls=new Tt(this.el,{keyboard:this.options.keyboard}),this._eventTracking=new Ct,this.viewSession=At.util.uuid(),this.hotspots=null,this.hotspotQueue=[],this.popover=null,this._setupEventListeners()}return l(t,[{key:"start",value:function(){return this._eventTracking.trackOpened(),this._core.trigger("started"),this}},{key:"destroy",value:function(){return this._core.trigger("destroyed"),this._hotspots.trigger("destroyed"),this._controls.trigger("destroyed"),this._eventTracking.trigger("destroyed"),this.trigger("destroyed"),this}},{key:"navigateTo",value:function(t,e){return this.navigateToIndex(t,e),this}},{key:"navigateToIndex",value:function(t,e){return this._core.getVerso().navigateTo(t,e),this}},{key:"navigateToPageId",value:function(t,e){var i;return i=this._core.getVerso().getPageSpreadPositionFromPageId(t),this._core.getVerso().navigateTo(i,e)}},{key:"first",value:function(t){return this._core.getVerso().first(t),this}},{key:"prev",value:function(t){return this._core.getVerso().prev(t),this}},{key:"next",value:function(t){return this._core.getVerso().next(t),this}},{key:"last",value:function(t){return this._core.getVerso().last(t),this}},{key:"_trackEvent",value:function(t){var e,i,n,r,o,s;for(i in o=t.type,"legacy",n={pagedPublication:{id:["legacy",this.options.id],ownedBy:["legacy",this.options.ownedBy]}},e=this.options.eventTracker,r=t.properties)s=r[i],n[i]=s;null!=e&&e.trackEvent(o,n)}},{key:"_setupEventListeners",value:function(){var t=this;this._eventTracking.bind("trackEvent",function(e){t._trackEvent(e)}),this._controls.bind("prev",function(e){t.prev(e)}),this._controls.bind("next",function(e){t.next(e)}),this._controls.bind("first",function(e){t.first(e)}),this._controls.bind("last",function(e){t.last(e)}),this._controls.bind("close",function(e){t.destroy(e)}),this._hotspots.bind("hotspotsRequested",function(e){t.trigger("hotspotsRequested",e)}),this._core.bind("appeared",function(e){t._eventTracking.trigger("appeared",e),t.trigger("appeared",e)}),this._core.bind("disappeared",function(e){t._eventTracking.trigger("disappeared",e),t.trigger("disappeared",e)}),this._core.bind("beforeNavigation",function(e){t._eventTracking.trigger("beforeNavigation",e),t._controls.trigger("beforeNavigation",e),t.trigger("beforeNavigation",e)}),this._core.bind("afterNavigation",function(e){t._eventTracking.trigger("afterNavigation",e),t._hotspots.trigger("afterNavigation",e),t.trigger("afterNavigation",e)}),this._core.bind("attemptedNavigation",function(e){t._eventTracking.trigger("attemptedNavigation",e),t.trigger("attemptedNavigation",e)}),this._core.bind("clicked",function(e){t._eventTracking.trigger("clicked",e),t.trigger("clicked",e)}),this._core.bind("doubleClicked",function(e){t._eventTracking.trigger("doubleClicked",e),t.trigger("doubleClicked",e)}),this._core.bind("contextmenu",function(e){t.trigger("contextmenu",e)}),this._core.bind("pressed",function(e){t._eventTracking.trigger("pressed",e),t.trigger("pressed",e)}),this._core.bind("panStart",function(e){t._eventTracking.trigger("panStart",e),t.trigger("panStart",e)}),this._core.bind("zoomedIn",function(e){t._eventTracking.trigger("zoomedIn",e),t.trigger("zoomedIn",e)}),this._core.bind("zoomedOut",function(e){t._eventTracking.trigger("zoomedOut",e),t.trigger("zoomedOut",e)}),this._core.bind("pageLoaded",function(e){t._eventTracking.trigger("pageLoaded",e),t.trigger("pageLoaded",e)}),this._core.bind("pagesLoaded",function(e){t._hotspots.trigger("pagesLoaded",e),t.trigger("pagesLoaded",e)}),this._core.bind("resized",function(e){t._hotspots.trigger("resized"),t.trigger("resized",e)}),this.bind("hotspotsRequested",this.hotspotsRequested.bind(this)),this.bind("beforeNavigation",this.beforeNavigation.bind(this)),this.bind("clicked",this.clicked.bind(this)),this.bind("contextmenu",this.contextmenu.bind(this)),this.bind("pressed",this.pressed.bind(this))}},{key:"pickHotspot",value:function(t,e){var i,n=this;null!=this.hotspots&&(null!=this.popover&&(this.popover.destroy(),this.popover=null),1===(i=t.verso.overlayEls.map(function(t){return n.hotspots[t.getAttribute("data-id")]})).length?e(i[0]):i.length>1&&(this.popover=At.CoreUIKit.singleChoicePopover({el:this.el,header:At.translations.t("paged_publication.hotspot_picker.header"),x:t.verso.x,y:t.verso.y,items:i.filter(function(t){return"offer"===t.type}).map(function(t){return{id:t.id,title:t.offer.heading,subtitle:t.offer.pricing.currency+""+t.offer.pricing.price}})},e)))}},{key:"processHotspotQueue",value:function(){var t=this;null!=this.hotspots&&(this.hotspotQueue=this.hotspotQueue.filter(function(e){var i,n,r,o,s,a,l,u,h;for(o in n={},h=At.util.find(t._core.getVerso().pageSpreads,function(t){return t.getId()===e.id}),l=t.hotspots)if(i=l[o],null==n[o])for(r=0,s=(u=e.pages).length;r<s;r++)if(a=u[r],null!=i.locations[a.pageNumber]){n[o]={type:i.type,id:i.id,locations:i.locations};break}return t._hotspots.trigger("hotspotsReceived",{pageSpread:t._core.pageSpreads.get(e.id),versoPageSpread:h,ratio:t.options.hotspotRatio,pages:e.pages,hotspots:n}),!1}))}},{key:"hotspotsRequested",value:function(t){this.hotspotQueue.push(t),this.processHotspotQueue()}},{key:"applyHotspots",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.hotspots=t,this.processHotspotQueue()}},{key:"beforeNavigation",value:function(){null!=this.popover&&this.popover.destroy()}},{key:"clicked",value:function(t){var e=this;this.pickHotspot(t,function(t){e.trigger("hotspotClicked",t)})}},{key:"contextmenu",value:function(t){var e=this;this.pickHotspot(t,function(t){e.trigger("hotspotContextmenu",t)})}},{key:"pressed",value:function(t){var e=this;this.pickHotspot(t,function(t){e.trigger("hotspotPressed",t)})}}]),t}(),It.mixin(Lt),Nt=k;var Rt,zt,Mt,jt={Viewer:Lt,Bootstrapper:function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,t),this.options=e}return l(t,[{key:"createViewer",value:function(t){return new Nt.PagedPublicationKit.Viewer(this.options.el,{id:this.options.id,ownedBy:t.details.dealer_id,color:"#"+t.details.branding.pageflip.color,hotspotRatio:t.details.dimensions.height,keyboard:!0,pageId:this.options.pageId,eventTracker:this.options.eventTracker,pages:this.transformPages(t.pages)})}},{key:"transformPages",value:function(t){return t.map(function(t,e){var i;return{id:"page"+(i=e+1),label:i+"",pageNumber:i,images:{medium:t.view,large:t.zoom}}})}},{key:"applyHotspots",value:function(t,e){var i;i={},e.forEach(function(t){return i[t.id]=t}),t.applyHotspots(i)}},{key:"fetch",value:function(t){Nt.util.async.parallel([this.fetchDetails.bind(this),this.fetchPages.bind(this)],function(e){var i;null!=(i={details:e[0][1],pages:e[1][1]}).details&&null!=i.pages?t(null,i):t(new Error)})}},{key:"fetchDetails",value:function(t){Nt.CoreKit.request({url:"/v2/catalogs/"+this.options.id},t)}},{key:"fetchPages",value:function(t){Nt.CoreKit.request({url:"/v2/catalogs/"+this.options.id+"/pages"},t)}},{key:"fetchHotspots",value:function(t){Nt.CoreKit.request({url:"/v2/catalogs/"+this.options.id+"/hotspots"},t)}}]),t}()},Ut=i(function(t,i){t.exports=function t(i,n,r){function o(a,l){if(!n[a]){if(!i[a]){var u=e;if(!l&&u)return u(a,!0);if(s)return s(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var c=n[a]={exports:{}};i[a][0].call(c.exports,function(t){var e=i[a][1][t];return o(e||t)},c,c.exports,t,i,n,r)}return n[a].exports}for(var s=e,a=0;a<r.length;a++)o(r[a]);return o}({1:[function(t,e,i){var n,r,o,s,a,l,u,h,c,d,p,f,g=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();l=t("vanilla-lazyload"),h=t("microevent"),t("./utils"),f=t("./views/view"),o=t("./views/frag"),s=t("./views/image"),c=t("./views/text"),d=t("./views/video-embed"),p=t("./views/video"),u=t("./views/linear-layout"),n=t("./views/absolute-layout"),r=t("./views/flex-layout"),a=function(){function t(e){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.containerEl=e,this.options=i,this.el=document.createElement("div")}return g(t,[{key:"start",value:function(){var t,e;return e=this.options.incito||{},t=document.createDocumentFragment(),this.loadFonts(e.font_assets),this.applyTheme(e.theme),this.render(t,e.root_view),this.el.className="incito",null!=e.locale&&this.el.setAttribute("lang",e.locale),!0===e.debug&&this.el.setAttribute("data-debug",!0),this.el.appendChild(t),this.containerEl.appendChild(this.el),this.lazyload=new l({elements_selector:".incito--lazyload",threshold:800,callback_enter:function(t){"video"===t.nodeName.toLowerCase()&&t.getAttribute("data-autoplay")&&t.play()}}),this}},{key:"destroy",value:function(){this.containerEl.removeChild(this.el),null!=this.lazyload&&this.lazyload.destroy(),this.trigger("destroyed")}},{key:"render",value:function(t){var e,i,a,l,h,g=this,v=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return e=null,h=v.view_name,e=null!=(i={View:f,FragView:o,ImageView:s,TextView:c,VideoEmbedView:d,VideoView:p,LinearLayout:u,AbsoluteLayout:n,FlexLayout:r}[h])?i:f,l=new e(v),a=l.trigger,l.trigger=function(){for(var t=arguments.length,e=Array(t),i=0;i<t;i++)e[i]=arguments[i];a.apply(l,e),g.trigger.apply(g,e)},l.render(),Array.isArray(v.child_views)&&v.child_views.forEach(function(t){var e;null!=(e=g.render(l.el,t))&&l.el.appendChild(e)}),t.appendChild(l.el),l.el}},{key:"applyTheme",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};null!=t.font_family&&(this.el.style.fontFamily=t.font_family.join(", ")),null!=t.background_color&&(this.el.style.backgroundColor=t.background_color),null!=t.line_spacing_multiplier&&(this.el.style.lineHeight=t.line_spacing_multiplier)}},{key:"loadFonts",value:function(){var t,e,i,n,r,o,s,a,l=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if("FontFace"in window)for(e in l)a=l[e],s=a.src.map(function(t){return"url("+t[1]+")"}).join(", "),t=new FontFace(e,s,{style:null!=(i=a.style)?i:"normal",weight:null!=(n=a.weight)?n:"normal"}),document.fonts.add(t),t.load();else{for(e in r=document.createElement("style"),l)a=l[e],s=a.src.map(function(t){return"url('"+t[1]+"') format('"+t[0]+"')"}).join(", "),o="@font-face {\n    font-family: '"+e+"';\n    src: "+s+";\n}",r.appendChild(document.createTextNode(o));document.head.appendChild(r)}}}]),t}(),h.mixin(a),e.exports=a},{"./utils":2,"./views/absolute-layout":3,"./views/flex-layout":4,"./views/frag":5,"./views/image":6,"./views/linear-layout":7,"./views/text":8,"./views/video":10,"./views/video-embed":9,"./views/view":11,microevent:12,"vanilla-lazyload":13}],2:[function(t,e,i){var n;n={formatUnit:function(t){return"number"==typeof t?t+"px":"string"==typeof t?t.replace("dp","px"):0},isDefinedStr:function(t){return"string"==typeof t&&t.length>0},escapeHTML:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}},e.exports=n},{}],3:[function(t,e,i){var n,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();n=t("./view"),e.exports=function(){var t=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"render",value:function(){return this}}]),e}(n);return t.prototype.className="incito__absolute-layout-view",t}.call(void 0)},{"./view":11}],4:[function(t,e,i){var n,r,o,s,a,l,u=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),h=[].indexOf;n=t("./view"),l=t("../utils"),o=["stretch","center","flex-start","flex-end","baseline"],r=["stretch","center","flex-start","flex-end","space-between","space-around","initial","inherit"],a=["flex-start","flex-end","center","space-between","space-around"],s=["row","column"],e.exports=function(){var t=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),u(e,[{key:"render",value:function(){var t,e,i,n;return t=this.attrs.layout_flex_align_items,h.call(o,t)>=0&&(this.el.style.alignItems=this.attrs.layout_flex_align_items,this.el.style.msAlignItems=this.attrs.layout_flex_align_items),e=this.attrs.layout_flex_align_content,h.call(r,e)>=0&&(this.el.style.alignContent=this.attrs.layout_flex_align_content,this.el.style.msAlignContent=this.attrs.layout_flex_align_content),i=this.attrs.layout_flex_justify_content,h.call(a,i)>=0&&(this.el.style.justifyContent=this.attrs.layout_flex_justify_content,this.el.style.msFlexPack=this.attrs.layout_flex_justify_content),n=this.attrs.layout_flex_direction,h.call(s,n)>=0&&(this.el.style.flexDirection=this.attrs.layout_flex_direction,this.el.style.msFlexDirection=this.attrs.layout_flex_direction),"number"==typeof this.attrs.layout_flex_shrink&&(this.el.style.flexShrink=this.attrs.layout_flex_shrink,this.el.style.msFlexShrink=this.attrs.layout_flex_shrink),"number"==typeof this.attrs.layout_flex_grow&&(this.el.style.flexGrow=this.attrs.layout_flex_grow,this.el.style.msFlexGrow=this.attrs.layout_flex_grow),null!=this.attrs.layout_flex_basis&&(this.el.style.flexBasis=l.parseUnit(this.attrs.layout_flex_basis),this.el.style.msFlexBasis=l.parseUnit(this.attrs.layout_flex_basis)),this}}]),e}(n);return t.prototype.className="incito__flex-layout-view",t}.call(void 0)},{"../utils":2,"./view":11}],5:[function(t,e,i){var n=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();e.exports=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return n(t,[{key:"render",value:function(){return this.el=document.createDocumentFragment(),this}}]),t}()},{}],6:[function(t,e,i){var n,r,o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();n=t("./view"),r=t("../utils"),e.exports=function(){var t=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"render",value:function(){return r.isDefinedStr(this.attrs.src)&&this.el.setAttribute("data-src",this.attrs.src),r.isDefinedStr(this.attrs.label)?this.el.setAttribute("alt",this.attrs.label):this.el.setAttribute("alt",""),this}}]),e}(n);return t.prototype.tagName="img",t.prototype.className="incito__image-view incito--lazyload",t}.call(void 0)},{"../utils":2,"./view":11}],7:[function(t,e,i){var n,r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();n=t("./view"),e.exports=function(){var t=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),r(e,[{key:"render",value:function(){return this}}]),e}(n);return t.prototype.className="incito__linear-layout-view",t}.call(void 0)},{"./view":11}],8:[function(t,e,i){var n,r,o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=[].indexOf;n=t("./view"),r=t("../utils"),e.exports=function(){var t=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"render",value:function(){var t,e,i,n,o;return o=(this.attrs.text_style||"").split("|"),i=this.attrs.text,Array.isArray(this.attrs.spans)&&this.attrs.spans.length>0?(t=this.parseSpans(i,this.attrs.spans),i=(i=t.map(function(t){var e;return e=r.escapeHTML(t.text||""),null!=t.span&&"link"===t.span.name&&null!=t.span.url?'<a href="'+encodeURI(t.span.url)+'" rel="external" target="_blank">'+e+"</a>":null!=t.span&&null!=t.span.name?'<span data-name="'+t.span.name+'">'+e+"</span>":e})).join("")):i=r.escapeHTML(i),this.attrs.text_prevent_widow?this.el.innerHTML=i.replace(/\&nbsp;([^\s]+)$/," $1").replace(/\s([^\s]+)\s*$/,"&nbsp;$1"):this.el.innerHTML=i,Array.isArray(this.attrs.font_family)&&this.attrs.font_family.length>0&&(this.el.style.fontFamily=this.attrs.font_family.join(", ")),null!=this.attrs.text_size&&(this.el.style.fontSize=this.attrs.text_size+"px"),null!=this.attrs.line_spacing_multiplier&&(this.el.style.lineHeight=this.attrs.line_spacing_multiplier),null!=this.attrs.text_color&&(this.el.style.color=this.attrs.text_color),s.call(o,"bold")>=0&&(this.el.style.fontWeight="bold"),s.call(o,"italic")>=0&&(this.el.style.fontStyle="italic"),null!=(n=this.getTextShadow())&&(this.el.style.textShadow=n.dx+"px "+n.dy+"px "+n.radius+"px "+n.color),"left"===this.attrs.text_alignment?this.el.style.textAlign="left":"center"===this.attrs.text_alignment?this.el.style.textAlign="center":"right"===this.attrs.text_alignment&&(this.el.style.textAlign="right"),"condensed"!==(e=this.attrs.font_stretch)&&"normal"!==e&&"expanded"!==e||(this.el.style.fontStretch=this.attrs.font_stretch),!0===this.attrs.single_line&&this.el.setAttribute("data-single-line",!0),!0===this.attrs.text_all_caps&&(this.el.style.textTransform="uppercase"),this}},{key:"parseSpans",value:function(t){var e,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return e=[],0===i.length?e.push({text:t}):i[0].start>0&&e.push({text:t.slice(0,i[0].start)}),i.forEach(function(n,r){var o,s;s=n.start,o=n.end,e.push({text:t.slice(s,o),span:n}),r===i.length-1?o<t.length&&e.push({text:t.slice(o,t.length)}):o<i[r+1].start&&e.push({text:t.slice(o,i[r+1].start)})}),e}},{key:"getTextShadow",value:function(){var t,e,i,n;if(r.isDefinedStr(this.attrs.text_shadow_color))return e="number"==typeof this.attrs.text_shadow_dx?this.attrs.text_shadow_dx:0,i="number"==typeof this.attrs.text_shadow_dy?this.attrs.text_shadow_dy:0,n="number"==typeof this.attrs.text_shadow_radius?this.attrs.text_shadow_radius:0,t=this.attrs.text_shadow_color,{dx:e,dy:i,radius:n,color:t}}}]),e}(n);return t.prototype.tagName="p",t.prototype.className="incito__text-view",t}.call(void 0)},{"../utils":2,"./view":11}],9:[function(t,e,i){var n,r,o,s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=[].indexOf;n=t("./view"),o=t("../utils"),r=["www.youtube.com","www.vimeo.com","video.twentythree.net"],e.exports=function(){var t=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),s(e,[{key:"render",value:function(){var t,e;return t=document.createElement("a"),o.isDefinedStr(this.attrs.src)&&(t.setAttribute("href",this.attrs.src),e=t.hostname,a.call(r,e)>=0&&this.el.setAttribute("data-src",this.attrs.src)),this}}]),e}(n);return t.prototype.className="incito__video-embed-view incito--lazyload",t.prototype.tagName="iframe",t}.call(void 0)},{"../utils":2,"./view":11}],10:[function(t,e,i){var n,r,o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();n=t("./view"),r=t("../utils"),e.exports=function(){var t=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),o(e,[{key:"render",value:function(){var t;return!0===this.attrs.autoplay&&this.el.setAttribute("data-autoplay","true"),!0===this.attrs.loop&&this.el.setAttribute("loop",""),!0===this.attrs.controls&&this.el.setAttribute("controls",""),this.el.setAttribute("muted","true"),this.el.setAttribute("preload","metadata"),this.el.setAttribute("playsinline",""),r.isDefinedStr(this.attrs.src)&&((t=document.createElement("source")).setAttribute("src",this.attrs.src),t.setAttribute("type",this.attrs.mime),this.el.appendChild(t)),this}}]),e}(n);return t.prototype.className="incito__video-view incito--lazyload",t.prototype.tagName="video",t}.call(void 0)},{"../utils":2,"./view":11}],11:[function(t,e,i){var n,r,o,s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),a=[].indexOf;n=t("microevent"),o=t("../utils"),e.exports=r=function(){var t=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.attrs=e,this.el=this.createElement(),this.setAttributes(),this.initialize()}return s(t,[{key:"initialize",value:function(){}},{key:"render",value:function(){return this}},{key:"createElement",value:function(){var t;return(t=document.createElement(this.tagName)).className="incito__view",null!=this.className&&(t.className+=" "+this.className),t}},{key:"setAttributes",value:function(){var t,e,i,n,r,s,l,u,h;o.isDefinedStr(this.attrs.id)&&this.el.setAttribute("data-id",this.attrs.id),o.isDefinedStr(this.attrs.role)&&this.el.setAttribute("role",this.attrs.role),o.isDefinedStr(this.attrs.accessibility_label)&&this.el.setAttribute("aria-label",this.attrs.accessibility_label),o.isDefinedStr(this.attrs.title)&&this.el.setAttribute("title",this.attrs.title),o.isDefinedStr(this.attrs.gravity)&&this.el.setAttribute("data-gravity",this.attrs.gravity),o.isDefinedStr(this.attrs.link)?(this.el.setAttribute("data-link",""),this.setupCallbacks()):this.hasCallback()&&(this.el.setAttribute("data-callback",""),this.setupCallbacks()),"match_parent"===this.attrs.layout_width?this.el.style.width="100%":"wrap_content"===this.attrs.layout_width?this.el.style.display="inline-block":null!=this.attrs.layout_width&&(this.el.style.width=o.formatUnit(this.attrs.layout_width)),"match_parent"===this.attrs.layout_height?this.el.style.height="100%":"wrap_content"===this.attrs.layout_height?this.el.style.height="auto":null!=this.attrs.layout_height&&(this.el.style.height=o.formatUnit(this.attrs.layout_height)),null!=this.attrs.min_width&&(this.el.style.minWidth=o.formatUnit(this.attrs.min_width)),null!=this.attrs.max_width&&(this.el.style.maxWidth=o.formatUnit(this.attrs.max_width)),null!=this.attrs.min_height&&(this.el.style.minHeight=o.formatUnit(this.attrs.min_height)),null!=this.attrs.max_height&&(this.el.style.maxHeight=o.formatUnit(this.attrs.max_height)),null!=this.attrs.layout_top&&(this.el.style.top=o.formatUnit(this.attrs.layout_top)),null!=this.attrs.layout_left&&(this.el.style.left=o.formatUnit(this.attrs.layout_left)),null!=this.attrs.layout_right&&(this.el.style.right=o.formatUnit(this.attrs.layout_right)),null!=this.attrs.layout_bottom&&(this.el.style.bottom=o.formatUnit(this.attrs.layout_bottom)),o.isDefinedStr(this.attrs.background_color)&&(this.el.style.backgroundColor=this.attrs.background_color),o.isDefinedStr(this.attrs.background_image)&&(this.el.setAttribute("data-src",this.attrs.background_image),this.el.className+=" incito--lazyload"),"repeat_x"!==(t=this.attrs.background_tile_mode)&&"repeat_y"!==t&&"repeat"!==t||(this.el.style.backgroundRepeat=this.attrs.background_tile_mode.replace("_","-")),o.isDefinedStr(this.attrs.background_image_position)&&(this.el.style.backgroundPosition=this.attrs.background_image_position.replace("_"," ")),"center_crop"===this.attrs.background_image_scale_type?this.el.style.backgroundSize="cover":"center_inside"===this.attrs.background_image_scale_type&&(this.el.style.backgroundSize="contain"),null!=this.attrs.layout_margin?this.el.style.margin=o.formatUnit(this.attrs.layout_margin):(null!=this.attrs.layout_margin_top&&(this.el.style.marginTop=o.formatUnit(this.attrs.layout_margin_top)),null!=this.attrs.layout_margin_left&&(this.el.style.marginLeft=o.formatUnit(this.attrs.layout_margin_left)),null!=this.attrs.layout_margin_right&&(this.el.style.marginRight=o.formatUnit(this.attrs.layout_margin_right)),null!=this.attrs.layout_margin_bottom&&(this.el.style.marginBottom=o.formatUnit(this.attrs.layout_margin_bottom))),null!=this.attrs.padding?this.el.style.padding=o.formatUnit(this.attrs.padding):(null!=this.attrs.padding_top&&(this.el.style.paddingTop=o.formatUnit(this.attrs.padding_top)),null!=this.attrs.padding_left&&(this.el.style.paddingLeft=o.formatUnit(this.attrs.padding_left)),null!=this.attrs.padding_right&&(this.el.style.paddingRight=o.formatUnit(this.attrs.padding_right)),null!=this.attrs.padding_bottom&&(this.el.style.paddingBottom=o.formatUnit(this.attrs.padding_bottom))),null!=this.attrs.corner_radius?this.el.style.borderRadius=o.formatUnit(this.attrs.corner_radius):(null!=this.attrs.corner_top_left_radius&&(this.el.style.borderTopLeftRadius=o.formatUnit(this.attrs.corner_top_left_radius)),null!=this.attrs.corner_top_right_radius&&(this.el.style.borderTopRightRadius=o.formatUnit(this.attrs.corner_top_right_radius)),null!=this.attrs.corner_bottom_left_radius&&(this.el.style.borderBottomLeftRadius=o.formatUnit(this.attrs.corner_bottom_left_radius)),null!=this.attrs.corner_bottom_right_radius&&(this.el.style.borderBottomRightRadius=o.formatUnit(this.attrs.corner_bottom_right_radius))),!1===this.attrs.clip_children&&(this.el.style.overflow="visible"),null!=(l=this.getShadow())&&(this.el.style.boxShadow=l.dx+"px "+l.dy+"px "+l.radius+"px "+l.color),u=["solid","dotted","dashed"],null!=this.attrs.stroke_width&&(this.el.style.borderWidth=o.formatUnit(this.attrs.stroke_width)),null!=this.attrs.stroke_color&&(this.el.style.borderColor=this.attrs.stroke_color),e=this.attrs.stroke_style,a.call(u,e)>=0&&(this.el.style.borderStyle=this.attrs.stroke_style),null!=this.attrs.stroke_top_width&&(this.el.style.borderTopWidth=o.formatUnit(this.attrs.stroke_top_width)),null!=this.attrs.stroke_top_color&&(this.el.style.borderTopColor=this.attrs.stroke_top_color),i=this.attrs.stroke_top_style,a.call(u,i)>=0&&(this.el.style.borderTopStyle=this.attrs.stroke_top_style),null!=this.attrs.stroke_left_width&&(this.el.style.borderLeftWidth=o.formatUnit(this.attrs.stroke_left_width)),null!=this.attrs.stroke_left_color&&(this.el.style.borderLeftColor=this.attrs.stroke_left_color),n=this.attrs.stroke_left_style,a.call(u,n)>=0&&(this.el.style.borderLeftStyle=this.attrs.stroke_left_style),null!=this.attrs.stroke_right_width&&(this.el.style.borderRightWidth=o.formatUnit(this.attrs.stroke_right_width)),null!=this.attrs.stroke_right_color&&(this.el.style.borderRightColor=this.attrs.stroke_right_color),r=this.attrs.stroke_right_style,a.call(u,r)>=0&&(this.el.style.borderRightStyle=this.attrs.stroke_right_style),null!=this.attrs.stroke_bottom_width&&(this.el.style.borderBottomWidth=o.formatUnit(this.attrs.stroke_bottom_width)),null!=this.attrs.stroke_bottom_color&&(this.el.style.borderBottomColor=this.attrs.stroke_bottom_color),s=this.attrs.stroke_bottom_style,a.call(u,s)>=0&&(this.el.style.borderBottomStyle=this.attrs.stroke_bottom_style),(h=this.getTransforms()).length>0&&(this.el.style.transform=h.join(" ")),Array.isArray(this.attrs.transform_origin)&&2===this.attrs.transform_origin.length&&(this.el.style.transformOrigin=[o.formatUnit(this.attrs.transform_origin[0]),o.formatUnit(this.attrs.transform_origin[1])].join(" "))}},{key:"getTransforms",value:function(){var t,e,i;return t=[],e=o.formatUnit(this.attrs.transform_translate_x),i=o.formatUnit(this.attrs.transform_translate_y),0!==e&&t.push("translateX("+e+")"),0!==i&&t.push("translateY("+i+")"),"number"==typeof this.attrs.transform_rotate&&0!==this.attrs.transform_rotate&&t.push("rotate("+this.attrs.transform_rotate+"deg)"),"number"==typeof this.attrs.transform_scale&&1!==this.attrs.transform_scale&&t.push("scale("+this.attrs.transform_scale+")"),t}},{key:"hasCallback",value:function(){return!!o.isDefinedStr(this.attrs.onlongclick)||!!o.isDefinedStr(this.attrs.onclick)||!!o.isDefinedStr(this.attrs.oncontextclick)}},{key:"setupCallbacks",value:function(){var t,e,i,n,r,s,a,l,u,h,c=this;a={x:null,y:null},l=null,e=null,r=null,n="ontouchend"in document,i=window.matchMedia("(pointer: fine)").matches,u=function(t,e){c.trigger(t,{originalEvent:e,el:c.el,incito:c.attrs})},t=function(t){t.stopPropagation(),a.x=t.clientX||t.touches[0].clientX,a.y=t.clientY||t.touches[0].clientY,l=(new Date).getTime(),3!==t.which&&2!==t.button&&o.isDefinedStr(c.attrs.onlongclick)&&(r=setTimeout(function(){u(c.attrs.onlongclick,t)},500))},s=function(t){clearTimeout(r)},h=function(t){var i,n,s,h,d;t.stopPropagation(),h=t.clientX||t.changedTouches[0].clientX,d=t.clientY||t.changedTouches[0].clientY,n=Math.abs(h-a.x),s=Math.abs(d-a.y),e=(new Date).getTime(),i=e-l,clearTimeout(r),3!==t.which&&2!==t.button&&i<300&&n<20&&s<20&&(o.isDefinedStr(c.attrs.onclick)?u(c.attrs.onclick,t):o.isDefinedStr(c.attrs.link)&&window.open(c.attrs.link,"_blank"))},n&&!i?(this.el.setAttribute("data-disable-user-select",""),this.el.ontouchstart=t,this.el.ontouchmove=s,this.el.ontouchend=h,this.el.ontouchcancel=h):(this.el.onmousedown=t,this.el.onmousemove=s,this.el.onmouseup=h),o.isDefinedStr(this.attrs.oncontextclick)&&(this.el.oncontextmenu=function(t){return u(c.attrs.oncontextclick,t),!1})}},{key:"getShadow",value:function(){var t,e,i,n;if(o.isDefinedStr(this.attrs.shadow_color))return e="number"==typeof this.attrs.shadow_dx?this.attrs.shadow_dx:0,i="number"==typeof this.attrs.shadow_dy?this.attrs.shadow_dy:0,n="number"==typeof this.attrs.shadow_radius?this.attrs.shadow_radius:0,t=this.attrs.shadow_color,{dx:e,dy:i,radius:n,color:t}}}]),t}();return t.prototype.tagName="div",t.prototype.className=null,t}.call(void 0),n.mixin(r),e.exports=r},{"../utils":2,microevent:12}],12:[function(t,e,i){var n=function(){};n.prototype={bind:function(t,e){this._events=this._events||{},this._events[t]=this._events[t]||[],this._events[t].push(e)},unbind:function(t,e){this._events=this._events||{},t in this._events!=0&&this._events[t].splice(this._events[t].indexOf(e),1)},trigger:function(t){if(this._events=this._events||{},t in this._events!=0)for(var e=0;e<this._events[t].length;e++)this._events[t][e].apply(this,Array.prototype.slice.call(arguments,1))}},n.mixin=function(t){for(var e=["bind","unbind","trigger"],i=0;i<e.length;i++)t.prototype[e[i]]=n.prototype[e[i]]},void 0!==e&&"exports"in e&&(e.exports=n)},{}],13:[function(t,e,i){var n,r,o=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var i=arguments[e];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(t[n]=i[n])}return t},s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};n=this,r=function(){var t={elements_selector:"img",container:window,threshold:300,throttle:150,data_src:"src",data_srcset:"srcset",class_loading:"loading",class_loaded:"loaded",class_error:"error",class_initial:"initial",skip_invisible:!0,callback_load:null,callback_error:null,callback_set:null,callback_processed:null,callback_enter:null},e=!("onscroll"in window)||/glebot/.test(navigator.userAgent),i=function(t,e){t&&t(e)},n=function(t){return t.getBoundingClientRect().top+window.pageYOffset-t.ownerDocument.documentElement.clientTop},r=function(t){return t.getBoundingClientRect().left+window.pageXOffset-t.ownerDocument.documentElement.clientLeft},s=function(t,e,i){return!(function(t,e,i){return(e===window?window.innerHeight+window.pageYOffset:n(e)+e.offsetHeight)<=n(t)-i}(t,e,i)||function(t,e,i){return(e===window?window.pageYOffset:n(e))>=n(t)+i+t.offsetHeight}(t,e,i)||function(t,e,i){var n=window.innerWidth;return(e===window?n+window.pageXOffset:r(e)+n)<=r(t)-i}(t,e,i)||function(t,e,i){return(e===window?window.pageXOffset:r(e))>=r(t)+i+t.offsetWidth}(t,e,i))},a=function(t,e){var i,n=new t(e);try{i=new CustomEvent("LazyLoad::Initialized",{detail:{instance:n}})}catch(t){(i=document.createEvent("CustomEvent")).initCustomEvent("LazyLoad::Initialized",!1,!1,{instance:n})}window.dispatchEvent(i)},l=function(t,e){return t.getAttribute("data-"+e)},u=function(t,e,i){return t.setAttribute("data-"+e,i)},h=function(t,e,i){var n=t.tagName,r=l(t,i);if("IMG"===n){!function(t,e){var i=t.parentNode;if("PICTURE"===i.tagName)for(var n=0;n<i.children.length;n++){var r=i.children[n];if("SOURCE"===r.tagName){var o=l(r,e);o&&r.setAttribute("srcset",o)}}}(t,e);var o=l(t,e);return o&&t.setAttribute("srcset",o),void(r&&t.setAttribute("src",r))}"IFRAME"!==n?r&&(t.style.backgroundImage='url("'+r+'")'):r&&t.setAttribute("src",r)},c="classList"in document.createElement("p"),d=function(t,e){c?t.classList.add(e):t.className+=(t.className?" ":"")+e},p=function(t,e){c?t.classList.remove(e):t.className=t.className.replace(new RegExp("(^|\\s+)"+e+"(\\s+|$)")," ").replace(/^\s+/,"").replace(/\s+$/,"")},f=function(e){this._settings=o({},t,e),this._queryOriginNode=this._settings.container===window?document:this._settings.container,this._previousLoopTime=0,this._loopTimeout=null,this._boundHandleScroll=this.handleScroll.bind(this),this._isFirstLoop=!0,window.addEventListener("resize",this._boundHandleScroll),this.update()};f.prototype={_reveal:function(t){var e=this._settings,n=function n(){e&&(t.removeEventListener("load",r),t.removeEventListener("error",n),p(t,e.class_loading),d(t,e.class_error),i(e.callback_error,t))},r=function r(){e&&(p(t,e.class_loading),d(t,e.class_loaded),t.removeEventListener("load",r),t.removeEventListener("error",n),i(e.callback_load,t))};i(e.callback_enter,t),"IMG"!==t.tagName&&"IFRAME"!==t.tagName||(t.addEventListener("load",r),t.addEventListener("error",n),d(t,e.class_loading)),h(t,e.data_srcset,e.data_src),i(e.callback_set,t)},_loopThroughElements:function(){var t=this._settings,n=this._elements,r=n?n.length:0,o=void 0,a=[],l=this._isFirstLoop;for(o=0;o<r;o++){var h=n[o];t.skip_invisible&&null===h.offsetParent||(e||s(h,t.container,t.threshold))&&(l&&d(h,t.class_initial),this._reveal(h),a.push(o),u(h,"was-processed",!0))}for(;a.length;)n.splice(a.pop(),1),i(t.callback_processed,n.length);0===r&&this._stopScrollHandler(),l&&(this._isFirstLoop=!1)},_purgeElements:function(){var t=this._elements,e=t.length,i=void 0,n=[];for(i=0;i<e;i++){var r=t[i];l(r,"was-processed")&&n.push(i)}for(;n.length>0;)t.splice(n.pop(),1)},_startScrollHandler:function(){this._isHandlingScroll||(this._isHandlingScroll=!0,this._settings.container.addEventListener("scroll",this._boundHandleScroll))},_stopScrollHandler:function(){this._isHandlingScroll&&(this._isHandlingScroll=!1,this._settings.container.removeEventListener("scroll",this._boundHandleScroll))},handleScroll:function(){var t=this._settings.throttle;if(0!==t){var e=Date.now(),i=t-(e-this._previousLoopTime);i<=0||i>t?(this._loopTimeout&&(clearTimeout(this._loopTimeout),this._loopTimeout=null),this._previousLoopTime=e,this._loopThroughElements()):this._loopTimeout||(this._loopTimeout=setTimeout(function(){this._previousLoopTime=Date.now(),this._loopTimeout=null,this._loopThroughElements()}.bind(this),i))}else this._loopThroughElements()},update:function(){this._elements=Array.prototype.slice.call(this._queryOriginNode.querySelectorAll(this._settings.elements_selector)),this._purgeElements(),this._loopThroughElements(),this._startScrollHandler()},destroy:function(){window.removeEventListener("resize",this._boundHandleScroll),this._loopTimeout&&(clearTimeout(this._loopTimeout),this._loopTimeout=null),this._stopScrollHandler(),this._elements=null,this._queryOriginNode=null,this._settings=null}};var g=window.lazyLoadOptions;return g&&function(t,e){var i=e.length;if(i)for(var n=0;n<i;n++)a(t,e[n]);else a(t,e)}(f,g),f},"object"===(void 0===i?"undefined":s(i))&&void 0!==e?e.exports=r():n.LazyLoad=r()},{}]},{},[1])(1)}),Ht=i(function(t,e){!function(){t.exports={polyfill:function(){var t=window,e=document;if(!("scrollBehavior"in e.documentElement.style&&!0!==t.__forceSmoothScrollPolyfill__)){var i,n=t.HTMLElement||t.Element,r=468,o={scroll:t.scroll||t.scrollTo,scrollBy:t.scrollBy,elementScroll:n.prototype.scroll||l,scrollIntoView:n.prototype.scrollIntoView},s=t.performance&&t.performance.now?t.performance.now.bind(t.performance):Date.now,a=(i=t.navigator.userAgent,new RegExp(["MSIE ","Trident/","Edge/"].join("|")).test(i)?1:0);t.scroll=t.scrollTo=function(){void 0!==arguments[0]&&(!0!==u(arguments[0])?f.call(t,e.body,void 0!==arguments[0].left?~~arguments[0].left:t.scrollX||t.pageXOffset,void 0!==arguments[0].top?~~arguments[0].top:t.scrollY||t.pageYOffset):o.scroll.call(t,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:t.scrollX||t.pageXOffset,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:t.scrollY||t.pageYOffset))},t.scrollBy=function(){void 0!==arguments[0]&&(u(arguments[0])?o.scrollBy.call(t,void 0!==arguments[0].left?arguments[0].left:"object"!=typeof arguments[0]?arguments[0]:0,void 0!==arguments[0].top?arguments[0].top:void 0!==arguments[1]?arguments[1]:0):f.call(t,e.body,~~arguments[0].left+(t.scrollX||t.pageXOffset),~~arguments[0].top+(t.scrollY||t.pageYOffset)))},n.prototype.scroll=n.prototype.scrollTo=function(){if(void 0!==arguments[0])if(!0!==u(arguments[0])){var t=arguments[0].left,e=arguments[0].top;f.call(this,this,void 0===t?this.scrollLeft:~~t,void 0===e?this.scrollTop:~~e)}else{if("number"==typeof arguments[0]&&void 0===arguments[1])throw new SyntaxError("Value could not be converted");o.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left:"object"!=typeof arguments[0]?~~arguments[0]:this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top:void 0!==arguments[1]?~~arguments[1]:this.scrollTop)}},n.prototype.scrollBy=function(){void 0!==arguments[0]&&(!0!==u(arguments[0])?this.scroll({left:~~arguments[0].left+this.scrollLeft,top:~~arguments[0].top+this.scrollTop,behavior:arguments[0].behavior}):o.elementScroll.call(this,void 0!==arguments[0].left?~~arguments[0].left+this.scrollLeft:~~arguments[0]+this.scrollLeft,void 0!==arguments[0].top?~~arguments[0].top+this.scrollTop:~~arguments[1]+this.scrollTop))},n.prototype.scrollIntoView=function(){if(!0!==u(arguments[0])){var i=function(t){var i;do{i=(t=t.parentNode)===e.body}while(!1===i&&!1===d(t));return i=null,t}(this),n=i.getBoundingClientRect(),r=this.getBoundingClientRect();i!==e.body?(f.call(this,i,i.scrollLeft+r.left-n.left,i.scrollTop+r.top-n.top),"fixed"!==t.getComputedStyle(i).position&&t.scrollBy({left:n.left,top:n.top,behavior:"smooth"})):t.scrollBy({left:r.left,top:r.top,behavior:"smooth"})}else o.scrollIntoView.call(this,void 0===arguments[0]||arguments[0])}}function l(t,e){this.scrollLeft=t,this.scrollTop=e}function u(t){if(null===t||"object"!=typeof t||void 0===t.behavior||"auto"===t.behavior||"instant"===t.behavior)return!0;if("object"==typeof t&&"smooth"===t.behavior)return!1;throw new TypeError("behavior member of ScrollOptions "+t.behavior+" is not a valid value for enumeration ScrollBehavior.")}function h(t,e){return"Y"===e?t.clientHeight+a<t.scrollHeight:"X"===e?t.clientWidth+a<t.scrollWidth:void 0}function c(e,i){var n=t.getComputedStyle(e,null)["overflow"+i];return"auto"===n||"scroll"===n}function d(t){var e=h(t,"Y")&&c(t,"Y"),i=h(t,"X")&&c(t,"X");return e||i}function p(e){var i,n,o,a,l=(s()-e.startTime)/r;a=l=l>1?1:l,i=.5*(1-Math.cos(Math.PI*a)),n=e.startX+(e.x-e.startX)*i,o=e.startY+(e.y-e.startY)*i,e.method.call(e.scrollable,n,o),n===e.x&&o===e.y||t.requestAnimationFrame(p.bind(t,e))}function f(i,n,r){var a,u,h,c,d=s();i===e.body?(a=t,u=t.scrollX||t.pageXOffset,h=t.scrollY||t.pageYOffset,c=o.scroll):(a=i,u=i.scrollLeft,h=i.scrollTop,c=l),p({scrollable:a,method:c,startTime:d,startX:u,startY:h,x:n,y:r})}}}}()});Ht.polyfill;Rt=Ut,zt=o,Ht.polyfill(),Mt=function(){function t(e){var i,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};a(this,t),this.el=e,this.options=r,this.incito=new Rt(this.el,{incito:this.options.incito}),i=this.incito.trigger,this.incito.trigger=function(){for(var t=arguments.length,e=Array(t),r=0;r<t;r++)e[r]=arguments[r];i.apply(n.incito,e),n.trigger.apply(n,e)}}return l(t,[{key:"start",value:function(){return this.incito.start(),this._trackEvent({type:"x-incito-publication-opened",properties:{}}),this}},{key:"destroy",value:function(){this.incito.destroy()}},{key:"_trackEvent",value:function(t){var e,i,n,r,o,s;for(i in o=t.type,n={id:this.options.id},e=this.options.eventTracker,r=t.properties)s=r[i],n[i]=s;if(null!=e)return e.trackEvent(o,n)}}]),t}(),zt.mixin(Mt);var qt,Ft,Vt,Xt,Bt=Mt,Wt=function(){function t(e){var i=this;a(this,t),this.viewer=e,this.progressEl=this.viewer.el.querySelector(".sgn-incito__progress"),this.scrollListener=this.scroll.bind(this),null!=this.progressEl&&(window.addEventListener("scroll",this.scrollListener,!1),this.viewer.bind("destroyed",function(){window.removeEventListener("scroll",i.scrollListener)}))}return l(t,[{key:"scroll",value:function(){var t,e,i,n;i=window.scrollY,n=window.innerHeight,t=document.body.clientHeight,e=Math.round((i+n)/t*100),i<300?this.progressEl.style.opacity=0:i>=t-n?(this.progressEl.textContent="100%",this.progressEl.style.opacity=1):(this.progressEl.textContent=e+" %",this.progressEl.style.opacity=1)}}]),t}(),Yt="query GetIncitoPublication($id: ID!, $deviceCategory: DeviceCategory!, $orientation: Orientation!, $pixelRatio: Float!, $pointer: Pointer!, $maxWidth: Int!, $versionsSupported: [String!]!) {\n  node(id: $id) {\n    ... on IncitoPublication {\n      id\n      incito(deviceCategory: $deviceCategory, orientation: $orientation, pixelRatio: $pixelRatio, pointer: $pointer, maxWidth: $maxWidth, versionsSupported: $versionsSupported)\n    }\n  }\n}",Zt=Object.freeze({default:Yt});Xt=w,Ft=k,qt=Wt,Vt=Zt?Yt:Zt;var Gt,Kt={Viewer:Bt,Bootstrapper:function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,t),this.options=e,this.deviceCategory=this.getDeviceCategory(),this.pixelRatio=this.getPixelRatio(),this.pointer=this.getPointer(),this.orientation=this.getOrientation(),this.maxWidth=this.getMaxWidth(),this.versionsSupported=["1.0.0"],this.storageKey="incito-"+this.options.id+"-"+this.maxWidth}return l(t,[{key:"getDeviceCategory",value:function(){return Xt.getDeviceCategory()}},{key:"getPixelRatio",value:function(){return window.devicePixelRatio||1}},{key:"getPointer",value:function(){return Xt.getPointer()}},{key:"getOrientation",value:function(){var t;return"quadratic"===(t=Xt.getOrientation(window.innerWidth,window.innerHeight))&&(t="horizontal"),t}},{key:"getMaxWidth",value:function(){return this.options.el.offsetWidth}},{key:"fetch",value:function(t){var e,i=this;if(null!=(e=Ft.storage.session.get(this.storageKey)))return t(null,e);Ft.GraphKit.request({query:Vt,operationName:"GetIncitoPublication",variables:{id:this.options.id,deviceCategory:"DEVICE_CATEGORY_"+this.deviceCategory.toUpperCase(),pixelRatio:this.pixelRatio,pointer:"POINTER_"+this.pointer.toUpperCase(),orientation:"ORIENTATION_"+this.orientation.toUpperCase(),maxWidth:this.maxWidth,versionsSupported:this.versionsSupported}},function(e,n){null!=e?t(e):(t(null,n),Ft.storage.session.set(i.storageKey,n))})}},{key:"createViewer",value:function(t){var e;if(null==t.incito)throw Xt.error(new Error,"you need to supply valid Incito to create a viewer");return e=new Ft.IncitoPublicationKit.Viewer(this.options.el,{id:this.options.id,incito:t.incito,eventTracker:this.options.eventTracker}),new qt(e),e}}]),t}()};Gt=p;var $t,Qt,Jt,te,ee,ie,ne=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,t),this.options=e,this.el=document.createElement("div"),this.resizeListener=this.resize.bind(this)}return l(t,[{key:"render",value:function(){return this.el.className="sgn-offer-details",this.el.setAttribute("tabindex",-1),this.el.innerHTML=Gt.render(this.options.template,this.options.view),this.position(),this}},{key:"show",value:function(){return this.el.className+=" in",window.addEventListener("resize",this.resizeListener,!1),this}},{key:"destroy",value:function(){window.removeEventListener("resize",this.resizeListener),this.el.parentNode.removeChild(this.el)}},{key:"position",value:function(){var t,e,i,n;e=this.options.el.getBoundingClientRect(),i=window.pageYOffset+e.top+this.options.el.offsetHeight,t=window.pageXOffset+e.left,n=this.options.el.offsetWidth,this.el.style.top=i+"px",this.el.style.left=t+"px",this.el.style.width=n+"px"}},{key:"resize",value:function(){this.position()}}]),t}(),re=i(function(t){!function(){var e,i=0,n=0,r={},o={};function s(t,n,r){return"_root"==n?r:t!==r?function(t){return e||(e=t.matches?t.matches:t.webkitMatchesSelector?t.webkitMatchesSelector:t.mozMatchesSelector?t.mozMatchesSelector:t.msMatchesSelector?t.msMatchesSelector:t.oMatchesSelector?t.oMatchesSelector:h.matchesSelector)}(t).call(t,n)?t:t.parentNode?(i++,s(t.parentNode,n,r)):void 0:void 0}function a(t,e,i,n){r[t.id]||(r[t.id]={}),r[t.id][e]||(r[t.id][e]={}),r[t.id][e][i]||(r[t.id][e][i]=[]),r[t.id][e][i].push(n)}function l(t,e,i,n){if(r[t.id])if(e)if(n||i)if(n){if(r[t.id][e][i])for(var o=0;o<r[t.id][e][i].length;o++)if(r[t.id][e][i][o]===n){r[t.id][e][i].splice(o,1);break}}else delete r[t.id][e][i];else r[t.id][e]={};else for(var s in r[t.id])r[t.id].hasOwnProperty(s)&&(r[t.id][s]={})}function u(t,e,n,u){if(this.element){t instanceof Array||(t=[t]),n||"function"!=typeof e||(n=e,e="_root");var c,d=this.id;for(c=0;c<t.length;c++)u?l(this,t[c],e,n):(r[d]&&r[d][t[c]]||h.addEvent(this,t[c],p(t[c])),a(this,t[c],e,n));return this}function p(t){return function(e){!function(t,e,n){if(r[t][n]){var a,l,u=e.target||e.srcElement,c={},d=0,p=0;for(a in i=0,r[t][n])r[t][n].hasOwnProperty(a)&&(l=s(u,a,o[t].element))&&h.matchesEvent(n,o[t].element,l,"_root"==a,e)&&(i++,r[t][n][a].match=l,c[i]=r[t][n][a]);for(e.stopPropagation=function(){e.cancelBubble=!0},d=0;d<=i;d++)if(c[d])for(p=0;p<c[d].length;p++){if(!1===c[d][p].call(c[d].match,e))return void h.cancel(e);if(e.cancelBubble)return}}}(d,e,t)}}}function h(t,e){if(!(this instanceof h)){for(var i in o)if(o[i].element===t)return o[i];return o[++n]=new h(t,n),o[n]}this.element=t,this.id=e}h.prototype.on=function(t,e,i){return u.call(this,t,e,i)},h.prototype.off=function(t,e,i){return u.call(this,t,e,i,!0)},h.matchesSelector=function(){},h.cancel=function(t){t.preventDefault(),t.stopPropagation()},h.addEvent=function(t,e,i){var n="blur"==e||"focus"==e;t.element.addEventListener(e,i,n)},h.matchesEvent=function(){return!0},t.exports&&(t.exports=h),window.Gator=h}()});Qt=o,$t=re,Jt=p,ee=St,ie='<div class="sgn-popover__background" data-close></div>\n<div class="sgn-popover__menu">\n    {{#header}}\n        <div class="sgn-popover__header">{{header}}</div>\n    {{/header}}\n    <div class="sgn-popover__content">\n        <ul>\n            {{#singleChoiceItems}}\n                <li data-index="{{index}}">\n                    <p class="sgn-popover-item__title">{{item.title}}</p>\n                    {{#item.subtitle}}\n                        <p class="sgn-popover-item__subtitle">{{item.subtitle}}</p>\n                    {{/item.subtitle}}\n                </li>\n            {{/singleChoiceItems}}\n        </ul>\n    </div>\n</div>',te=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};a(this,t),this.options=e,this.el=document.createElement("div"),this.backgroundEl=document.createElement("div"),this.resizeListener=this.resize.bind(this),this.scrollListener=this.scroll.bind(this)}return l(t,[{key:"render",value:function(){var t,e,i;return null!=(e=this.options.width)?e:100,t=this.options.header,null!=this.options.template&&(ie=this.options.template),this.trigger.bind(this),i={header:t,singleChoiceItems:this.options.singleChoiceItems.map(function(t,e){return{item:t,index:e}})},this.el.className="sgn-popover",this.el.setAttribute("tabindex",-1),this.el.innerHTML=Jt.render(ie,i),this.position(),this.addEventListeners(),this}},{key:"destroy",value:function(){$t(this.el).off(),window.removeEventListener("resize",this.resizeListener),window.removeEventListener("scroll",this.scrollListener),null!=this.el.parentNode&&(this.el.parentNode.removeChild(this.el),this.trigger("destroyed"))}},{key:"position",value:function(){var t,e,i,n,r,o,s,a;s=this.options.y,i=this.options.x,a=(n=this.el.querySelector(".sgn-popover__menu")).offsetWidth,e=n.offsetHeight,o=this.el.parentNode.offsetWidth,r=this.el.parentNode.offsetHeight,s-=(t=this.el.parentNode.getBoundingClientRect()).top,i-=t.left,s-=window.pageYOffset,i-=window.pageXOffset,n.style.top=s+e>r?r-e+"px":s+"px",n.style.left=i+a>o?o-a+"px":i+"px"}},{key:"addEventListeners",value:function(){var t,e=this;t=this.trigger.bind(this),this.el.addEventListener("keyup",this.keyUp.bind(this)),$t(this.el).on("click","[data-index]",function(e){e.preventDefault(),e.stopPropagation(),t("selected",{index:+this.getAttribute("data-index")})}),$t(this.el).on("click","[data-close]",function(t){t.preventDefault(),t.stopPropagation(),e.destroy()}),$t(this.el).on("click",".sgn-popover__menu",function(t){t.stopPropagation()}),window.addEventListener("resize",this.resizeListener,!1),window.addEventListener("scroll",this.scrollListener,!1)}},{key:"keyUp",value:function(t){t.keyCode===ee.ESC&&this.destroy()}},{key:"resize",value:function(){this.destroy()}},{key:"scroll",value:function(){this.destroy()}}]),t}(),Qt.mixin(te);var oe;oe=te;var se,ae,le,ue,he,ce,de,pe,fe={OfferDetails:ne,Popover:te,singleChoicePopover:function(t,e){var i,n;return i=t.items,n=null,1===i.length?e(i[0]):i.length>1&&((n=new oe({header:t.header,x:t.x,y:t.y,singleChoiceItems:i})).bind("selected",function(t){e(i[t.index]),n.destroy()}),n.bind("destroyed",function(){t.el.focus()}),t.el.appendChild(n.el),n.render().el.focus()),{destroy:function(){null!=n&&n.destroy()}}}};return(se=S).storage={local:x,session:T,cookie:C},se.request=function(){var t,e,i,n,r,o,s,a,l,u,h,c,d,p=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},f=arguments[1],g=arguments[2];for(e in n=new XMLHttpRequest,o=null!=(a=p.method)?a:"get",c=p.url,i=null!=(l=p.headers)?l:{},null!=p.qs&&(s=P.util.formatQueryParams(p.qs),-1===c.indexOf("?")?c+="?"+s:c+="&"+s),n.open(o.toUpperCase(),c),null!=p.timeout&&(n.timeout=p.timeout),!0===p.useCookies&&(n.withCredentials=!0),!0===p.json&&(i["Content-Type"]="application/json",i.Accept="application/json"),u=p.headers)null!=(d=u[e])&&n.setRequestHeader(e,d);if(n.addEventListener("load",function(){var t;i=(i=n.getAllResponseHeaders().split("\r\n")).reduce(function(t,e,i){var n;return t[(n=e.split(": "))[0].toLowerCase()]=n[1],t},{}),t=n.responseText,!0===p.json&&(t=JSON.parse(t)),f(null,{statusCode:n.status,headers:i,body:t})}),n.addEventListener("error",function(){f(new Error)}),n.addEventListener("timeout",function(){f(new Error)}),n.addEventListener("progress",function(t){t.lengthComputable&&"function"==typeof g&&g(t.loaded,t.total)}),null!=p.formData){for(r in t=new FormData,h=p.formData)d=h[r],t.append(r,d);n.send(t)}else null!=p.body?!0===p.json?n.send(JSON.stringify(p.body)):n.send(p.body):n.send()},se.AssetsKit=D,se.EventsKit=H,se.GraphKit=V,se.CoreKit=dt,se.PagedPublicationKit=jt,se.IncitoPublicationKit=Kt,se.CoreUIKit=fe,"object"===(void 0===(he=se.storage.cookie.get("session"))?"undefined":s(he))&&se.config.set({coreSessionToken:he.token,coreSessionClientId:he.client_id}),se.client=((de=null==(pe=null!=(pe=se.storage.local.get("client-id"))?pe.data:void 0))&&(pe=se.util.uuid(),se.storage.local.set("client-id",pe)),{firstOpen:de,id:pe}),se.config.bind("change",function(t){var e;null!=(e=t.eventTracker)&&(!0===se.client.firstOpen&&e.trackEvent("first-client-session-opened",{},"1.0.0"),e.trackEvent("client-session-opened",{},"1.0.0"))}),null!=(ue=document.getElementById("sgn-sdk"))&&(ae=ue.getAttribute("data-app-key"),ce=ue.getAttribute("data-track-id"),le={},null!=ae&&(le.appKey=ae),null!=ce&&(le.eventTracker=new se.EventsKit.Tracker({trackId:ce})),se.config.set(le)),se});
//# sourceMappingURL=sgn-sdk.min.js.map
