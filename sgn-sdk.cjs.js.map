{"version":3,"file":"sgn-sdk.cjs.js","sources":["../lib/coffeescript/config.coffee","../lib/coffeescript/translations.coffee","../lib/coffeescript/util.coffee","../lib/coffeescript/core.coffee","../lib/coffeescript/sgn.coffee","../lib/coffeescript/request/node.coffee","../lib/coffeescript/kits/graph/request.coffee","../lib/coffeescript/kits/graph/index.coffee","../lib/coffeescript/kits/core/request.coffee","../lib/coffeescript/storage/client-cookie.coffee","../lib/coffeescript/kits/core/session.coffee","../lib/coffeescript/kits/core/index.coffee","../lib/coffeescript/kits/assets/file-upload.coffee","../lib/coffeescript/kits/assets/index.coffee","../lib/coffeescript/node.coffee"],"sourcesContent":["MicroEvent = require 'microevent'\nConfig = class Config\n    keys: [\n        'appVersion',\n        'appKey',\n        'appSecret',\n        'authToken',\n        'eventTracker',\n        'locale',\n        'coreSessionToken',\n        'coreSessionClientId',\n        'coreUrl',\n        'graphUrl',\n        'eventsTrackUrl',\n        'eventsPulseUrl',\n        'assetsFileUploadUrl'\n    ]\n\n    constructor: ->\n        @attrs = {}\n\n        return\n\n    set: (config = {}) ->\n        changedAttributes = {}\n\n        for key, value of config\n            if key in @keys\n                @attrs[key] = value\n                changedAttributes[key] = value\n\n        @trigger 'change', changedAttributes\n\n        return\n\n    get: (option) ->\n        @attrs[option]\n\nMicroEvent.mixin Config\n\nmodule.exports = Config\n","Mustache = require 'mustache'\npairs =\n    'paged_publication.hotspot_picker.header': 'Which offer did you mean?'\n    'incito_publication.product_picker.header': 'Which product?'\n\nmodule.exports =\n    t: (key, view) ->\n        template = pairs[key] ? ''\n\n        Mustache.render template, view\n\n    update: (translations) ->\n        for key, value of translations\n            pairs[key] = value\n\n        return\n","process = require 'process'\n\nutil =\n    isBrowser: ->\n        typeof process isnt 'undefined' and process.browser\n\n    isNode: ->\n        not util.isBrowser()\n\n    error: (err, options) ->\n        err.message = err.message or null\n\n        if typeof options is 'string'\n            err.message = options\n        else if typeof options is 'object' and options?\n            for key, value of options\n                err[key] = value\n\n            err.message = options.message if options.message?\n            err.code = options.code or options.name if options.code? or options.message?\n            err.stack = options.stack if options.stack?\n\n        err.name = options and options.name or err.name or err.code or 'Error'\n        err.time = new Date()\n\n        err\n\n    uuid: ->\n        'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace /[xy]/g, (c) ->\n            r = Math.random() * 16 | 0\n            v = if c is 'x' then r else (r & 0x3|0x8)\n\n            v.toString 16\n\n    getQueryParam: (field, url) ->\n        href = if url then url else window.location.href\n        reg = new RegExp '[?&]' + field + '=([^&#]*)', 'i'\n        string = reg.exec href\n\n        if string then string[1] else undefined\n\n    formatQueryParams: (queryParams = {}) ->\n        Object\n            .keys queryParams\n            .map (key) -> key + '=' + encodeURIComponent(queryParams[key])\n            .join '&'\n\n    getRandomNumberBetween: (from, to) ->\n        Math.floor(Math.random() * to) + from\n\n    getOS: ->\n        name = null\n        ua = window.navigator.userAgent\n\n        if ua.indexOf('Windows') > -1\n            name = 'Windows'\n        else if ua.indexOf('Mac') > -1\n            name = 'macOS'\n        else if ua.indexOf('X11') > -1\n            name = 'unix'\n        else if ua.indexOf('Linux') > -1\n            name = 'Linux'\n        else if ua.indexOf('iOS') > -1\n            name = 'iOS'\n        else if ua.indexOf('Android') > -1\n            name = 'Android'\n\n        name\n    \n    getDeviceCategory: ->\n        deviceCategory = 'desktop'\n\n        if navigator.platform is 'iPod' or navigator.platform is 'iPhone'\n            deviceCategory = 'mobile'\n        else if navigator.platform is 'iPad'\n            deviceCategory = 'tablet'\n        else if navigator.platform is 'Android' or /android/gi.test(navigator.userAgent)\n            if /tablet/gi.test(navigator.userAgent)\n                deviceCategory = 'tablet'\n            else\n                deviceCategory = 'mobile'\n\n        deviceCategory\n    \n    getPointer: ->\n        pointer = 'fine'\n\n        pointer = 'coarse' if matchMedia('(pointer:coarse)').matches\n\n        pointer\n    \n    getOrientation: (width, height) ->\n        if width is height\n            'quadratic'\n        else if width > height\n            'horizontal'\n        else\n            'vertical'\n\n    getScreenDimensions: ->\n        density = window.devicePixelRatio ? 1\n        logical =\n            width: window.screen.width\n            height: window.screen.height\n        physical =\n            width: Math.round logical.width * density\n            height: Math.round logical.height * density\n\n        density: density\n        logical: logical\n        physical: physical\n\n    getUtcOffsetSeconds: ->\n        now = new Date()\n        jan1 = new Date now.getFullYear(), 0, 1, 0, 0, 0, 0\n        tmp = jan1.toGMTString()\n        jan2 = new Date tmp.substring(0, tmp.lastIndexOf(' ') - 1)\n        stdTimeOffset = (jan1 - jan2) / 1000\n\n        stdTimeOffset\n\n    getUtcDstOffsetSeconds: ->\n        new Date().getTimezoneOffset() * 60 * -1\n\n    getColorBrightness: (color) ->\n        color = color.replace '#', ''\n        hex = parseInt (hex + '').replace(/[^a-f0-9]/gi, ''), 16\n        rgb = []\n        sum = 0\n        x = 0\n\n        while x < 3\n            s = parseInt(color.substring(2 * x, 2), 16)\n            rgb[x] = s\n\n            sum += s if s > 0\n\n            ++x\n\n        if sum <= 381 then 'dark' else 'light'\n\n    btoa: (str) ->\n        if util.isBrowser()\n            btoa str\n        else\n            buffer = null\n\n            if str instanceof Buffer\n                buffer = str\n            else\n                buffer = new Buffer str.toString(), 'binary'\n\n            buffer.toString 'base64'\n\n    find: (arr, fn) ->\n        for item in arr\n            return item if fn(item) is true\n\n    chunk: (arr, size) ->\n        results = []\n\n        while arr.length\n            results.push arr.splice(0, size)\n\n        results\n\n    throttle: (fn, threshold = 250, scope) ->\n        last = undefined\n        deferTimer = undefined\n\n        ->\n            context = scope or @\n            now = new Date().getTime()\n            args = arguments\n\n            if last and now < last + threshold\n                clearTimeout deferTimer\n\n                deferTimer = setTimeout ->\n                    last = now\n                    \n                    fn.apply context, args\n                \n                    return\n                , threshold\n            else\n                last = now\n                fn.apply context, args\n\n            return\n\n    loadImage: (src, callback) ->\n        img = new Image()\n\n        img.onload = -> callback null, img.width, img.height\n        img.onerror = -> callback new Error()\n        img.src = src\n\n        img\n\n    distance: (lat1, lng1, lat2, lng2) ->\n        radlat1 = Math.PI * lat1 / 180\n        radlat2 = Math.PI * lat2 / 180\n        theta = lng1 - lng2\n        radtheta = Math.PI * theta / 180\n        dist = Math.sin(radlat1) * Math.sin(radlat2) + Math.cos(radlat1) * Math.cos(radlat2) * Math.cos(radtheta)\n        dist = Math.acos(dist)\n        dist = dist * 180 / Math.PI\n        dist = dist * 60 * 1.1515\n        dist = dist * 1.609344 * 1000\n\n        dist\n    \n    isElementInViewport: (el) ->\n        rect = el.getBoundingClientRect()\n        html = document.documentElement\n\n        rect.top >= 0 and rect.left >= 0 and rect.bottom <= window.innerHeight and rect.right <= window.innerWidth\n\n    async:\n        parallel: (asyncCalls, sharedCallback) ->\n            counter = asyncCalls.length\n            allResults = []\n            k = 0\n\n            makeCallback = (index) ->\n                ->\n                    results = []\n                    i = 0\n\n                    counter--\n\n                    while i < arguments.length\n                        results.push arguments[i]\n                        i++\n\n                    allResults[index] = results\n\n                    sharedCallback allResults if counter is 0\n\n                    return\n\n            while k < asyncCalls.length\n                asyncCalls[k] makeCallback(k)\n                k++\n\n            return\n\nmodule.exports = util\n","Config = require './config'\ntranslations = require './translations'\nutil = require './util'\nconfig = new Config()\n\n# Set default values.\nconfig.set\n    locale: 'en_US'\n    coreUrl: 'https://api.etilbudsavis.dk'\n    graphUrl: 'https://graph.service.shopgun.com'\n    eventsTrackUrl: 'https://events.service.shopgun.com/track'\n    eventsPulseUrl: 'wss://events.service.shopgun.com/pulse'\n    assetsFileUploadUrl: 'https://assets.service.shopgun.com/upload'\n\nmodule.exports =\n    config: config\n\n    translations: translations\n\n    util: util","module.exports = require './core'\n","SGN = require '../sgn'\nrequest = require 'request'\n\nmodule.exports = (options = {}, callback) ->\n    requestOptions =\n        method: options.method\n        url: options.url\n        headers: options.headers\n        timeout: options.timeout\n        json: options.json\n        body: options.body\n        formData: options.formData\n        forever: true\n        qs: options.qs\n\n    if Array.isArray options.cookies\n        jar = request.jar()\n\n        options.cookies.forEach (cookie) ->\n            jar.setCookie request.cookie(\"#{cookie.key}=#{cookie.value}\"), cookie.url\n\n            return\n\n        requestOptions.jar = jar\n\n    request requestOptions, (err, response, body) ->\n        if err?\n            callback new Error()\n        else\n            callback null,\n                statusCode: response.statusCode\n                headers: response.headers\n                body: body\n\n        return\n\n    return\n","SGN = require '../../sgn'\n\nparseCookies = (cookies = []) ->\n    parsedCookies = {}\n\n    cookies.map (cookie) ->\n        parts = cookie.split '; '\n        keyValuePair = parts[0].split '='\n        key = keyValuePair[0]\n        value = keyValuePair[1]\n\n        parsedCookies[key] = value\n\n        return\n    \n    parsedCookies\n\nmodule.exports = (options = {}, callback) ->\n    url = SGN.config.get 'graphUrl'\n    timeout = 1000 * 12\n    appKey = SGN.config.get 'appKey'\n    authToken = SGN.config.get 'authToken'\n    authTokenCookieName = 'shopgun-auth-token'\n    options =\n        method: 'post'\n        url: url\n        timeout: timeout\n        json: true\n        headers: {}\n        body:\n            query: options.query\n            operationName: options.operationName\n            variables: options.variables\n\n    # Apply authorization header when app key is provided to avoid rate limiting.\n    options.headers.Authorization = 'Basic ' + SGN.util.btoa(\"app-key:#{appKey}\") if appKey?\n\n    # Set cookies manually in node.js.\n    if SGN.util.isNode() and authToken?\n        options.cookies = [\n            key: authTokenCookieName\n            value: authToken\n            url: url\n        ]\n    else if SGN.util.isBrowser()\n        options.useCookies = true\n\n    SGN.request options, (err, data) ->\n        if err?\n            callback SGN.util.error(new Error('Graph request error'),\n                code: 'GraphRequestError'\n            )\n        else\n            # Update auth token as it might have changed.\n            if SGN.util.isNode()\n                cookies = parseCookies data.headers?['set-cookie']\n                authCookie = cookies[authTokenCookieName]\n\n                if SGN.config.get('authToken') isnt authCookie\n                    SGN.config.set 'authToken', authCookie\n\n            if data.statusCode is 200\n                callback null, data.body\n            else\n                callback SGN.util.error(new Error('Graph API error'),\n                    code: 'GraphAPIError'\n                    statusCode: data.statusCode\n                )\n\n        return\n\n    return\n\n\n","module.exports =\n    request: require './request'\n","SGN = require '../../sgn'\n\nrequest = (options = {}, callback = ->, runs = 0) ->\n    SGN.CoreKit.session.ensure (err) ->\n        return callback err if err?\n\n        url = options.url ? ''\n        headers = options.headers ? {}\n        token = SGN.config.get 'coreSessionToken'\n        clientId = SGN.config.get 'coreSessionClientId'\n        appVersion = SGN.config.get 'appVersion'\n        appSecret = SGN.config.get 'appSecret'\n        locale = SGN.config.get 'locale'\n        qs = options.qs ? {}\n        geo = options.geolocation\n\n        headers['X-Token'] = token\n        headers['X-Signature'] = SGN.CoreKit.session.sign appSecret, token if appSecret?\n\n        qs.r_locale = locale if locale?\n        qs.api_av = appVersion if appVersion?\n        qs.client_id = clientId if clientId?\n\n        if geo?\n            qs.r_lat = geo.latitude if geo.latitude? and not qs.r_lat?\n            qs.r_lng = geo.longitude if geo.longitude? and not qs.r_lng?\n            qs.r_radius = geo.radius if geo.radius? and not qs.r_radius?\n            qs.r_sensor = geo.sensor if geo.sensor? and not qs.r_sensor?\n\n        SGN.request\n            method: options.method\n            url: SGN.config.get('coreUrl') + url\n            qs: qs\n            body: options.body\n            formData: options.formData\n            headers: headers\n            json: true\n            useCookies: false\n        , (err, data) ->\n            if err?\n                callback SGN.util.error(new Error('Core request error'),\n                    code: 'CoreRequestError'\n                )\n            else\n                token = SGN.config.get 'coreSessionToken'\n                responseToken = data.headers['x-token']\n\n                SGN.CoreKit.session.saveToken responseToken if responseToken and token isnt responseToken\n\n                if data.statusCode >= 200 and data.statusCode < 300 or data.statusCode is 304\n                    callback null, data.body\n                else\n                    if runs is 0 and data.body? and data.body.code in [1101, 1107, 1108]\n                        SGN.config.set coreSessionToken: undefined\n\n                        request options, callback, ++runs\n                    else\n                        callback SGN.util.error(new Error('Core API error'),\n                            code: 'CoreAPIError'\n                            statusCode: data.statusCode\n                        ), data.body\n\n            return\n\n    return\n\nmodule.exports = request\n","SGN = require '../sgn'\nprefixKey = 'sgn-'\n\nmodule.exports =\n    get: (key) ->\n        return if SGN.util.isNode()\n\n        try\n            name = \"#{prefixKey}#{key}=\"\n            ca = document.cookie.split ';'\n\n            for c in ca\n                ct = c.trim()\n\n                value = ct.substring(name.length, ct.length) if ct.indexOf(name) is 0\n\n            value = JSON.parse value\n        catch err\n            value = {}\n\n        value\n\n    set: (key, value) ->\n        return if SGN.util.isNode()\n\n        try\n            days = 365\n            date = new Date()\n            str = JSON.stringify value\n\n            date.setTime date.getTime() + days * 24 * 60 * 60 * 1000\n\n            document.cookie = \"#{prefixKey}#{key}=#{str};expires=#{date.toUTCString()};path=/\"\n        catch err\n\n        return\n\n\n","SGN = require '../../sgn'\nsha256 = require 'sha256'\nclientCookieStorage = require '../../storage/client-cookie'\ncallbackQueue = []\nrenewed = false\n\nsession =\n    ttl: 1 * 60 * 60 * 24 * 60\n\n    saveToken: (token) ->\n        throw new Error('No token provided for saving') if not token\n\n        SGN.config.set coreSessionToken: token\n\n        session.saveCookie()\n\n        return\n\n    saveClientId: (clientId) ->\n        SGN.config.set coreSessionClientId: clientId\n\n        session.saveCookie()\n\n        return\n\n    saveCookie: ->\n        clientCookieStorage.set 'session',\n            token: SGN.config.get 'coreSessionToken'\n            client_id: SGN.config.get 'coreSessionClientId'\n\n        return\n\n    create: (callback) ->\n        SGN.request\n            method: 'post'\n            url: SGN.config.get('coreUrl') + '/v2/sessions'\n            json: true\n            qs:\n                api_key: SGN.config.get 'appKey'\n                token_ttl: session.ttl\n        , (err, data) ->\n            if err?\n                callback err\n            else if data.statusCode is 201\n                session.saveToken data.body.token\n                session.saveClientId data.body.client_id\n\n                callback err, data.body\n            else\n                callback new Error('Could not create session')\n\n            return\n\n        return\n    \n    update: (callback) ->\n        headers = {}\n        token = SGN.config.get 'coreSessionToken'\n        appSecret = SGN.config.get 'appSecret'\n\n        headers['X-Token'] = token\n        headers['X-Signature'] = session.sign appSecret, token if appSecret?\n\n        SGN.request\n            url: SGN.config.get('coreUrl') + '/v2/sessions'\n            headers: headers\n            json: true\n        , (err, data) ->\n            if err?\n                callback err\n            else if data.statusCode is 200\n                session.saveToken data.body.token\n                session.saveClientId data.body.client_id\n\n                callback err, data.body\n            else\n                callback new Error('Could not update session')\n\n            return\n\n        return\n\n    renew: (callback) ->\n        headers = {}\n        token = SGN.config.get 'coreSessionToken'\n        appSecret = SGN.config.get 'appSecret'\n\n        headers['X-Token'] = token\n        headers['X-Signature'] = session.sign appSecret, token if appSecret?\n\n        SGN.request\n            method: 'put'\n            url: SGN.config.get('coreUrl') + '/v2/sessions'\n            headers: headers\n            json: true\n        , (err, data) ->\n            if err?\n                callback err\n            else if data.statusCode is 200\n                session.saveToken data.body.token\n                session.saveClientId data.body.client_id\n\n                callback err, data.body\n            else\n                callback new Error('Could not renew session')\n\n            return\n\n        return\n\n    ensure: (callback) ->\n        queueCount = callbackQueue.length\n        complete = (err) ->\n            callbackQueue = callbackQueue.filter (fn) ->\n                fn err\n\n                false\n\n            return\n\n        callbackQueue.push callback\n\n        if queueCount is 0\n            if not SGN.config.get('coreSessionToken')?\n                session.create complete\n            else if renewed is false\n                renewed = true\n                session.renew (err) ->\n                    if err?\n                        session.create complete\n                    else\n                        complete()\n                    \n                    return\n            else\n                complete()\n\n        return\n\n    sign: (appSecret, token) ->\n        sha256 [appSecret, token].join('')\n\nmodule.exports = session\n","SGN = require '../../sgn'\nrequest = require './request'\nsession = require './session'\n\nmodule.exports =\n    request: request\n\n    session: session\n","SGN = require '../../sgn'\n\nmodule.exports = (options = {}, callback, progressCallback) ->\n    throw new Error('File is not defined') if not options.file?\n\n    url = SGN.config.get 'assetsFileUploadUrl'\n    timeout = 1000 * 60 * 60\n\n    SGN.request\n        method: 'post'\n        url: url\n        headers:\n            'Accept': 'application/json'\n        formData:\n            file: options.file\n        timeout: timeout\n    , (err, data) ->\n        if err?\n            callback SGN.util.error(new Error('Request error'),\n                code: 'RequestError'\n            )\n        else\n            if data.statusCode is 200\n                callback null, JSON.parse(data.body)\n            else\n                callback SGN.util.error(new Error('Request error'),\n                    code: 'RequestError'\n                    statusCode: data.statusCode\n                )\n\n        return\n    , (loaded, total) ->\n        if typeof progressCallback is 'function'\n            progressCallback\n                progress: loaded / total\n                loaded: loaded\n                total: total\n\n        return\n\n    return\n","module.exports =\n    fileUpload: require './file-upload'\n","SGN = require './sgn'\n\nSGN.request = require './request/node'\n\n# Expose the different kits.\nSGN.GraphKit = require './kits/graph'\nSGN.CoreKit = require './kits/core'\nSGN.AssetsKit = require './kits/assets'\n\nmodule.exports = SGN\n"],"names":["Config","MicroEvent","indexOf","require$$0","attrs","config","changedAttributes","key","value","keys","trigger","option","mixin","Mustache","pairs","view","ref","template","render","translations","process","util","browser","isBrowser","err","options","message","code","name","stack","time","Date","replace","c","r","v","Math","random","toString","field","url","href","reg","string","window","location","RegExp","exec","queryParams","Object","map","encodeURIComponent","join","from","to","floor","ua","navigator","userAgent","deviceCategory","platform","test","pointer","matchMedia","matches","width","height","density","logical","physical","screen","round","jan1","jan2","now","stdTimeOffset","tmp","getFullYear","toGMTString","substring","lastIndexOf","getTimezoneOffset","color","hex","rgb","s","sum","x","parseInt","str","buffer","btoa","Buffer","arr","fn","item","j","len","size","results","length","push","splice","threshold","scope","deferTimer","last","args","context","getTime","arguments","setTimeout","apply","src","callback","img","Image","onload","onerror","Error","lat1","lng1","lat2","lng2","dist","radlat1","radlat2","radtheta","theta","PI","sin","cos","acos","el","html","rect","getBoundingClientRect","document","documentElement","top","left","bottom","innerHeight","right","innerWidth","asyncCalls","sharedCallback","allResults","counter","k","makeCallback","index","i","require$$1","require$$2","set","request","jar","requestOptions","method","headers","timeout","json","body","formData","qs","Array","isArray","cookies","forEach","cookie","setCookie","response","statusCode","SGN","parseCookies","parsedCookies","keyValuePair","parts","split","appKey","authToken","authTokenCookieName","get","query","operationName","variables","Authorization","isNode","useCookies","data","authCookie","error","runs","CoreKit","session","ensure","appSecret","appVersion","clientId","geo","locale","ref1","ref2","token","geolocation","sign","r_locale","api_av","client_id","r_lat","latitude","r_lng","longitude","r_radius","radius","r_sensor","sensor","ref3","responseToken","saveToken","prefixKey","ca","ct","trim","JSON","parse","date","days","stringify","setTime","toUTCString","callbackQueue","clientCookieStorage","renewed","sha256","saveCookie","ttl","saveClientId","complete","queueCount","filter","create","renew","progressCallback","file","loaded","total","GraphKit","require$$3","AssetsKit","require$$4"],"mappings":"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"}